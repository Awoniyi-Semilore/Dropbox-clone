!function(){"use strict";function e(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(t,n,i){return n&&function(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,e(r.key),r)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};window.ktag.bugsnag&&"object"===t(e)&&window.ktag.bugsnag.pushBreadCrumb(e)},r=function(){var e,t,n,i,r,o,a,u,c,s,d,f,l,v,m,h;return u={},n=document,s=!1,d="active",o=6e4,r=!1,m={},v="__ceGUID",t={add:function(e,t,n){return e[v]=void 0,e[v]||(e[v]="ifvisible.object.event.identifier"),m[e[v]]||(m[e[v]]={}),m[e[v]][t]||(m[e[v]][t]=[]),m[e[v]][t].push(n)},remove:function(e,t,n){var i,r,o,a,u;if(n){if(e[v]&&m[e[v]]&&m[e[v]][t])for(r=o=0,a=(u=m[e[v]][t]).length;o<a;r=++o)if((i=u[r])===n)return m[e[v]][t].splice(r,1),i}else if(e[v]&&m[e[v]]&&m[e[v]][t])return delete m[e[v]][t]},fire:function(e,t,n){var i,r,o,a,u;if(e[v]&&m[e[v]]&&m[e[v]][t]){for(u=[],r=0,o=(a=m[e[v]][t]).length;r<o;r++)i=a[r],u.push(i(n||{}));return u}}},h=!1,e=function(e,t,n){return h||(h=e.addEventListener?function(e,t,n){return e.addEventListener(t,n,!1)}:e.attachEvent?function(e,t,n){return e.attachEvent("on"+t,n,!1)}:function(e,t,n){return e["on"+t]=n}),h(e,t,n)},a=function(){var e,t,i,r;for(void 0,r=3,i=n.createElement("div"),e=i.getElementsByTagName("i"),t=function(){return i.innerHTML="\x3c!--[if gt IE "+ ++r+"]><i></i><![endif]--\x3e",e[0]};t(););return r>4?r:void 0}(),i=!1,l=void 0,void 0!==n.hidden?(i="hidden",l="visibilitychange"):void 0!==n.mozHidden?(i="mozHidden",l="mozvisibilitychange"):void 0!==n.msHidden?(i="msHidden",l="msvisibilitychange"):void 0!==n.webkitHidden&&(i="webkitHidden",l="webkitvisibilitychange"),f=function(){var t,i;return t=[],(i=function(){return t.map(clearTimeout),"active"!==d&&u.wakeup(),r=+new Date,t.push(setTimeout((function(){if("active"===d)return u.idle()}),o))})(),e(n,"mousemove",i),e(n,"keyup",i),e(n,"touchstart",i),e(window,"scroll",i),u.focus(i),u.wakeup(i)},c=function(){var t;return!!s||(!1===i?(t="blur",a<9&&(t="focusout"),e(window,t,(function(){return u.blur()})),e(window,"focus",(function(){return u.focus()}))):e(n,l,(function(){return n[i]?u.blur():u.focus()}),!1),s=!0,f())},u={setIdleDuration:function(e){return o=1e3*e},getIdleDuration:function(){return o},getIdleInfo:function(){var e,t;return e=+new Date,t={},"idle"===d?(t.isIdle=!0,t.idleFor=e-r,t.timeLeft=0,t.timeLeftPer=100):(t.isIdle=!1,t.idleFor=e-r,t.timeLeft=r+o-e,t.timeLeftPer=(100-100*t.timeLeft/o).toFixed(2)),t},focus:function(e){return"function"==typeof e?this.on("focus",e):(d="active",t.fire(this,"focus"),t.fire(this,"wakeup"),t.fire(this,"statusChanged",{status:d})),this},blur:function(e){return"function"==typeof e?this.on("blur",e):(d="hidden",t.fire(this,"blur"),t.fire(this,"idle"),t.fire(this,"statusChanged",{status:d})),this},idle:function(e){return"function"==typeof e?this.on("idle",e):(d="idle",t.fire(this,"idle"),t.fire(this,"statusChanged",{status:d})),this},wakeup:function(e){return"function"==typeof e?this.on("wakeup",e):(d="active",t.fire(this,"wakeup"),t.fire(this,"statusChanged",{status:d})),this},on:function(e,n){return c(),t.add(this,e,n),this},off:function(e,n){return c(),t.remove(this,e,n),this},onEvery:function(e,t){var n,i;return c(),n=!1,t&&(i=setInterval((function(){if("active"===d&&!1===n)return t()}),1e3*e)),{stop:function(){return clearInterval(i)},pause:function(){return n=!0},resume:function(){return n=!1},code:i,callback:t}},now:function(e){return c(),d===(e||"active")}}}(),o=function(){function e(t){var n=t.callback,i=t.privacyMode,r=void 0!==i&&i,o=t.rejectMode,a=void 0!==o&&o,u=t.interval,c=void 0===u?5e3:u;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.callback=n,this.privacyMode=r,this.interval=null,this.pingCount=0,this.currentFreq=c,this.initialized=!1,this.running=!1,this.tracker=function(){},a||this.init()}return n(e,[{key:"init",value:function(){var e=this;i({name:"[TimeOnPage Tracker] initializing tracker"}),this.rejectMode=!1,function(e){var t=!1,n=function(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",i),window.removeEventListener("load",i)):(document.detachEvent("onreadystatechange",i),window.detachEvent("onload",i))},i=function(){t||!document.addEventListener&&"load"!==event.type&&"complete"!==document.readyState||(t=!0,n(),e())};if("complete"===document.readyState||"loaded"===document.readyState||"interactive"===document.readyState||document.body)e();else if(document.addEventListener)document.addEventListener("DOMContentLoaded",i),window.addEventListener("load",i);else{document.attachEvent("onreadystatechange",i),window.attachEvent("onload",i);var r=!1;try{r=null==window.frameElement&&document.documentElement}catch(e){}r&&r.doScroll&&function i(){if(!t){try{r.doScroll("left")}catch(e){return setTimeout(i,50)}t=!0,n(),e()}}()}}((function(){e.tracker=e.initTracker()}))}},{key:"initTracker",value:function(){var e=this;try{var t=function(){return e.startPing()},n=function(){return e.stopPing()};return t(),r.setIdleDuration(3600),r.on("blur",(function(){i({name:"[TimeOnPage Tracker] blur - stopping ping"}),n()})),r.on("focus",(function(){i({name:"[TimeOnPage Tracker] focus - starting ping"}),t()})),r.on("idle",(function(){i({name:"[TimeOnPage Tracker] idle - stopping ping"}),n()})),r.on("wakeup",(function(){i({name:"[TimeOnPage Tracker] wakeup - starting ping"}),t()})),function(){i({name:"[TimeOnPage Tracker] cleanup - stopping ping"}),e.stopPing()}}catch(e){i({name:"[TimeOnPage Tracker] cannot initialize tracker"}),window.ktag.bugsnag.reportError(e)}}},{key:"disable",value:function(){this.rejectMode=!0,this.initialized=!1,this.tracker()}},{key:"startPing",value:function(){this.initialized||(this.running=!0,this.initialized=!0,this.trackPingTimeOnPage())}},{key:"stopPing",value:function(){i({name:"[TimeOnPage Tracker] clearing interval"}),this.initialized=!1,clearInterval(this.interval)}},{key:"trackPingTimeOnPage",value:function(){var e=this;this.initialized&&!this.rejectMode&&(i({name:"[TimeOnPage Tracker] ping"}),this.interval&&clearInterval(this.interval),this.interval=setTimeout((function(){e.callback({type:"time_on_page_ping",freq:e.currentFreq}),e.pingCount+=1,120===e.pingCount&&e.stopPing(),e.trackPingTimeOnPage()}),this.currentFreq))}}]),e}();window.ktag&&(window.ktag.TimeOnPageTracker=o)}();
