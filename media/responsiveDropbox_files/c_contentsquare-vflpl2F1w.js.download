!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="30bb241f-b516-3bab-b431-d056a78b1141")}catch(e){}}();
define(["./c_bem"],(function(t){"use strict";const e=["childListType","movedNodes"],s=["ri","rst","let"];window.CS_CONF={isSMB:!1,projectId:5416,status:1,hostnames:["experience.dropbox.com","dropbox.com","dev.corp.dropbox.com","localhost"],crossDomainTracking:0,crossDomainSingleIframeTracking:0,consentRequired:1,allowSubdomains:1,visitorCookieTimeout:34164e6,sampleRate:100,replayRecordingRate:25,validationRate:10,lastTrackingDraw:1741898835,trackerDomain:"c.contentsquare.net",recordingDomain:"r.contentsquare.net",useMalkaPipeline:1,ed:"l.contentsquare.net/log/web",eMerchandisingEnabled:0,mouseMoveHeatmapEnabled:1,autoInsightsEnabled:0,jsErrorsEnabled:1,customErrorsEnabled:0,jsCustomErrorsEnabled:0,apiErrorsEnabled:1,customHashIdEnabled:0,recordingEncryptionEnabled:0,recordingEncryptionPublicKey:null,recordingEncryptionPublicKeyId:0,secureCookiesEnabled:0,triggerSessionReplayEnabled:0,triggerSessionReplayRegex:null,dynamicIdRegex:null,whitelistedAttributes:[],replayRecordingUnmaskedUrlRegex:"",replayRecordingUnmaskedUrlRegexRules:[],replayRecordingMaskedUrlRegexRules:[],replayRecordingMaskedUrlRegex:"",anonymisationMethod:"replayRecordingUnmaskedUrlRegex",tagDeploymentMode:"CONTENTSQUARE",experimental:null,iframesTracking:1,textVisibilityEnabled:0,cookielessTrackingEnabled:0,malkaUrlEnabled:0,malkaEtrEnabled:0,pathComputationRules:{reliableSelectors:[],uniqueAttributes:[],uniqueCssSelectors:[]},asyncSerializerEnabled:1,pendingInactivityTimeout:5e3,accessibilityEnabled:0,uxaDomain:"app.contentsquare.com",webviewsTrackingEnabled:0,useStaticResourceManager:1,performanceTimingOptions:{withResource:!1,withNavigation:!1},replayConsentRequiredForSession:0,eventsApiEnabled:0,clickedElementTextEnabled:0,collectHierarchy:0,apiErrors:{collectStandardHeaders:0,collectionRules:[]},displayAdOptions:null,taskSchedulerOptions:{enabled:1},malkaQuotaServiceDomain:"q-aus1.contentsquare.net",malkaRecordingDomain:"k-aus1.contentsquare.net",staticResourceManagerDomain:"srm.bf.contentsquare.net",voc:{siteId:null,enabled:0}},(()=>{var i={d:(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}};i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};function r(t,e){let s;return window.Zone&&"function"==typeof window.Zone.__symbol__&&(s=t[window.Zone.__symbol__(e)]),s||(s=t[e]),s}i.r(n),i.d(n,{getRequestParameters:()=>Rc});const o="undefined"==typeof window,a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof process?process:Function("return this")(),c="cs-native-frame",h={navigatorProperties:[{propertyName:"sendBeacon",binding:navigator}],nodeProperties:["childNodes","parentNode","nextSibling","firstChild"],elementProperties:["shadowRoot"],elementPropertiesValues:["matches","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector"],eventProperties:["target"],imageProperties:["src"],constructors:{Date:"csDate",JSON:"csJSON",Array:"csArray",String:"csString",URL:"csURL",MutationObserver:"csMutationObserver",screen:"csScreen",RegExp:"csRegExp"}};function l(t){var e,s;Object.keys(h.constructors).forEach((e=>{window[h.constructors[e]]=t[e]instanceof Function&&null==t[e].prototype?t[e].bind(window):t[e]})),function(t){window.csquerySelector={1:t.Element.prototype.querySelector,9:t.Document.prototype.querySelector,11:t.DocumentFragment.prototype.querySelector},window.csquerySelectorAll={1:t.Element.prototype.querySelectorAll,9:t.Document.prototype.querySelectorAll,11:t.DocumentFragment.prototype.querySelectorAll}}(t),("Prototype"in window||/^((?!chrome|android).)*safari/i.test(navigator.userAgent))&&(window.csMutationObserver=null!==(s=null!==(e=r(window,"MutationObserver"))&&void 0!==e?e:window.WebKitMutationObserver)&&void 0!==s?s:window.MutationObserver),d("csNode",h.nodeProperties,t.Node.prototype,"get"),d("csElement",h.elementProperties,t.Element.prototype,"get"),d("csElement",h.elementPropertiesValues,t.Element.prototype,"value",!1),d("csHTMLImageElement",h.imageProperties,t.HTMLImageElement.prototype,"set"),d("csEvent",h.eventProperties,t.Event.prototype,"get"),d("csNavigator",h.navigatorProperties,t.navigator,"value")}function d(t,e,s,i){let n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.forEach((e=>{const r="string"!=typeof e&&"binding"in e,o=r?e.propertyName:e;(n||o in s)&&(window[`${t+o}`]=function(t,e,s){const i=function(t,e){let s,i=t;for(;i&&!(s=Object.getOwnPropertyDescriptor(i,e));)i=Object.getPrototypeOf(i);return s}(t,e);if(!i)return function(){return this[e]};switch(s){case"get":return i.get;case"set":return i.set;case"value":return i.value}}(s,o,i),r&&(window[`${t+o}`]=window[`${t+o}`].bind(e.binding)))}))}function u(t,e){window.CSProtectnativeFunctionsLogs=window.CSProtectnativeFunctionsLogs||{},window.CSProtectnativeFunctionsLogs[t]=e}if(window.csSetTimeout=r(window,"setTimeout"),window.csQueueMicrotask=r(window,"queueMicrotask"),window.csClearTimeout=r(window,"clearTimeout"),window.csSetInterval=r(window,"setInterval"),window.csClearInterval=r(window,"clearInterval"),(()=>{var t;let e=0;function s(t){return"cs$Symbol_"+t}function i(t){return s(t)+ ++e}i.for=s,window.csSymbol=null!==(t=window.Symbol)&&void 0!==t?t:i})(),!function(){try{const t=function(){const t=document.createElement("iframe");t.id=c,t.setAttribute("hidden",""),t.setAttribute("title","Intentionally blank"),t.setAttribute("sandbox","allow-same-origin");const e=document.createElement("cs-native-frame-holder");if(e.setAttribute("hidden",""),document.body.appendChild(e),Boolean(Element.prototype.attachShadow)){const s=e.attachShadow({mode:"closed"});return s.innerHTML=t.outerHTML,s.firstElementChild.contentWindow}return e.innerHTML=t.outerHTML,e.firstElementChild.contentWindow}();return!!t&&(window.CSPureWindow=t,l(window.CSPureWindow),!0)}catch(t){return u("Warning",`failed to copy references from pure iframe: ${t.message}`),!1}}())try{l(a)}catch(da){u("Critical",`failed to copy references from window: ${da.message}`)}function p(t){return g(csString.prototype.toLowerCase.call(t.localName))}function g(t){return csString.prototype.replace.call(t,/([#;&,.+*~':"!^$[\]()<=>|/%?@`{}\\ ])/g,"\\$1")}function m(t){return S(t)&&("number"==typeof t||t instanceof Number)&&!isNaN(t)}function y(t){return t===parseInt(t,10)}function f(t){return S(t)&&("string"==typeof t||t instanceof csString)}function v(t){return"boolean"==typeof t}function E(t){return"object"==typeof t}function S(t){return void 0!==t}function w(t){return S(t)&&null!==t}function R(t){return"function"==typeof t}function A(t){return t instanceof Element}function b(t){return t instanceof Error}function T(t){const e=t.length;for(let s=0;s<e;s++)switch(csString.prototype.charCodeAt.call(t,s)){case 9:case 10:case 11:case 12:case 13:case 32:case 160:continue;default:return!1}return!0}function C(t){return 1===t.nodeType}function _(t){return 3===t.nodeType}function N(t){return C(t)&&"link"===t.localName}function I(t){return C(t)&&"a"===t.localName}function O(t){return N(t)&&-1!==csString.prototype.indexOf.call(t.rel,"stylesheet")}function P(t){return C(t)&&"style"===t.localName}function k(t){return C(t)&&"input"===t.localName}function L(t){return C(t)&&"textarea"===t.localName}function M(t){return C(t)&&"script"===t.localName}function D(t){return C(t)&&"ownerSVGElement"in t}function x(t){return C(t)&&"select"===t.localName}function U(t){switch(t.nodeType){case 9:case 11:case 1:return!0;default:return!1}}function V(t){return 9===t.nodeType}function B(t){return function(t){switch(t.nodeType){case 9:case 11:return!0;default:return!1}}(t)&&"host"in t&&"mode"in t}function H(t){return C(t)&&!!csElementshadowRoot.apply(t)&&B(csElementshadowRoot.apply(t))}const $=["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"],q="detached";function z(t){let e=t;const s=[e];for(;null!==csNodeparentNode.apply(e);)e=csNodeparentNode.apply(e),csArray.prototype.push.call(s,e);return F(e)&&csArray.prototype.push.call(s,q),{ancestors:s,selectionRoot:e}}function F(t){return zt.isValidElement(t)}var j,G;const W=null!==(G=null===(j=a.Element)||void 0===j?void 0:j.prototype)&&void 0!==G?G:{},Y=W.matches||W.matchesSelector||W.mozMatchesSelector||W.msMatchesSelector||W.oMatchesSelector||W.webkitMatchesSelector,Q=W.closest;function Z(t,e){return!!e&&csArray.prototype.some.call(e,(e=>Y.call(t,e)))}const X=[/\d{4}/,/^ember\d+$/],K="data-cs-override-id",J="data-cs-dynamic-id";function tt(t,e,s,i){const n=i.dynamicIdRegex||null,r=i.dynamicElementNameRegex;let o=p(t);if(r&&r.test(t.localName)&&(o=csString.prototype.replace.call(o,r,"$1@")),function(t,e){const s=et(t);return s&&csString.prototype.match.call(s,/^[\w-]+$/)&&st(K,s,e)}(t,s)){const e=et(t);return{hasUniqueIdentifier:!0,elementSelector:`${o}[${K}="${e}"]`}}const a=function(t,e,s){if(!s.uniqueAttributes)return{success:!1};for(const i of s.uniqueAttributes){const s=t.getAttribute(i);if(null!==s&&st(i,s,e))return{attributeName:i,attributeValue:s,success:!0}}return{success:!1}}(t,s,i);if(a.success)return{hasUniqueIdentifier:!0,elementSelector:`${o}#UA[${a.attributeName}="${a.attributeValue}"]`};const c=function(t,e,s){if(s.uniqueCssSelectors)for(const i of s.uniqueCssSelectors)if(Y.call(t,i)&&it(i,e))return i}(t,s,i);if(c)return{hasUniqueIdentifier:!0,elementSelector:`${o}#UCS[${c}]`};const h=function(t){const e=t.getAttribute("id");return e?g(e):e}(t);if(function(t,e,s,i){return e&&!function(t){return null!==et(t)}(t)&&!function(t,e,s){return t.hasAttribute(J)||function(t,e){let s=!1;return t&&e&&(s=e.test(t)),t&&(csArray.prototype.some.call(X,(e=>e.test(t)))||s)}(e,s)}(t,e,i)&&function(t,e){return t&&st("id",t,e)}(e,s)}(t,h,s,n))return{hasUniqueIdentifier:!0,elementSelector:`${o}#${h}`};const l=function(t,e){if(e.reliableSelectors)for(const s of e.reliableSelectors)if(Y.call(t,s))return s}(t,i);if(l){const s=function(t,e,s){if(t===q||9===t.nodeType)return 0;let i=0,n=e.previousElementSibling;for(;n;)Y.call(n,s)&&(i+=1),n=n.previousElementSibling;return i}(e,t,l);return{hasUniqueIdentifier:!1,elementSelector:`${o}[${l}](${s})`}}const d=function(t,e,s){if(t===q||9===t.nodeType)return 0;const i=s.dynamicElementNameRegex,n=!!(null==i?void 0:i.test(e.localName)),r=p(e);let o=0,a=e.previousElementSibling;for(;a;)(p(a)===r||n&&(null==i?void 0:i.test(a.localName)))&&!Z(a,s.reliableSelectors)&&(o+=1),a=a.previousElementSibling;return o}(e,t,i);return{hasUniqueIdentifier:!1,elementSelector:`${o}:eq(${d})`}}function et(t){return t.getAttribute(K)}function st(t,e,s){try{return 1===window.csquerySelectorAll[s.nodeType].call(s,`[${t}="${e}"]`).length}catch(t){if("SyntaxError"!==t.name)throw t}return!1}function it(t,e){try{return 1===window.csquerySelectorAll[e.nodeType].call(e,t).length}catch(t){if("SyntaxError"!==t.name)throw t}return!1}function nt(t,e,s){const i=csArray.prototype.shift.call(t);if(0===t.length)return rt(i,s);const n=i,r=t[0],{elementSelector:o,hasUniqueIdentifier:a}=tt(n,r,e,s);if(!s.fullPath&&a)return`${rt(t[t.length-1],s)}${o}`;const c=nt(t,e,s);return`${c?`${c}>`:""}${o}`}function rt(t,e){if(t===q)return"|detached|";if(t.host){const{ancestors:s,selectionRoot:i}=z(t.host);return`${nt(s,i,e)}|shadow-root|`}return 11===t.nodeType?"|fragment|":""}class ot{constructor(t){this.options=t,this.done=!1,this.path=null}getPath(){if(null===this.path)throw new Error("getPath was called before serializeElement");return this.path}isDone(){return this.done}}class at extends ot{constructor(){super(...arguments),this.t=!1,this.i=!1,this.h=!1}u(t,e){return this.t&&!(null===e&&F(t))&&!(11===t.nodeType)&&!t.host}A(t){return!t.localName}serializeElement(t,e,s){var i;if(null!==(i=this.path)&&void 0!==i||(this.path=""),this.u(t,e))return;let n=!1;null===e&&F(t)&&(n=!0,this.done=!0);const r=this.i&&!this.options.fullPath?"":">",o=!!t.host;if(o&&this.path&&(this.path="|shadow-root|"+r+this.path,this.h=!0,this.t=!1,this.i=!1),!o&&null===e&&11===t.nodeType)return this.path="|fragment|"+r+this.path,void(this.done=!0);if(this.A(t))return;const a=null!=e?e:"detached",{elementSelector:c,hasUniqueIdentifier:h}=tt(t,a,s,this.options);h&&(this.i=!0,this.t=!this.options.fullPath);const l=`${n?`|detached|${r}`:""}${this.t&&!h?"":c}`,d=!h&&this.i&&!this.options.fullPath||!this.path||this.h?"":">";this.h=!1,this.path=`${l}${d}${this.path}`}}var ct,ht;function lt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pt.SHOW_ALL;const s=e|pt.SHOW_ELEMENT,i=[document.createTreeWalker(t,s,null,!1)];let n=dt(t);n&&csArray.prototype.push.call(i,document.createTreeWalker(n,s,null,!1));let r=null;return{root:t,nextNode(){if(n){const t=n;return n=null,t}for(;i.length>0;){if(r){const t=r;return r=null,t}const t=i[i.length-1].nextNode();if(!t){csArray.prototype.pop.call(i);continue}const n=dt(t);if(e&pt.SHOW_DOCUMENT_FRAGMENT&&n&&(r=n),n&&csArray.prototype.push.call(i,document.createTreeWalker(n,s,null,!1)),gt[t.nodeType]&e)return t}return null},visitAll(s){gt[t.nodeType]&e&&s(t);let i=this.nextNode();for(;i;)gt[i.nodeType]&e?(s(i),i=this.nextNode()):i=this.nextNode()},collectAll(t){const e=[];return this.visitAll((s=>csArray.prototype.push.call(e,t?t(s):s))),e}}}function dt(t){return t&&H(t)?t.shadowRoot:null}const ut=null!==(ct=a.Node)&&void 0!==ct?ct:{},pt=null!==(ht=a.NodeFilter)&&void 0!==ht?ht:{},gt={2:pt.SHOW_ATTRIBUTE,4:pt.SHOW_CDATA_SECTION,8:pt.SHOW_COMMENT,11:pt.SHOW_DOCUMENT_FRAGMENT,9:pt.SHOW_DOCUMENT,10:pt.SHOW_DOCUMENT_TYPE,1:pt.SHOW_ELEMENT,[ut.ENTITY_NODE]:pt.SHOW_ENTITY,[ut.ENTITY_REFERENCE_NODE]:pt.SHOW_ENTITY_REFERENCE,[ut.NOTATION_NODE]:pt.SHOW_NOTATION,7:pt.SHOW_PROCESSING_INSTRUCTION,3:pt.SHOW_TEXT};let mt={debug(){},warn(){},implementation(){},error(){},critical(){},isPerfLoggingActive:()=>!1};const yt=t=>(e,s,i)=>{const n=(null==s?void 0:s.toString())||"",r=t||`${e.constructor&&e.constructor.name}.${n}`;if(i){const t=i.value;i.value=function(){return ft(r,t.bind(this))(...arguments)}}};function ft(t,e){return function(){try{const s=e(...arguments);return S(window.Promise)&&s instanceof window.Promise?s.then((t=>t),(e=>mt.error(b(e)?e:new Error(e),t))):s}catch(e){try{mt.error(b(e)?e:new Error(e),t)}catch(t){}}}}class vt{constructor(){this._=0}get length(){return this._}get isEmpty(){return!this.R}pushAll(t){for(let e=0;e<t.length;e++)this.push(t[e])}push(t){this._++,this.S?this.S=this.S[1]=[t,void 0]:this.S=this.R=[t,void 0]}pop(){if(!this.R)return null;this._--;const t=this.R[0];return this.R=this.R[1],this.R||(this.S=void 0),t}forEach(t){let e=this.R;for(;null==e?void 0:e.length;)t(e[0]),e=e[1]}clear(){this._=0,this.R=this.S=void 0}}let Et=50,St=.1,wt=!1;const Rt=new vt,At=[];let bt=[];function Tt(t){csArray.prototype.push.call(At,t),performance.mark(`${t}-start`)}function Ct(t){const e=performance.measure(t,`${t}-start`);if(!e)return;const s=e.duration;s>=St&&csArray.prototype.push.call(bt,{mName:t,mDuration:+s.toFixed(2)}),csArray.prototype.pop.call(At),0===At.length&&(s>Et&&Rt.push(bt),bt=[])}function _t(t,e){return function(){for(var s=arguments.length,i=new Array(s),n=0;n<s;n++)i[n]=arguments[n];if(!wt)return t.apply(this,i);Tt(e);const r=t.apply(this,i);return Ct(e),r}}const Nt=function(t){return function(e,s,i){const n=i.value;i.value=function(){if(!wt)return i.value=n,n.apply(this,arguments);Tt(t);const e=n.apply(this,arguments);return Ct(t),e}}};var It,Ot,Pt;function kt(t){var e;const s=null!==(e=t.length)&&void 0!==e?e:0,i=new csArray(s);for(let e=0;e<s;e+=1)i[e]=t[e];return i}function Lt(t,e){const s=t.length,i=new csArray(s);for(let n=0;n<s;n+=1)i[n]=e(t[n]);return i}function Mt(t,e){const s=[];return function(t,e,s){for(let i=0;i<t.length;i+=1){const n=e(t[i]);for(let t=0;t<n.length;t++)s(n[t])}}(t,e,(t=>csArray.prototype.push.call(s,t))),s}function Dt(t,e){if(t.length>=0){const s=t.length;for(let i=0;i<s;i++)e(t[i],i)}else{let s=0,i=t.next();for(;!i.done;)e(i.value,s++),i=t.next()}}function xt(t,e){const s=t.length;for(let i=0;i<s;i++)if(e(t[i],i))return t[i]}function Ut(t,e){const s=t.length;for(let i=0;i<s;i++)if(e(t[i],i))return!0;return!1}function Vt(t,e){const s=t.length,i=[];for(let n=0;n<s;n+=1){const s=t[n];e(s)&&csArray.prototype.push.call(i,s)}return i}function Bt(t,e){for(let s=0;s<t.length;s++)csArray.prototype.push.call(e,t[s])}function Ht(t){const e=t instanceof Map,s=[];return t.forEach(((t,i)=>csArray.prototype.push.call(s,e?[i,t]:t))),s}!function(t){t.isSupported=function(){return!!Element.prototype.attachShadow},t.getShadowRoot=function(t){return t&&H(t)?t.shadowRoot:null},t.getAllShadowHosts=_t((function(t){return lt(t,NodeFilter.SHOW_DOCUMENT_FRAGMENT).collectAll((t=>t.host))}),"getAllShadowHosts")}(It||(It={})),function(t){function e(){const t=[i()];return document.documentElement&&csArray.prototype.push.call(t,document.documentElement.scrollHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight),document.body&&csArray.prototype.push.call(t,document.body.scrollHeight,document.body.offsetHeight),Math.max(...t)}function s(){return document.documentElement.scrollWidth}function i(){return window.innerHeight}function n(){return window.innerWidth}function r(){const t=window.csScreen.width;return y(t)&&t>0?t:window.screen.width}function o(){const t=window.csScreen.height;return y(t)&&t>0?t:window.screen.height}t.documentHeight=e,t.documentWidth=s,t.windowHeight=i,t.windowWidth=n,t.screenWidth=r,t.screenHeight=o,t.windowOffsetX=function(){return window.pageXOffset},t.windowOffsetY=function(){return window.pageYOffset},t.getRequestParameters=function(){return{dw:`${s()}`,dh:`${e()}`,ww:`${n()}`,wh:`${i()}`,sw:`${r()}`,sh:`${o()}`}}}(Ot||(Ot={}));const $t=null!==(Pt=a.Node)&&void 0!==Pt?Pt:Object;var qt,zt;!function(t){const e="isConnected"in $t.prototype?t=>t.isConnected:t=>!(t.ownerDocument&&t.ownerDocument.compareDocumentPosition(t)&t.DOCUMENT_POSITION_DISCONNECTED);t.forEachChild=function(t,e){for(let s=t;s;s=csNodenextSibling.apply(s))e(t)},t.isConnected=function(t){return e(t)},t.getAncestors=function(t,e){const s=[];for(const n of i(t,e))csArray.prototype.push.call(s,n);return s};const s=(t,e)=>{var s;return null!==(s=csNodeparentNode.apply(t))&&void 0!==s?s:e&&B(t)?t.host:null};function i(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){let i=t;for(;i;){yield i;const t=s(i,e);if(!t||t===i)break;i=t}}()}function n(e){var s;return e.parentElement?e.parentElement:t.getRootNode(e)?null===(s=t.getRootNode(e))||void 0===s?void 0:s.host:null}function r(t){var e,s;if(!1===(null===(e=t.checkVisibility)||void 0===e?void 0:e.call(t,{checkOpacity:!0,checkVisibilityCSS:!0})))return!0;if(!t.offsetParent){if(!t.getBoundingClientRect)return mt.warn(`SUP-11432: Element doesn't have getBoundingClientRect. Node: ${t instanceof $t} Ctor: ${null===(s=null==t?void 0:t.constructor)||void 0===s?void 0:s.name}`),!1;const e=t.getBoundingClientRect();if(0==e.width&&0==e.height)return!0}const i=window.getComputedStyle(t);return!i||"none"===i.display||"hidden"===i.visibility||"collapse"===i.visibility||"0"===i.opacity||"opacity(0)"===i.filter||"0px"===i.width&&"0px"===i.height||"transparent"===(n=i.color)||/^(rgba|hsla)\(\d+, \d+%?, \d+%?, 0\)$/.test(n);var n}function o(t){const e=t.getBoundingClientRect(),s=e.left+.5*e.width,i=e.top+.5*e.height;return a(document,s,i)}function a(e,s,i){const n=e.elementFromPoint(s,i);if(!n)return null;const r=It.getShadowRoot(n);return r&&r!=t.getRootNode(document.body)&&r!==e?a(r,s,i):n}function c(t){const e=o(t);return null!==e&&(t===e||(h(t)?""!==t.textContent&&e.contains(t):t.contains(e)))}function h(t){return"span"===t.localName||"a"===t.localName||"b"===t.localName||"i"===t.localName||"button"===t.localName||"input"===t.localName||"label"===t.localName||"cite"===t.localName||"small"===t.localName||"strong"===t.localName||"code"===t.localName||"abbr"===t.localName||"em"===t.localName||"dfn"===t.localName||"time"===t.localName||"output"===t.localName||"object"===t.localName||"sub"===t.localName}t.findAncestor=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t;for(;n;){if(e(n))return n;const t=s(n,i);if(!t||t===n)break;n=t}return null},t.walkUp=i,t.isDescendantOf=function e(s,i){if(s===i||i.contains(s))return!0;const n=t.getParentElement(s);return!(!n||n===s)&&e(n,i)},t.getParentElement=n,t.findAllElements=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const s=kt(window.csquerySelectorAll[e.nodeType].call(e,t)),i=It.getAllShadowHosts(e);for(const e of i){const i=It.getShadowRoot(e);if(!i)continue;const n=kt(window.csquerySelectorAll[i.nodeType].call(i,t));csArray.prototype.push.call(s,...n)}return s},t.getRootNode=(()=>{if("getRootNode"in $t.prototype)return(t,e)=>t.getRootNode(e);function t(s){const i=e(s);return B(i)?t(i.host):i}function e(t){return null!=csNodeparentNode.apply(t)?e(csNodeparentNode.apply(t)):t}return(s,i)=>"object"==typeof i&&Boolean(i.composed)?t(s):e(s)})(),t.isHiddenByCSS=r,t.areAncestorsHiddenByCSS=function t(e){if(r(e))return!0;const s=n(e);return null!=s&&t(s)},t.getTopAncestorHiddenByCSS=function(t){let e=null,s=t;do{if(!r(s))break;e=s}while(s=n(s));return e},t.getTopElement=o,t.getElementOnTop=function(e){if(!e.getBoundingClientRect)return null;const s=e.getBoundingClientRect(),i=s.x+s.width/2,n=s.y+s.height/2;return t.getTopElementFromPoint(document,i,n)},t.getTopElementFromPoint=a,t.isVisibleInDocument=function(t){return!function(t){const e=t.getBoundingClientRect();return e.right+Ot.windowOffsetX()<0||e.bottom+Ot.windowOffsetY()<0}(t)&&!r(t)&&!function(t){const e=o(t);return null!==e&&!t.contains(e)&&!e.contains(t)}(t)},t.isVisibleInViewportInForeground=function(t){return!r(t)&&c(t)},t.isInViewPort=c,t.getAttributeNS=function(t,e,s){const i=t.getAttributeNS(e,s);return""===i?t.hasAttributeNS(e,s)?i:null:i},t.isElementFocusable=function(t){return!(!t.hasAttribute("tabIndex")&&"true"!==t.getAttribute("contentEditable")&&(!I(t)||!t.hasAttribute("href"))&&(!(x(t)||L(t)||k(t)||(e=t,C(e)&&"button"===e.localName))||t.hasAttribute("disabled"))&&!function(t){return C(t)&&"details"===t.localName}(t)&&!function(t){return C(t)&&"summary"===t.localName}(t));var e},t.isInlineElement=h}(qt||(qt={}));class Ft{constructor(t){this.T=t}run(t){const e=[...this.T];let s=qt.getAncestors(t,!1),i=s[s.length-1];for(;e.length>0&&s.length>0;){const t=csArray.prototype.shift.call(s),n=s[0]||null;if(this.I(e,t,n,i),this.P(e),0===e.length)break;0===s.length&&t.host&&(s=qt.getAncestors(t.host,!1),i=s[s.length-1])}}I(t,e,s,i){for(const n of t)n.serializeElement(e,s,i)}P(t){for(let e=0;e<t.length;e++)t[e].isDone()&&(csArray.prototype.splice.call(t,e,1),e--)}}class jt extends ot{serializeElement(t){var e;if(null!==(e=this.path)&&void 0!==e||(this.path=""),("detached"===t||"body"===t.localName)&&(this.done=!0,this.path.length>0))return;let s=this.V(t);s+=s.length>0?"|":"",this.path.length+s.length>this.options.hierarchyMaxLength?this.done=!0:this.path=s+this.path}V(t){if(!t.localName)return"";let e=`@${t.localName};`;return e+=this.C(t.id),t.classList&&(e+=this.O(csArray.from(t.classList))),t.attributes&&(e+=this.N(t)),e}C(t){return t?`#${t};`:""}O(t){return t.length>0?`.${csArray.prototype.join.call(csArray.prototype.sort.call(t),";.")};`:""}$(t,e){var s,i;return(null===(i=(s=this.options).isAttributeSensitive)||void 0===i?void 0:i.call(s,t,e))||-1!==csArray.prototype.indexOf.call(this.options.attributeIgnoreTokens,e)||D(t)&&-1===csString.prototype.indexOf.call(e,"data-")&&"aria-label"!==e||k(t)&&"value"===e}M(t,e){return this.options.useAnonymization&&!this.options.allWhitelistedAttributes.has(t)||e.length>this.options.attrMaxLength}L(t){const e={};for(const s of csArray.from(t.attributes))this.$(t,s.name)||(e[s.name]=s.value);return e}N(t){var e,s;if(null===(s=(e=this.options).isNodeSensitive)||void 0===s?void 0:s.call(e,t))return"";const i=Object.entries(this.L(t));return csArray.prototype.join.call(csArray.prototype.sort.call(csArray.prototype.map.call(csArray.prototype.filter.call(i,(t=>{let[e]=t;return e.length<this.options.attrMaxLength})),(t=>{let[e,s]=t;return this.M(e,s)?`[${e}]`:`[${e}=${s}]`}))),";")+(i.length>0?";":"")}}!function(t){function e(t){return!!t&&"localName"in t&&"getAttribute"in t&&"hasAttribute"in t&&"parentNode"in t}function s(t){return t&&"jquery"in t&&1===t.length?t[0]:t}t.INVALID_ELEMENT="INVALID_ELEMENT",t.isValidElement=e,t.getElementPathAndHierarchy=function(i,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{fullPath:!1,dynamicIdRegex:null};const o=s(i);if(o===document)return{path:"",hierarchy:""};if(!e(o))return{path:t.INVALID_ELEMENT,hierarchy:t.INVALID_ELEMENT};const a=new at(r),c=new jt(n);return new Ft([a,c]).run(o),{path:a.getPath(),hierarchy:c.getPath()}},t.getElementPath=function(i){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fullPath:!1,dynamicIdRegex:null};const r=s(i);if(r===document)return"";if(!e(r))return t.INVALID_ELEMENT;const{ancestors:o,selectionRoot:a}=z(r);return nt(o,a,n)},t.getElementPathAndFirstAnchorParent=function(i){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fullPath:!1,dynamicIdRegex:null};const r=s(i);if(r===document)return{path:"",firstAnchorParent:null};if(!e(r))return{path:t.INVALID_ELEMENT,firstAnchorParent:null};const{firstAnchorParent:o,ancestors:a,selectionRoot:c}=function(t){let e=t;const s=[e];let i=null;for(;null!==csNodeparentNode.apply(e);)null===i&&I(e)&&(i=e),csArray.prototype.push.call(s,csNodeparentNode.apply(e)),e=csNodeparentNode.apply(e);return F(e)&&csArray.prototype.push.call(s,q),{firstAnchorParent:i,ancestors:s,selectionRoot:e}}(r);return{path:nt(a,c,n),firstAnchorParent:o}}}(zt||(zt={})),window.CSPathComputation=window.CSPathComputation||zt;const Gt=Number.MAX_SAFE_INTEGER||9007199254740991;function Wt(){}function Yt(t,e){return 0===csString.prototype.lastIndexOf.call(t,e,0)}const Qt=34164e6,Zt={percentage:()=>Math.floor(1e4*Math.random())/100,boolean(t){return this.percentage()<t},integer:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gt;return Math.floor(Math.random()*t)}},Xt=csSymbol("cachedJson"),Kt=void 0!==window.Symbol?function(t){if(t[Xt])return t[Xt];if(csArray.isArray(t)){if(0===t.length)return"[]";let e="["+Kt(t[0]);for(let s=1;s<t.length;s++)e+=","+Kt(t[s]);return e+="]"}return t[Xt]=csJSON.stringify(t)}:csJSON.stringify,Jt=/^\d+\.\d+(?:\.\d+)?$/;class te{constructor(e){var s,i,n,r,o,a;this.isSMB=null!==(s=e.isSMB)&&void 0!==s&&s,this.trackerDomain=e.trackerDomain,this.dynamicConfDomain=e.dynamicConfDomain,this.tagDomain=e.tagDomain,this.loggerDomain=e.ed,this.minLogLevel=e.logLevel,this.projectId=e.projectId,this.smbConfig=e.smbConfig,this.status=e.status,this.hostnames=e.hostnames,this.iframesTracking=!!e.iframesTracking,this.crossDomainTracking=!!e.crossDomainTracking,this.crossDomainSingleIframeTracking=!!e.crossDomainSingleIframeTracking,this.consentRequired=!!e.consentRequired,this.allowSubdomains=!!e.allowSubdomains,this.visitorCookieTimeout=e.visitorCookieTimeout||Qt,this.sampleRate=e.sampleRate,this.replayRecordingRate=e.replayRecordingRate,this.validationRate=e.validationRate,this.lastTrackingDraw=e.lastTrackingDraw||1,this.useHttps=!0,this.eMerchandisingEnabled=e.eMerchandisingEnabled,this.mouseMoveHeatmapEnabled=e.mouseMoveHeatmapEnabled,this.jsErrorsEnabled=e.jsErrorsEnabled,this.apiErrors=t._objectSpread2({enabled:null!==(i=e.apiErrorsEnabled)&&void 0!==i?i:0},e.apiErrors),this.customErrors=t._objectSpread2({enabled:null!==(n=e.customErrorsEnabled)&&void 0!==n?n:0},e.customErrors),this.jsCustomErrorsEnabled=e.jsCustomErrorsEnabled,this.triggerSessionReplayEnabled=e.triggerSessionReplayEnabled,this.triggerSessionReplayRegex=this.D(e.triggerSessionReplayRegex),this.dynamicIdRegex=e.dynamicIdRegex?new csRegExp(e.dynamicIdRegex):null,this.whitelistedAttributes=e.whitelistedAttributes||[],this.replayRecordingUnmaskedUrlRegex=this.D(e.replayRecordingUnmaskedUrlRegex),this.replayRecordingMaskedUrlRegex=this.D(e.replayRecordingMaskedUrlRegex),this.replayRecordingMaskedUrlRegexRules=e.replayRecordingMaskedUrlRegexRules||null,this.replayRecordingUnmaskedUrlRegexRules=e.replayRecordingUnmaskedUrlRegexRules||null,this.anonymisationMethod=e.anonymisationMethod||null,this.tagDeploymentMode=e.tagDeploymentMode,this.dualCollectionTagDomain=e.dualCollectionTagDomain||null,this.ptcDomain=e.ptcDomain||null,this.ptcGuid=e.ptcGuid||null,this.secureCookiesEnabled=!!e.secureCookiesEnabled,this.ptcSha512=e.ptcSha512||null,this.ptcSnapshotPath=e.ptcSnapshotPath||null,this.emitDebugEvents=!1,this.malkaQuotaServiceDomain=e.malkaQuotaServiceDomain||null,this.staticResourceManagerDomain=e.staticResourceManagerDomain||null,this.malkaRecordingDomain=e.malkaRecordingDomain||null,this.textVisibilityEnabled=e.textVisibilityEnabled,this.experimental=e.experimental||{},this.malkaEtrEnabled=!!e.malkaEtrEnabled,this.malkaUrlEnabled=!!e.malkaUrlEnabled,this.cookielessTrackingEnabled=e.cookielessTrackingEnabled,this.customHashIdEnabled=!!e.customHashIdEnabled,this.encryptionEnabled=!!e.recordingEncryptionEnabled,this.encryptionPublicKey=e.recordingEncryptionPublicKey||null,this.pathComputationRules=e.pathComputationRules||{},e.pathComputationRules&&""===e.pathComputationRules.dynamicElementNameRegex&&(this.pathComputationRules.dynamicElementNameRegex=null),e.pathComputationRules&&e.pathComputationRules.dynamicElementNameRegex&&(this.pathComputationRules.dynamicElementNameRegex=new csRegExp(e.pathComputationRules.dynamicElementNameRegex)),this.asyncSerializerEnabled=!!e.asyncSerializerEnabled,this.encryptionPublicKeyId=e.recordingEncryptionPublicKeyId,this.pendingInactivityTimeout=e.pendingInactivityTimeout||5e3,this.accessibilityEnabled=!!e.accessibilityEnabled,this.useStaticResourceManager=!!e.useStaticResourceManager,e.taskSchedulerOptions&&(this.taskSchedulerOptions=t._objectSpread2(t._objectSpread2({},e.taskSchedulerOptions),{},{enabled:!!e.taskSchedulerOptions.enabled})),this.uxaDomain=e.uxaDomain,this.environment=(null===(r=e.uxaDomain)||void 0===r?void 0:r.indexOf("staging"))>-1?"staging":"production",this.performanceTimingOptions=e.performanceTimingOptions,this.replayConsentRequiredForSession=!!e.replayConsentRequiredForSession,this.isWebView=!1,e.displayAdOptions&&e.displayAdOptions.length&&(this.displayAdOptions=e.displayAdOptions),e.voc&&(this.voc=t._objectSpread2(t._objectSpread2({},e.voc),{},{enabled:!!e.voc.enabled})),e.heapEnvironment&&(this.heapEnvironment=e.heapEnvironment),e.implementations&&e.implementations.length&&(this.implementations=e.implementations),this.eventsApiEnabled=!!e.eventsApiEnabled,this.anonymizeDigits=null!==(o=e.anonymizeDigits)&&void 0!==o?o:null,this.isHeapPresent=void 0!==window.heap,this.clickedElementTextEnabled=!!e.clickedElementTextEnabled,this.recordTargetingRules=null!==(a=e.recordTargetingRules)&&void 0!==a?a:[],this.paProxyDomainUri=e.paProxyDomainUri||null,this.emitRecordInfoEvents=0!=e.emitRecordInfoEvents,this.collectHierarchy=!!e.collectHierarchy}getTrackerUri(){return`${this.U()}://${this.trackerDomain}`}getSentryFileUri(){return`${this.U()}://${this.tagDomain}/uxa/smb/errors.js`}getSentryDSNUri(){return`https://f553e78fb58e051e51fe8074c4c6e73e@${this.loggerDomain}/4508608369131520`}getRecordingUri(){return`${this.U()}://${this.malkaRecordingDomain}`}getLegacyQuotaUri(){return`${this.U()}://${this.malkaQuotaServiceDomain}`}getLoggerUri(){return`${this.U()}://${this.loggerDomain}`}getMetricsUri(){return`${this.U()}://${this.loggerDomain}/metrics`}getStaticResourceManagerUri(){return`${this.U()}://${this.staticResourceManagerDomain}`}getQuotaUri(){return`${this.U()}://${this.dynamicConfDomain}/${this.projectId}.json`}isQuotaEnabled(){return this.isSMB&&!!this.dynamicConfDomain}getPaProxyDomainUri(){return`${this.U()}://${this.paProxyDomainUri}`}U(){return this.useHttps?"https":"http"}isProjectActive(){return 1===this.status}processOptionOverrides(t){t&&t.forEach&&t.forEach((t=>{let[e,...s]=t;if("setOption"===e){const[t,e]=s;this.F(t,e)}}))}F(t,e){"trackerDomain"===t&&(this.trackerDomain=e),"loggerDomain"===t&&(this.loggerDomain=e),"malkaRecordingDomain"===t&&(this.malkaRecordingDomain=e),"malkaQuotaServiceDomain"===t&&(this.malkaQuotaServiceDomain=e),"staticResourceManagerDomain"===t&&(this.staticResourceManagerDomain=e),"minLogLevel"===t&&(this.minLogLevel=e),"useHttps"===t&&(this.useHttps=!!e),"isWebView"===t&&(this.isWebView=e)}D(t){return t?this.B(t):null}getRequestParameters(){return{pid:`${this.projectId}`}}updateDynamicFields(t,e){"emitDebugEvents"===t&&(this.emitDebugEvents=e),"minLogLevel"===t&&(this.minLogLevel=e)}B(t){try{const e=/^\/(.*)\/([gim]*)$/.exec(t);if(e){const[,t,s]=e;return new csRegExp(`^${t}$`,s)}return new csRegExp(`^${t}$`)}catch(t){return null}}isHeaderCollectionActive(){var t,e;return this.apiErrors.collectStandardHeaders||!!(null===(t=this.apiErrors.validCustomHeaders)||void 0===t?void 0:t.length)||!!(null===(e=this.apiErrors.plainCustomHeaders)||void 0===e?void 0:e.length)}isCsSideloadingHeap(){var t;return"cs_sideloads_heap"===(null===(t=this.heapEnvironment)||void 0===t?void 0:t.heap_tag_status)&&!this.isHeapPresent}isHeapSideloadsCs(){var t;return"heap_sideloads_cs"===(null===(t=this.heapEnvironment)||void 0===t?void 0:t.heap_tag_status)}isHeapSideloadsCsV5(){var t;return"heap_sideloads_cs"===(null===(t=this.heapEnvironment)||void 0===t?void 0:t.heap_tag_status)&&this.q()}isHeapSideloadsStartDataCollection(){if(this.isHeapSideloadsCs()){if(this.q())return!0;const t=(t=>{if(!Jt.test(t))return;const[e,s,i]=csArray.prototype.map.call(csString.prototype.split.call(t,"."),Number);return{major:e,minor:s,patch:!i||Number.isNaN(i)?0:i}})(this.getHeapVersion()||"");if(t&&4===t.major&&((t,e)=>((t,e)=>t.major!==e.major?t.major-e.major:t.minor!==e.minor?t.minor-e.minor:t.patch-e.patch)(t,{major:4,minor:23,patch:5})>=0)(t))return!0}return!1}q(){var t;return"function"==typeof(null===(t=window.heap)||void 0===t?void 0:t.getUserId)}getHeapVersion(){var t,e,s,i,n,r;return"function"==typeof(null===(t=window.heap)||void 0===t?void 0:t.getConfig)&&(null===(i=null===(s=null===(e=window.heap)||void 0===e?void 0:e.getConfig())||void 0===s?void 0:s.sdk)||void 0===i?void 0:i.version)||(null===(r=null===(n=window.heap)||void 0===n?void 0:n.version)||void 0===r?void 0:r.heapJsVersion)||void 0}isCsCrosswritingHeap(){var t;return"cs_crosswrites_heap"===(null===(t=this.heapEnvironment)||void 0===t?void 0:t.heap_tag_status)}isClickedElementTextEnabled(){return this.isSMB||this.clickedElementTextEnabled}isNetworkDetailsEnabled(){return!!this.performanceTimingOptions&&(this.performanceTimingOptions.withResource||this.performanceTimingOptions.withNavigation)}hasTargetingRules(){var t;return!!(null===(t=this.recordTargetingRules)||void 0===t?void 0:t.length)}}class ee{constructor(t,e){this.H=t,this.j=e}init(){this.G=this.H!==this.H.top,this.Z=this.j.isWebView&&this.H===this.H.top,this.j.iframesTracking&&this.G||this.Z?this.W=!1:this.W=!0}isInIframeContext(){return this.G}isTopWindowTracker(){return this.W}isInWebViewContext(){return this.Z}}var se,ie;!function(t){t.debug="debug",t.warn="warn",t.implementation="implementation",t.error="error",t.critical="critical"}(se||(se={})),function(t){t.toQuery=function(t){return csArray.prototype.join.call(csArray.prototype.map.call(Object.keys(t),(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`)),"&")}}(ie||(ie={}));class ne{constructor(t,e){this.domainUri=t,this.path=e,this.beforeRequestCallbacks=[],this.afterRequestCallbacks=[]}setRequestParametersProviders(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.requestParametersProviders=e}before(t){csArray.prototype.push.call(this.beforeRequestCallbacks,t)}after(t){csArray.prototype.push.call(this.afterRequestCallbacks,t)}retrieveParameters(){return this.requestParametersProviders?csArray.prototype.reduce.call(csArray.prototype.map.call(this.requestParametersProviders,(t=>t.getRequestParameters())),((e,s)=>t._objectSpread2(t._objectSpread2({},e),s))):{}}}class re extends ne{constructor(t,e){super(t,e)}send(){csArray.prototype.forEach.call(this.beforeRequestCallbacks,(t=>t()));const t=this.retrieveParameters();this.J(t);const e=ie.toQuery(t);this.K(e),csArray.prototype.forEach.call(this.afterRequestCallbacks,(t=>t()))}K(t){const e=new window.Image(1,1);e.onload=Wt,e.onerror=Wt,csHTMLImageElementsrc.call(e,`${this.domainUri}${this.path?`/${this.path}`:""}?${t}`)}J(t){t.r=csString.prototype.slice.call(`${Math.random()}`,2,8)}}class oe{constructor(t,e){this.Y=t,this.X=e}init(){this.tt=new re(this.Y.getLoggerUri()),this.tt.setRequestParametersProviders(this,this.X)}send(t){this.st=t,this.tt.send()}getRequestParameters(){return{a:this.st.app,l:this.st.level,m:this.st.message,s:this.st.stacktrace}}}function ae(t,e,s,i){var n,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,s,o):n(e,s))||o);return r>3&&o&&Object.defineProperty(e,s,o),o}"function"==typeof SuppressedError&&SuppressedError;class ce{static setGlobalService(t){ce.globalService=t}constructor(t){this.name=t}_get(){return this._values}_reset(){this._values={}}aggregate(){if(!ce.globalService)return;const t=this._get(),e=Object.keys(t);e.length&&(ce.globalService.push(csArray.prototype.map.call(e,(e=>({name:this.name,parameter:e,value:t[e]})))),this._reset())}}ce.globalService=null,ae([yt("Metric.aggregate")],ce.prototype,"aggregate",null);class he extends ce{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;super(t),this.et=e,this.it=null,this._values={}}count(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._values[t]=(this._values[t]||0)+e,this._debounce()}_debounce(){ce.globalService&&(this.it&&window.csClearTimeout(this.it),this.it=window.csSetTimeout((()=>{this.aggregate(),this.it=null}),this.et))}}const le={counters:{commandsFromIntegrations:new he("commands-from-integrations"),commandsFromCSTC:new he("commands-from-cstc"),commandsFromIframe:new he("commands-from-iframe"),commandApplied:new he("command-applied"),commandError:new he("command-error"),commandMisuse:new he("command-misuse"),redactedPII:new he("redacted-pii"),pageAnonymisation:new he("page-anonymisation"),sensitiveElements:new he("sensitive-elements")},setService(t){ce.setGlobalService(t)}},de=/[a-zA-Z0-9._%+-]+(?:@|%40|%2540)[a-zA-Z0-9.%-_]+((?:\.|%2[eE])[a-zA-Z0-9-]+)+/g,ue=/[a-zA-Z0-9+_-](?:@|%40|%2540)/,pe="([-A-Za-z0-9+/=_]|=[^=]|={3,})+",ge=new csRegExp(`(ey${pe}\\.ey${pe}\\.${pe})`,"g"),me=/[0-9]{4}/,ye=/(^|[^a-zA-Z0-9*.,-])([45*][0-9*]{3}([ -]?)[0-9*]{4}\3[0-9*]{4}\3[0-9*]{4})($|[^a-zA-Z0-9*.,-])/g,fe=/\d/g,ve=/([+(]{0,2}\d[-_ ()/]{0,4}){9,}/,Ee=/(?:\d{1,3}\.){3}\d{1,3}/,Se=/(?:[A-F0-9]{1,4}:){7}[A-F0-9]{1,4}/;var we;!function(t){t.replaceEmail=function(t){return csString.prototype.replace.call(t,de,"CS_ANONYMIZED_EMAIL")},t.replaceJWT=function(t){return csString.prototype.replace.call(t,ge,"CS_ANONYMIZED_JWT")},t.replaceCreditCardNumber=function(t,e){return csString.prototype.replace.call(t,ye,e)},t.replaceDigits=function(t){return csString.prototype.replace.call(t,fe,"â€¢")},t.mayHaveIPAddress=function(t){return Ee.test(t)||Se.test(t)},t.mayHaveNumberSequence=function(t){return ve.test(t)},t.mayHaveCreditCardNumber=function(t){return me.test(t)},t.mayHaveEmail=function(t){return ue.test(t)}}(we||(we={}));class Re{constructor(){this.nt={}}getLogs(){const{fullCreditCard:t,partialCreditCard:e}=this.nt,s=[];return t&&csArray.prototype.push.call(s,`Full cc found and anonymized (${t})`),e&&csArray.prototype.push.call(s,`Partial cc found and anonymized (${e})`),s}hasPII(t,e){return t!==this.checkAndAnonymizePII(t,e)}checkAndAnonymizePII(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.ot();let s=this.ht(this.ut(t));return!0===e?s=this.lt(s):!1===e&&(s=this.ft(s)),s}anonymizePII(t){return this.ot(),this.ut(t)}anonymizeJwt(t){return this.ot(),we.replaceJWT(t)}anonymizeFields(t,e){return this.ot(),csArray.prototype.forEach.call(e,(e=>{t[e]=this.ut(t[e])})),t}ot(){this.nt={}}ut(t){if(we.mayHaveEmail(t)){const e=we.replaceEmail(t);return e!==t&&le.counters.redactedPII.count("email"),e}return t}lt(t){return we.replaceDigits(t)}ft(t){return we.mayHaveNumberSequence(t)?we.replaceDigits(t):t}ht(t){return we.mayHaveCreditCardNumber(t)?we.replaceCreditCardNumber(t,((t,e,s,i,n)=>{if(-1===csString.prototype.indexOf.call(s,"*")){const e=i.length?csArray.prototype.join.call(csString.prototype.split.call(s,i),""):s;if(!this.vt(e))return t;le.counters.redactedPII.count("cc"),this.nt.fullCreditCard=(this.nt.fullCreditCard||0)+1}else le.counters.redactedPII.count("cc-partial"),this.nt.partialCreditCard=(this.nt.partialCreditCard||0)+1;return`${e}CS_ANONYMIZED_PII${n}`})):t}vt(t){const e=parseInt(t[t.length-1]);let s=0;for(let e=t.length-2;e>=0;e--){let i=parseInt(t[e]);e%2==0&&(i*=2),s+=Math.floor(i/10)+i%10}return 10-s%10===e}}const Ae="15.81.3";function be(){return{v:Ae}}var Te;const Ce="undefined"!=typeof performance&&!!performance.now,_e=Ce?()=>performance.now():csDate.now,Ne=Ce?null===(Te=performance.timing)||void 0===Te?void 0:Te.navigationStart:0,Ie=()=>Math.round(_e()+Ne),Oe=()=>_e();function Pe(){return Math.floor(Ie()/1e3)}function ke(){return"function"==typeof window.Promise}function Le(){var t,e;return"function"==typeof(null===(t=window.navigation)||void 0===t?void 0:t.addEventListener)&&"function"==typeof(null===(e=window.navigation)||void 0===e?void 0:e.removeEventListener)}function Me(t,e){return 0===csString.prototype.lastIndexOf.call(t,e,0)}function De(t,e){return-1!==csString.prototype.indexOf.call(t,e,t.length-e.length)}class xe{constructor(t,e){this.wt=t,this.gt=e}getRequestParameters(){return t._objectSpread2(t._objectSpread2({d:`${Ie()}`,p:this.gt.anonymizePII(window.location.href)},this.wt.getRequestParameters()),be())}}const Ue="snippet-",Ve="implementation-snippet-";var Be;!function(t){t.IMPLEMENTATION="implementation",t.DYNAMIC="dynamic"}(Be||(Be={}));const He={[se.debug]:0,[se.warn]:1,[se.implementation]:1,[se.error]:2,[se.critical]:3};class $e{constructor(t,e,s){this.yt=e,this.gt=new Re,this.Et=He[se.warn],this.Et=He[t.minLogLevel||se.warn],this.tt=s||new oe(t,new xe(t,this.gt)),this.At={[se.debug]:[],[se.warn]:[],[se.implementation]:[],[se.error]:[],[se.critical]:[]},this._t={implementation:{},dynamic:{}},this.tt.init()}send(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:se.warn;if(!this.Rt(s,e))return;csArray.prototype.push.call(this.At[s],e||"");const i={message:this.St(t,e),stacktrace:this.Tt(t),app:"uxa",level:s};this.tt.send(i)}St(t,e){let s=b(t)?this.gt.anonymizePII(t.message||t.toString()):t;return e&&(s+=` ErrorCode: ${e}`),s}Tt(t){return b(t)?`${t.stack||"No stacktrace"} ${this.It()}`:this.It()}It(){const t=this.yt.getVisitorService(),e=null==t?void 0:t.getVisitor();if(!e)return"No context";const s=this.yt.getSessionService(),i=s&&s.getSession(),n={userId:e.id,sessionNumber:e.visitsCount,pageNumber:i&&i.pageNumber};return csJSON.stringify(n)}Rt(t,e){if(He[t]<this.Et)return!1;if(0===(null==e?void 0:csString.prototype.indexOf.call(e,Ve,0)))return this.Pt(e,Be.IMPLEMENTATION);if(0===(null==e?void 0:csString.prototype.indexOf.call(e,Ue,0)))return this.Pt(e,Be.DYNAMIC);const s=this.At[t];return!(s.length>=5||e&&csArray.prototype.some.call(s,(t=>t===e)))}Pt(t,e){return t in this._t[e]?!(this._t[e][t]>=5||(this._t[e][t]+=1,0)):(this._t[e][t]=1,!0)}}const qe=!o&&document.createElement("a"),ze=/(:443|:80)$/;function Fe(t){return qe?(qe.href=t,qe.href):""}function je(t,e){return new csURL(t,e).href}function Ge(t){const e=Qe(t);return null===e?"":decodeURIComponent(e.hostname)}function We(t,e){return csArray.prototype.some.call(e,(e=>De(t,`.${e}`)||t===e||""===e))}function Ye(t){return csString.prototype.replace.call(t,ze,"")}function Qe(t){return qe&&(Me(t,"http://")||Me(t,"https://"))?(qe.href=t,{hash:qe.hash,host:Ye(qe.host),hostname:qe.hostname,href:qe.href,origin:qe.origin?qe.origin:Ye(`${qe.protocol}//${qe.host}`),pathname:(e=qe.pathname,"/"===e[0]?e:`/${e}`),port:qe.port,protocol:qe.protocol,search:qe.search}):null;var e}const Ze="CS_IFRAME_MESSAGE";var Xe,Ke,Je,ts;!function(t){t.AfterPageView="afterPageView",t.GetSessionKey="getSessionKey"}(Xe||(Xe={})),function(t){t.Parent="parent",t.Child="child"}(Ke||(Ke={})),function(t){t.Discovery="discovery",t.Stop="stop",t.RecordingContext="recordingContext",t.SensitiveStatus="sensitiveStatus",t.RecordingEvent="recordingEvent",t.EndOfBufferedMessages="endOfBufferedMessages",t.ChildLogMessage="childLogMessage",t.AnalysisEvent="analysisEvent",t.JavascriptError="javascriptError",t.ApiError="apiError",t.Assets="assets",t.DetailedApiError="detailedApiError",t.EmerchandisingMessage="emerchandisingMessage",t.Commands="commands",t.IntegrationCallback="integrationCallback",t.StaticResource="staticResource",t.TrackingContextResultMessage="trackingContextResultMessage",t.TrackingContextRequestMessage="trackingContextRequestMessage",t.CustomError="customError"}(Je||(Je={})),function(t){t.buildBaseMessage=function(t,e,s,i){const n={type:t,from:e,pid:s,signature:Ze};return void 0!==i&&i>=0&&(n.id=i),n},t.isMessageValid=function(t,e,s,i){const n=Ge(t.origin);return!!t.data&&!!t.data.type&&t.data.signature===Ze&&t.data.from===e&&t.data.pid===s&&We(n,i)},t.sendPostMessage=function(t,e,s,i){i?t.postMessage(s,e,i):t.postMessage(s,e)},t.getNewChannelMessage=function(){return new MessageChannel},t.sendChannelMessage=function(t,e){t.postMessage(e)},t.closeChannelPort=function(t){t.close()}}(ts||(ts={}));class es{constructor(t){this.wt=t}send(t){const e={message:t,errorCode:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",level:arguments.length>2&&void 0!==arguments[2]?arguments[2]:se.warn},s=ts.buildBaseMessage(Je.ChildLogMessage,Ke.Child,this.wt.projectId);s.content=e,ts.sendPostMessage(window.parent,"*",s)}}class ss{setContext(t,e){this.bt=t,this.Vt=e}getVisitorService(){return this.bt}getSessionService(){return this.Vt}}const is=["t.contentsquare.net","clicktale"];window.addEventListener("error",(t=>{"string"!=typeof t.filename||!csArray.prototype.some.call(is,(e=>csString.prototype.indexOf.call(t.filename,e)>-1))||csString.prototype.indexOf.call(t.filename,"blob")>-1&&(null==t.message?void 0:csString.prototype.indexOf.call(t.message,"importScripts"))>-1||ns.critical(`Uncaught jsError: filename: ${t.filename} - lineno: ${t.lineno} - colno: ${t.colno} - message: ${t.message} `)}));class ns{constructor(){}static whiteListFilename(t){csArray.prototype.push.call(is,t)}static setStrategy(t){ns.Ct=t}static computeIsActive(t){ns.kt=Zt.boolean(t),ns.kt?ns.Ot=Zt.boolean(10):ns.Ot=!1}static isLoggingActive(){return ns.kt}static getStrategy(){return ns.Ct}static debug(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";ns.kt&&this.Ct.send(t,e,se.debug)}static warn(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";var i;ns.kt&&e&&this.Ct.send(t,s,se.warn),null===(i=window.UXAnalytics.Console)||void 0===i||i.warn(t)}static implementation(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";ns.kt&&this.Ct.send(t,e,se.implementation)}static error(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";var s;ns.kt&&this.Ct.send(t,e,se.error),null===(s=window.UXAnalytics.Console)||void 0===s||s.error(t)}static critical(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.Ct.send(t,e,se.critical)}static tryToExecute(t,e){var s=this;return function(){try{const i=e(...arguments);return S(window.Promise)&&i instanceof window.Promise?i.then((t=>t),(e=>s.error(b(e)?e:new Error(e),t))):i}catch(e){try{s.error(b(e)?e:new Error(e),t)}catch(t){}}}}static isPerfLoggingActive(){return ns.Ot}}ns.kt=!1,ns.Ot=!1;let rs=!1;function os(){return(t,e,s)=>{if(s){const t=s.value;s.value=function(e,s){!1===(null==e?void 0:e.isTrusted)&&rs||t.call(this,e,s)}}else{const s=t[e];if("function"!=typeof s)return;t[e]=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];!1===(null==t?void 0:t.isTrusted)&&rs||s.call(this,t,i)}}}}function as(t,e,s,i){var n,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,s,o):n(e,s))||o);return r>3&&o&&Object.defineProperty(e,s,o),o}var cs,hs,ls,ds;"function"==typeof SuppressedError&&SuppressedError,function(t){function e(t){const e=new csRegExp(`(^|;)[ ]*${t}=([^;]*)`).exec(document.cookie);return e?decodeURIComponent(e[2]):null}function s(e,s,n,r,o,a){const c=encodeURIComponent(`${s}`),h=n===t.CURRENT_DOMAIN?void 0:n,l=i(r);let d=`${e}=${c}${l?`;expires=${l.toUTCString()}`:""};path=/${w(h)?`;domain=${h}`:""}`;return S(o)&&o!==ls.NotSet&&(d=`${d};SameSite=${o}`),S(a)&&a===ds.Yes&&(d=`${d};Secure`),document.cookie=d,!0}function i(t){return m(t)?new csDate(Ie()+t):t}function n(t,i){e(t)&&s(t,"",i,new csDate(0)),e(t)&&s(t,"",i,new csDate(0),ls.None,ds.Yes)}t.CURRENT_DOMAIN="CURRENT_DOMAIN",t.get=e,t.set=s,t.toExpireDate=i,t.remove=n,t.isCookiePresent=function(){return document.cookie.length>0},t.getRootDomain=function(t,i){const r="_cs_root-domain";let o=e(r);if(null!==o&&"1"!==o)return o;const a=csString.prototype.split.call(window.location.hostname,".");let c=csArray.prototype.pop.call(a);for(;a.length&&(null===o||"1"===o);)c=csArray.prototype.join.call([csArray.prototype.pop.call(a),c],"."),s(r,c,c,void 0,t,i),o=e(r);return n(r,c),c}}(cs||(cs={})),function(t){t.browserIsSafariV12=function(){return window.navigator.vendor&&csString.prototype.indexOf.call(window.navigator.vendor,"Apple")>-1&&window.navigator.appVersion&&csString.prototype.indexOf.call(window.navigator.appVersion,"Version/12.")>-1}}(hs||(hs={})),function(t){t.None="None",t.Lax="Lax",t.NotSet="X"}(ls||(ls={})),function(t){t[t.Yes=1]="Yes",t[t.No=0]="No"}(ds||(ds={}));class us{constructor(t,e,s){this.wt=t,this.Nt=e,this.xt=s,this.$t=!1,this.Mt=ls.NotSet,this.Lt=ds.No}getSameSiteFlag(){return this.Mt}getSecureFlag(){return this.Lt}getDomain(){return this.Dt}getRootDomain(){return this.Ut}init(){if(this.wt.cookielessTrackingEnabled)return;const t=this.Ft(),e=this.Bt();this.$t=this.qt(t,e),this.$t?(this.Mt=t,this.Lt=e):this.wt.secureCookiesEnabled&&"https:"===this.Nt.getUrlProtocol()&&(this.Lt=ds.Yes),this.Ut=this.Ht(),this.Dt=this.zt(this.Ut)}qt(t,e){return!hs.browserIsSafariV12()&&(cs.set(us.COOKIE_TEST_FOR_SAME_SITE,"Test same site",us.CURRENT_DOMAIN,void 0,t,e),!!cs.get(us.COOKIE_TEST_FOR_SAME_SITE)&&(cs.remove(us.COOKIE_TEST_FOR_SAME_SITE,us.CURRENT_DOMAIN),!0))}Ft(){return"http:"===this.Nt.getUrlProtocol()?ls.Lax:this.xt.isSameSiteNoneSecureNeeded()||this.wt.crossDomainTracking?ls.None:ls.Lax}Bt(){return"http:"===this.Nt.getUrlProtocol()?ds.No:this.wt.secureCookiesEnabled||this.wt.crossDomainTracking||this.xt.isSameSiteNoneSecureNeeded()?ds.Yes:ds.No}isSameSiteSupported(){return this.$t}set(t,e,s){const i=cs.toExpireDate(s);cs.set(t,e,this.Dt,i,this.getSameSiteFlag(),this.getSecureFlag())}get(t){const e=new csRegExp(`(^|;)[ ]*${t}=([^;]*)`).exec(document.cookie);return e?decodeURIComponent(e[2]):null}delete(t,e){const s=e||this.Dt;cs.remove(t,s)}Ht(){const t=this.xt.isSameSiteNoneSecureNeeded()&&this.isSameSiteSupported(),e=t?ls.None:void 0,s=t?ds.Yes:void 0;return cs.getRootDomain(e,s)}zt(t){return this.wt.allowSubdomains?t:cs.CURRENT_DOMAIN}}us.CURRENT_DOMAIN="CURRENT_DOMAIN",us.COOKIE_TEST_FOR_SAME_SITE="_cs_same_site";const ps="_cs_t";class gs{constructor(t,e){this.jt=t,this.wt=e,this.Gt=!1,this.Zt=!1}init(){if(!this.wt.cookielessTrackingEnabled&&this.jt.isTopWindowTracker()&&"cookie"in document){if(!this.jt.isInIframeContext()&&cs.isCookiePresent())return this.Gt=!0,void(this.Zt=!1);if(cs.set(ps,"1",cs.CURRENT_DOMAIN),null!==cs.get(ps))return this.Gt=!0,this.Zt=!1,void cs.remove(ps,cs.CURRENT_DOMAIN);cs.set(ps,"1",cs.CURRENT_DOMAIN,void 0,ls.None,ds.Yes),null!==cs.get(ps)&&(this.Gt=!0,this.Zt=!0,cs.remove(ps,cs.CURRENT_DOMAIN))}}areCookiesEnabled(){return this.Gt}isSameSiteNoneSecureNeeded(){return this.Zt}}class ms{constructor(t,e){this.wt=t,this.xt=e}canTrack(){return this.wt.isProjectActive()&&this.Wt()&&this.Qt()&&this.Jt()}canTrackInChild(){return this.wt.isProjectActive()&&this.Kt()&&(this.Qt()||this.Yt())}Jt(){return this.wt.cookielessTrackingEnabled?function(){const t="CSSessionStorageTest";try{return sessionStorage.setItem(t,t),sessionStorage.getItem(t)===t&&(sessionStorage.removeItem(t),!0)}catch(t){return!1}}():this.xt.areCookiesEnabled()}Qt(){return We(window.location.hostname,this.wt.hostnames)}Wt(){return!this.Xt()&&this.ss()}Kt(){return!this.Xt()&&this.es()}Yt(){return Yt(window.location.href,"about:srcdoc")&&"about:"===window.location.protocol&&""===window.location.hostname}Xt(){return"visibilityState"in document&&"prerender"===document.visibilityState}ss(){return this.ns()&&this.rs()}es(){return this.ns()}rs(){try{return!!window.localStorage}catch(t){return!1}}ns(){return"pageXOffset"in window&&"pageYOffset"in window&&"onpagehide"in window&&"JSON"in window&&"parse"in window.csJSON&&"stringify"in window.csJSON&&"addEventListener"in window&&"removeEventListener"in window&&"Node"in window&&"filter"in csArray.prototype&&"forEach"in csArray.prototype&&"querySelectorAll"in document&&"now"in csDate&&"keys"in Object&&"performance"in window&&"Map"in window&&"Set"in window}}class ys{constructor(t,e){this.hs=!1,this.cs=new Map,this.us=new Map,this.ls=new Map,this.ds="CS_WORKER_SIGNATURE";const s=`\n    const algorithm = ${t.algorithm};\n    const compressor = (${t.getCompressorSourceCode()})();\n    (()=>{"use strict";var e;!function(e){e.UNCOMPRESSED="0",e.GZIP="2"}(e||(e={}));let t={debug(...e){},warn(...e){},implementation(...e){},error(...e){},critical(...e){},isPerfLoggingActive:()=>!1};class s{constructor(e){var t;this.queryParams={},this.headers={},this.handleRecoveredRequests=e=>{for(const t of e){const{metadata:e,events:s}=t;this.send(s,e)}},this.endpoint=e.endpoint,this.compressionOpts=e.compressionOpts,this.recoveryStorage=e.recoveryStorage,this.mandatoryParameters=null!==(t=e.mandatoryParameters)&&void 0!==t?t:[],this.worker=!!e.worker,this.recoveryStorage&&this.recoveryStorage.recover(this.handleRecoveredRequests)}setQueryParams(e){Object.keys(e).forEach((t=>{this.queryParams[t]=e[t]}))}removeQueryParams(e){e?e.forEach((e=>{delete this.queryParams[e]})):this.queryParams={}}send(s,r){const a=r||{...this.queryParams},o=!("ct"in a),i="string"!=typeof s&&!this.isArrayBuffer(s);"ct"in a||(this.compressionOpts&&o?a.ct=this.compressionOpts.compressionType:a.ct=e.UNCOMPRESSED);const n=i?JSON.stringify(s):s,h=Object.keys(a).map((e=>\`\${encodeURIComponent(e)}=\${encodeURIComponent(a[e])}\`)).join("&"),c=\`\${this.endpoint}?\${h}\`;!function(e,t){const s=e.length;for(let r=0;r<s;r++)if(t(e[r],r))return!0;return!1}(this.mandatoryParameters,(e=>null==a[e]))?this.compressionOpts&&o&&"string"==typeof n?this.compressionOpts.compressor(n,this.compressionOpts.compressionOutputType,(e=>this.doSend(c,a,e))):this.doSend(c,a,n):t.warn(\`[\${this.worker?"WORKER":"MAIN"}] All mandatory parameters are not present on \${c}\`)}onLoad(e){this.onLoadCallback=e}onError(e){this.onErrorCallback=e}onTimeout(e,t){this.onTimeoutCallback=e,this.timeout=t}abort(){this.abortCurrentXhrCall&&this.abortCurrentXhrCall()}setRequestHeader(e,t){this.headers[e]=t}getQueryParams(){return this.queryParams}isArrayBuffer(e){return e&&void 0!==e.byteLength}doSend(e,t,s){const r=new XMLHttpRequest,a=Object.keys(t).map((e=>\`\${encodeURIComponent(e)}=\${encodeURIComponent(t[e])}\`)).join("&");r.open("POST",e),r.onload=()=>{if(this.recoveryStorage&&this.recoveryStorage.recover(this.handleRecoveredRequests),this.onLoadCallback){const e={params:t,responseText:r.responseText,status:r.status};this.onLoadCallback(e)}},r.onerror=()=>{this.recoveryStorage&&this.recoveryStorage.save({key:a,metadata:t,events:s}),this.onErrorCallback&&this.onErrorCallback({params:t})},this.timeout&&this.onTimeoutCallback&&(r.timeout=this.timeout,r.ontimeout=()=>{this.onTimeoutCallback()}),this.abortCurrentXhrCall=()=>r.abort(),Object.keys(this.headers).forEach((e=>{r.setRequestHeader(e,this.headers[e])})),r.send(s)}}class r{constructor(e){this.maxStoredBytes=e,this.storageBytesUsed=0}addString(e){this.storageBytesUsed+=2*e.length}addArrayBuffer(e){this.storageBytesUsed+=e.byteLength}isThresholdReached(){return this.storageBytesUsed>this.maxStoredBytes}reset(){this.storageBytesUsed=0}}class a{constructor(e){this.ramStorage={},this.byteSizeCounter=new r(e)}save({key:e,metadata:t,events:s}){this.byteSizeCounter.isThresholdReached()||(this.byteSizeCounter.addString(e),"string"==typeof s?this.byteSizeCounter.addString(s):this.byteSizeCounter.addArrayBuffer(s),this.byteSizeCounter.isThresholdReached()||(this.ramStorage[e]={metadata:t,events:s}))}recover(e){const t=[];this.getStorageKeys().forEach((e=>{const s=this.ramStorage[e];void 0!==s&&(delete s.metadata.datatype,t.push(s),this.removeItem(e))})),0!==t.length&&(e(t),this.byteSizeCounter.reset())}getStorageKeys(){return Object.keys(this.ramStorage)}removeItem(e){delete this.ramStorage[e]}}var o;!function(e){e[e.NOT_STARTED=0]="NOT_STARTED",e[e.OPEN_IN_PROGRESS=1]="OPEN_IN_PROGRESS",e[e.OPEN_FAILED=2]="OPEN_FAILED",e[e.READY=3]="READY"}(o||(o={}));class i{constructor(e,t,s){this.storageName=e,this.onOpenError=s,this.cacheState=o.NOT_STARTED,this.toBeSavedBuffer=[],this.recoveryInProgress=0,this.origin=self.origin,this.context="object"==typeof window?"":"worker-",this.byteSizeCounter=new r(t),this.init()}async init(){await this.openCache(),this.cacheState===o.READY?this.flushToBeSavedBuffer():this.onOpenError(this.toBeSavedBuffer)}flushToBeSavedBuffer(){this.toBeSavedBuffer.forEach((e=>{this.save(e)})),this.toBeSavedBuffer=[]}async save(e){try{if(this.cacheState===o.OPEN_IN_PROGRESS)return void this.toBeSavedBuffer.push(e);if(this.cacheState!==o.READY)return;if(this.byteSizeCounter.isThresholdReached())return;const{key:t,metadata:s,events:r}=e;if(this.byteSizeCounter.addString(t),"string"==typeof r?this.byteSizeCounter.addString(r):this.byteSizeCounter.addArrayBuffer(r),this.byteSizeCounter.isThresholdReached())return;await this.cache.put(\`\${this.origin}/\${t}\`,new Response(r,{headers:s}))}catch{}}async recover(e){(this.cache||(await this.openCache(),this.cacheState===o.READY))&&this.doRecover(e)}async openCache(){try{this.cacheState=o.OPEN_IN_PROGRESS,this.cache=await self.caches.open(\`\${this.context}\${this.storageName}\`),this.cacheState=o.READY}catch{this.cacheState=o.OPEN_FAILED}}async doRecover(e){try{if(this.recoveryInProgress++,this.recoveryInProgress>1)return;const t=await this.cache.keys();if(0===t.length)return;const s=(await this.cache.matchAll()).map((e=>{const t={};e.headers.forEach(((e,s)=>{t[s]=e})),delete t["content-type"];const s=t.datatype;return delete t.datatype,"json"===s||"base64"===s?e.text().then((e=>({metadata:t,events:e}))):e.arrayBuffer().then((e=>({metadata:t,events:e})))})),r=await Promise.all(s);await Promise.all(t.map((e=>this.cache.delete(e)))),e(r),this.byteSizeCounter.reset()}catch{}finally{this.recoveryInProgress--}}}class n{constructor(e){try{this.initializeStorageStrategy(e)}catch(e){this.setRamStorageStrategy()}}initializeStorageStrategy(e){self.caches?this.setCachesStrategy(e):this.setRamStorageStrategy()}save(e){this.storageStrategy.save(e)}recover(e){this.storageStrategy.recover(e)}setCachesStrategy(e){this.storageStrategy=new i(e,n.MAX_SIZE,(e=>{this.setRamStorageStrategy(e)}))}setRamStorageStrategy(e){this.storageStrategy=new a(n.MAX_SIZE),e&&e.forEach((e=>{this.storageStrategy.save(e)}))}}n.MAX_SIZE=16777216,function(){const e="CS_WORKER_SIGNATURE",t=new Map,r=new n("csPersisted");function a(a){var o;if((o=a)&&o.WORKER_SIGNATURE===e)switch(a.type){case"CreatePostRequest":{const{endpoint:o,compressionOutputType:i,useRetry:n,mandatoryParameters:h}=a,c={endpoint:o,mandatoryParameters:h,worker:!0};i&&(c.compressionOpts={compressor,compressionOutputType:i,compressionType:algorithm}),n&&(c.recoveryStorage=r);const d=new s(c);t.set(o,d),d.onLoad((t=>{const s={type:"onLoad",endpoint:o,response:t,WORKER_SIGNATURE:e};self.postMessage(s)})),d.onError((t=>{const s={type:"onError",endpoint:o,response:t,WORKER_SIGNATURE:e};self.postMessage(s)}))}break;case"SetQueryParams":{const{endpoint:e,queryParams:s}=a,r=t.get(e);r&&r.setQueryParams(s)}break;case"RemoveQueryParams":{const{endpoint:e,queryParams:s}=a,r=t.get(e);r&&r.removeQueryParams(s)}break;case"Send":{const{endpoint:e,payload:s,queryParams:r}=a,o=t.get(e);o&&o.send(s,r)}break;case"Abort":{const{endpoint:e}=a,s=t.get(e);s&&s.abort()}break;case"SetHeader":{const{endpoint:e,headerName:s,headerValue:r}=a,o=t.get(e);o&&o.setRequestHeader(s,r)}break;case"SetTimeout":{const{endpoint:s,timeout:r}=a,o=t.get(s);o&&o.onTimeout((()=>{const t={type:"onTimeout",endpoint:s,WORKER_SIGNATURE:e};self.postMessage(t)}),r)}break;default:throw new Error(JSON.stringify(a))}}self.addEventListener("message",(function(e){e.data.getReader?async function(e,t){const s=e.getReader();for(;;){const{done:e,value:r}=await s.read();if(e)break;t(r)}}(e.data,a):a(e.data)}))}()})();`;try{this.fs=this.ps(e||s),this.hs=!0,ys.isTransferableStreamSupported()&&(this.vs=new ReadableStream({start:t=>{this.ws=t},cancel:()=>{this.ws=null}}),this.fs.postMessage(this.vs,[this.vs]))}catch(t){this.hs=!1}}postMessage(t){t.WORKER_SIGNATURE=this.ds,this.ws?this.ws.enqueue(t):this.fs.postMessage(t)}ps(t){const e=window.csURL||window.webkitURL,s=window.Blob,i=window.Worker,n=new s([t],{type:"application/javascript"}),r=e.createObjectURL(n);ns.whiteListFilename(r);const o=new i(r);return o.onmessage=t=>{const{type:e,endpoint:s,WORKER_SIGNATURE:i}=t.data;if(i===this.ds)if("onLoad"===e){const{response:e}=t.data,i=this.cs.get(s);i&&i(e)}else if("onError"===e){const{response:e}=t.data,i=this.us.get(s);i&&i(e)}else if("onTimeout"===e){const t=this.ls.get(s);t&&t()}},o}registerOnLoadCallback(t,e){this.cs.set(t,e)}registerOnErrorCallback(t,e){this.us.set(t,e)}registerOnTimeoutCallback(t,e){this.ls.set(t,e)}isSupported(){return this.hs}static isTransferableStreamSupported(){try{const t=new ReadableStream;return structuredClone(t,{transfer:[t]}),!0}catch(t){return!1}}}class fs{constructor(t){var e;this.gs={},this.ys=t.endpoint,this.Es=t.networkWorker,this.As=t.compressionOutputType,this._s=t.useRetry,this.Es.postMessage({type:"CreatePostRequest",endpoint:this.ys,compressionOutputType:this.As,useRetry:this._s,mandatoryParameters:null!==(e=t.mandatoryParameters)&&void 0!==e?e:[]})}setQueryParams(t){this.Es.postMessage({type:"SetQueryParams",endpoint:this.ys,queryParams:t}),csArray.prototype.forEach.call(Object.keys(t),(e=>{this.gs[e]=t[e]}))}getQueryParams(){return this.gs}removeQueryParams(t){this.Es.postMessage({type:"RemoveQueryParams",endpoint:this.ys,queryParams:t}),t&&csArray.prototype.forEach.call(t,(t=>{delete this.gs[t]}))}send(t,e){this.Es.postMessage({type:"Send",endpoint:this.ys,payload:t,queryParams:e})}abort(){this.Es.postMessage({type:"Abort",endpoint:this.ys})}onLoad(t){this.Es.registerOnLoadCallback(this.ys,t)}onError(t){this.Es.registerOnErrorCallback(this.ys,t)}setRequestHeader(t,e){this.Es.postMessage({type:"SetHeader",endpoint:this.ys,headerName:t,headerValue:e})}onTimeout(t,e){this.Es.registerOnTimeoutCallback(this.ys,t),this.Es.postMessage({type:"SetTimeout",endpoint:this.ys,timeout:e})}}var vs;!function(t){t.UNCOMPRESSED="0",t.GZIP="2"}(vs||(vs={}));class Es{constructor(t){this.onError=t}}class Ss{constructor(t){var e;this.gs={},this.Rs={},this.Ss=t=>{for(const e of t){const{metadata:t,events:s}=e;this.send(s,t)}},this.ys=t.endpoint,this.Ts=t.compressionOpts,this.Is=t.recoveryStorage,this.mandatoryParameters=null!==(e=t.mandatoryParameters)&&void 0!==e?e:[],this.worker=!!t.worker,this.Is&&this.Is.recover(this.Ss)}setQueryParams(t){Object.keys(t).forEach((e=>{this.gs[e]=t[e]}))}removeQueryParams(t){t?t.forEach((t=>{delete this.gs[t]})):this.gs={}}send(e,s){const i=s||t._objectSpread2({},this.gs),n=!("ct"in i),r="string"!=typeof e&&!this.Ps(e);"ct"in i||(this.Ts&&n?i.ct=this.Ts.compressionType:i.ct=vs.UNCOMPRESSED);const o=r?JSON.stringify(e):e,a=Object.keys(i).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(i[t])}`)).join("&"),c=`${this.ys}?${a}`;Ut(this.mandatoryParameters,(t=>null==i[t]))?mt.warn(`[${this.worker?"WORKER":"MAIN"}] All mandatory parameters are not present on ${c}`):this.Ts&&n&&"string"==typeof o?this.Ts.compressor(o,this.Ts.compressionOutputType,(t=>this.bs(c,i,t))):this.bs(c,i,o)}onLoad(t){this.Vs=t}onError(t){this.Cs=t}onTimeout(t,e){this.ks=t,this.Os=e}abort(){this.Ns&&this.Ns()}setRequestHeader(t,e){this.Rs[t]=e}getQueryParams(){return this.gs}Ps(t){return t&&void 0!==t.byteLength}bs(t,e,s){const i=new XMLHttpRequest,n=Object.keys(e).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`)).join("&");i.open("POST",t),i.onload=()=>{if(this.Is&&this.Is.recover(this.Ss),this.Vs){const t={params:e,responseText:i.responseText,status:i.status};this.Vs(t)}},i.onerror=()=>{this.Is&&this.Is.save({key:n,metadata:e,events:s}),this.Cs&&this.Cs({params:e})},this.Os&&this.ks&&(i.timeout=this.Os,i.ontimeout=()=>{this.ks()}),this.Ns=()=>i.abort(),Object.keys(this.Rs).forEach((t=>{i.setRequestHeader(t,this.Rs[t])})),i.send(s)}}class ws{constructor(t){this.xs=t,this.Es=new ys(this.xs)}create(t,e,s,i){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(this.Es.isSupported()&&e)return new fs({networkWorker:this.Es,endpoint:t,compressionOutputType:s,useRetry:!!i,mandatoryParameters:n});{const e=s?{compressor:this.xs.compress,compressionOutputType:s,compressionType:this.xs.algorithm}:void 0;return new Ss({endpoint:t,compressionOpts:e,recoveryStorage:i})}}}class Rs{constructor(t,e,s,i,n){this.bt=t,this.Vt=e,this.$s=s,this.Ms=i,this.wt=n}get(){return{exclusion:this.$s.getAppliedTrackingDraw(),visitor:this.bt.getVisitor(),session:this.Vt.getSession(),cvars:this.Ms.getCustomVariablesSession()}}apply(t){t&&(t.exclusion?this.exclude():this.include(t))}exclude(){this.$s.exclude(this.wt),this.bt.removeVisitor(),this.Vt.removeSession(),this.Ms.removeCustomVariablesSession()}include(t){this.$s.removeExclusion(),this.bt.setVisitor(t.visitor),t.session?this.Vt.setSession(t.session):this.Vt.removeSession(),t.cvars?this.Ms.setCustomVariableSession(t.cvars):this.Ms.removeCustomVariablesSession()}}function As(){const t=new Error;let e=t.stack?csArray.prototype.filter.call(csString.prototype.split.call(t.stack,"\n"),(t=>"Error"!==t&&-1===csString.prototype.indexOf.call(csString.prototype.toLowerCase.call(t),"promise ")&&-1===csString.prototype.indexOf.call(t,"[native code]")&&-1===csString.prototype.indexOf.call(t,"(<anonymous>)"))):[];if(0===e.length)return"";const s=function(t){return t.length>0?bs(t[0]):""}(e);return""===s?"":(e=function(t,e){return csArray.prototype.filter.call(t,(t=>-1===csString.prototype.indexOf.call(t,e)))}(e,s),0===e.length?"":bs(e[0]))}function bs(t){let e,s="";var i;i=t,e=-1!==csString.prototype.indexOf.call(i,"@")?new csRegExp("@(.+):(\\d+):(\\d+)$"):new csRegExp("\\((.+):(\\d+):(\\d+)\\)");const n=e.exec(t);return n&&(s=n[1]),s}const Ts=t=>t;function Cs(e){let{target:s,methodName:i,hook:n,hookPrepareArgs:r=Ts,options:o}=e;const a=function(t,e){const s=csSymbol.for(e);if(t[s])return t[s];const i=Object.getOwnPropertyDescriptor(t,e);if(!(null==i?void 0:i.writable)&&!(null==i?void 0:i.set))return mt.warn(`Cannot intercept read only function '${csString(e)}' of object '${t}'`),null;const n=new Set;t[s]=n;const r=t[e];if("function"==typeof r){const s=function(){const t=arguments;let e=[];try{e=csArray.prototype.map.call(Ht(n),(e=>e(t)))}catch(t){mt.error(t)}const s=r.apply(this,t);try{for(let i=0;i<e.length;i++)e[i]({result:s,context:this,args:t})}catch(t){mt.error(t)}return s};a=r,(o=s).prototype=a.prototype,Object.defineProperty(o,"toString",{value:()=>a.toString()}),t[e]=s}var o,a;return n}(s,i);if(!a)return null;const c=e=>{const s=r(e),i=(null==o?void 0:o.withCallerName)?{callerName:As()}:{};return e=>n(t._objectSpread2(t._objectSpread2(t._objectSpread2({},e),i),{},{args:s}))};return{activate:()=>{a.add(c)},deactivate:()=>{a.delete(c)}}}function _s(t,e,s){const i=function(t,e){const s=csSymbol.for(e);if(t[s])return t[s];const i=new Set,n=Object.getOwnPropertyDescriptor(t,e);return n?n.configurable?(t[s]=i,Object.defineProperty(t,e,{set(){var t;const s=arguments,r=this[e],o=null===(t=n.set)||void 0===t?void 0:t.apply(this,s);try{i.forEach((t=>t(this,s[0],r)))}catch(t){mt.error(t)}return o}}),i):(mt.warn(`Cannot intercept read only property '${csString(e)}' of object '${t}'`),null):i}(t,e);if(!i)return null;const n=(t,e,i)=>s(t,e,i);return{activate:()=>{i.add(n)},deactivate:()=>{i.delete(n)}}}var Ns;class Is{static Ls(t){this.Ds.forEach((e=>{t(e,"initial")}))}static Us(t){if(this.Fs||(this.Fs=new csMutationObserver((t=>{for(const e of t)e.target.isConnected&&Dt(e.addedNodes,this.Bs),Dt(e.removedNodes,this.qs)}))),csArray.prototype.push.call(this.Hs,t),!this.zs){this.zs=!0,this.Fs.observe(document,this.js);for(const t of It.getAllShadowHosts(document)){const e=csElementshadowRoot.apply(t);this.Ds.add(e),this.Fs.observe(e,this.js)}this.Gs||(this.Gs=Cs({target:Element.prototype,methodName:"attachShadow",hook:t=>t.result.isConnected&&this.Zs(t.result)})),this.Gs.activate()}this.Ls(t)}static Ws(t){var e,s;this.Hs=csArray.prototype.filter.call(this.Hs,(e=>e!==t)),0===this.Hs.length&&(this.Hs=[],this.zs=!1,null===(e=this.Fs)||void 0===e||e.disconnect(),null===(s=this.Gs)||void 0===s||s.deactivate(),this.Ds.clear())}constructor(t){this.Qs=t,this.Qs=ft("DocumentShadowRootObserver:callback",((e,s)=>t(e,s)))}get shadowRoots(){return Ht(Ns.Ds)}takeRecords(){var t,e;return null!==(e=null===(t=Ns.Fs)||void 0===t?void 0:t.takeRecords())&&void 0!==e?e:[]}observe(){It.isSupported()&&Ns.Us(this.Qs)}disconnect(){It.isSupported()&&Ns.Ws(this.Qs)}}function Os(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.boundElement.addEventListener(t.type,t.listener,e)}function Ps(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.boundElement.removeEventListener(t.type,t.listener,e)}function ks(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const s=Math.pow(10,e);return Math.round(t*s)/s}function Ls(t,e){"number"==typeof e&&(e={wait:e});const s=e.wait;if(e.ignoreThrottledCalls){let e=0;return function(){const i=Ie();for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];if(i-e>s)return e=i,t.apply(this,r)}}let i,n,r=[],o=null,a=0;const c=()=>{a=Ie(),o=null,n=t.apply(i,r)},h=function(){const e=Ie(),h=s-(e-a);for(var l=arguments.length,d=new Array(l),u=0;u<l;u++)d[u]=arguments[u];return i=null!=this?this:window,r=[...d],h<=0||h>s?(a=e,n=t.apply(i,r),o?(window.csClearTimeout(o),o=null):r=[]):o||(o=window.csSetTimeout(c,h)),n};return h.cancel=()=>{o&&(window.csClearTimeout(o),a=0,o=null,r=[])},h.flushPending=()=>{o&&(window.csClearTimeout(o),c())},h}Ns=Is,Is.Hs=[],Is.Ds=new Set,Is.zs=!1,Is.js={childList:!0,subtree:!0},Is.Zs=t=>{Ns.Ds.has(t)||(Ns.Fs.observe(t,Ns.js),Ns.Ds.add(t),Dt(Ns.Hs,(e=>e(t,"added"))))},Is.Bs=t=>{lt(t,NodeFilter.SHOW_DOCUMENT_FRAGMENT).visitAll(Ns.Zs)},Is.qs=t=>{t.isConnected||lt(t,NodeFilter.SHOW_DOCUMENT_FRAGMENT).visitAll((t=>{Ns.Ds.has(t)&&(Ns.Ds.delete(t),Dt(Ns.Hs,(e=>e(t,"removed"))))}))},ae([yt()],Is.prototype,"observe",null),ae([yt()],Is.prototype,"disconnect",null);const Ms=t=>(e,s,i)=>{i.value=Ls(i.value,t)};var Ds,xs,Us,Vs,Bs;function Hs(t){const e=csEventtarget.apply(t);return e&&1===e.nodeType&&csElementshadowRoot.apply(e)&&t.composedPath?t.__csOriginalTarget||t.composedPath()[0]:e}!function(t){t[t.MUTATION_INSERT=1]="MUTATION_INSERT",t[t.MUTATION_REMOVE=2]="MUTATION_REMOVE",t[t.MUTATION_ATTRIBUTE=3]="MUTATION_ATTRIBUTE",t[t.MUTATION_CHARACTER_DATA=4]="MUTATION_CHARACTER_DATA",t[t.INITIAL_DOM=5]="INITIAL_DOM",t[t.SCROLL=6]="SCROLL",t[t.CLICK=8]="CLICK",t[t.RESIZE=9]="RESIZE",t[t.INPUT_CHECKABLE=10]="INPUT_CHECKABLE",t[t.INPUT_SELECT=11]="INPUT_SELECT",t[t.INPUT_TEXT=12]="INPUT_TEXT",t[t.HASH_CHANGE=13]="HASH_CHANGE",t[t.UNANONYMIZED_CONSENT_GRANTED=14]="UNANONYMIZED_CONSENT_GRANTED",t[t.UNANONYMIZED_CONSENT_WITHDRAWN=15]="UNANONYMIZED_CONSENT_WITHDRAWN",t[t.MOUSE_OVER=16]="MOUSE_OVER",t[t.VISIBILITY_CHANGE=17]="VISIBILITY_CHANGE",t[t.STYLESHEET_RULE_INSERT=18]="STYLESHEET_RULE_INSERT",t[t.STATIC_RESOURCE_URL=19]="STATIC_RESOURCE_URL",t[t.PERFORMANCE_TIMINGS=20]="PERFORMANCE_TIMINGS",t[t.ATTACH_SHADOW=22]="ATTACH_SHADOW",t[t.STYLESHEET_CSS_TEXT_UPDATE=23]="STYLESHEET_CSS_TEXT_UPDATE",t[t.JAVASCRIPT_ERROR=26]="JAVASCRIPT_ERROR",t[t.PAGE_EVENT=27]="PAGE_EVENT",t[t.API_ERROR=28]="API_ERROR",t[t.TEXT_VISIBILITY=29]="TEXT_VISIBILITY",t[t.MUTATION_ENCRYPTED_CHARACTER_DATA=30]="MUTATION_ENCRYPTED_CHARACTER_DATA",t[t.INPUT_ENCRYPTED_TEXT=31]="INPUT_ENCRYPTED_TEXT",t[t.KEY_DOWN=32]="KEY_DOWN",t[t.KEY_UP=33]="KEY_UP",t[t.CLIPBOARD_COMMAND=34]="CLIPBOARD_COMMAND",t[t.STYLESHEET_RULE_DELETE=37]="STYLESHEET_RULE_DELETE",t[t.USER_IDENTIFIER=38]="USER_IDENTIFIER",t[t.TOUCH_START=41]="TOUCH_START",t[t.TOUCH_MOVE=42]="TOUCH_MOVE",t[t.TOUCH_END=43]="TOUCH_END",t[t.GESTURE_RECOGNITION=44]="GESTURE_RECOGNITION",t[t.POINTER_DOWN=47]="POINTER_DOWN",t[t.POINTER_MOVE=48]="POINTER_MOVE",t[t.POINTER_UP=49]="POINTER_UP",t[t.CUSTOM_ERROR=50]="CUSTOM_ERROR",t[t.CUSTOM_ELEMENT_REGISTRATION=54]="CUSTOM_ELEMENT_REGISTRATION",t[t.REGISTER_ADOPTED_STYLE_SHEET=60]="REGISTER_ADOPTED_STYLE_SHEET",t[t.SET_ADOPTED_STYLE_SHEETS=61]="SET_ADOPTED_STYLE_SHEETS",t[t.ADOPTED_STYLESHEET_RULE_INSERT=62]="ADOPTED_STYLESHEET_RULE_INSERT",t[t.ADOPTED_STYLESHEET_RULE_DELETE=63]="ADOPTED_STYLESHEET_RULE_DELETE",t[t.SCREEN_RESIZE=65]="SCREEN_RESIZE",t[t.RESOURCE_HASHES=66]="RESOURCE_HASHES",t[t.PERFORMANCE_NAVIGATION_TIMING=67]="PERFORMANCE_NAVIGATION_TIMING",t[t.PERFORMANCE_RESOURCE_TIMING=68]="PERFORMANCE_RESOURCE_TIMING",t[t.RECORDING_INFO_EVENT=72]="RECORDING_INFO_EVENT",t[t.TEXT_REF=73]="TEXT_REF",t[t.TOUCH_CANCEL=74]="TOUCH_CANCEL",t[t.MUTATION_MOVE=75]="MUTATION_MOVE",t[t.STYLESHEET_RULE_UPDATE=76]="STYLESHEET_RULE_UPDATE",t[t.ADOPTED_STYLESHEET_RULE_UPDATE=77]="ADOPTED_STYLESHEET_RULE_UPDATE",t[t.VIDEO_PLAY=78]="VIDEO_PLAY",t[t.VIDEO_PAUSE=79]="VIDEO_PAUSE",t[t.VIDEO_SEEK=80]="VIDEO_SEEK",t[t.DEBUG=999]="DEBUG"}(Ds||(Ds={})),function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Fourth=3]="Fourth",t[t.Fifth=4]="Fifth"}(xs||(xs={})),function(t){t[t.SWIPE=0]="SWIPE",t[t.PINCH_IN=1]="PINCH_IN",t[t.PINCH_OUT=2]="PINCH_OUT",t[t.LONG_PRESS=3]="LONG_PRESS",t[t.TAP=4]="TAP",t[t.DOUBLE_TAP=5]="DOUBLE_TAP"}(Us||(Us={})),function(t){t[t.SPACE=0]="SPACE",t[t.ENTER=1]="ENTER",t[t.BACKSPACE=2]="BACKSPACE",t[t.DELETE=3]="DELETE",t[t.ARROWUP=4]="ARROWUP",t[t.ARROWDOWN=5]="ARROWDOWN",t[t.ARROWLEFT=6]="ARROWLEFT",t[t.ARROWRIGHT=7]="ARROWRIGHT",t[t.CAPSLOCK=8]="CAPSLOCK",t[t.SHIFT=9]="SHIFT",t[t.TAB=10]="TAB",t[t.ALPHANUMERICAL=11]="ALPHANUMERICAL",t[t.ESCAPE=12]="ESCAPE",t[t.END=13]="END",t[t.ALT=14]="ALT",t[t.CTRL=15]="CTRL",t[t.META=16]="META"}(Vs||(Vs={})),function(t){t[t.COPY=0]="COPY",t[t.CUT=1]="CUT",t[t.PASTE=2]="PASTE"}(Bs||(Bs={}));const $s=!!window.chrome,qs="data-cs-scroll-container";var zs;!function(t){t.isEventOnScrollContainer=function(t){return!!(w(t)&&function(t){try{if(w(csEventtarget.apply(t)))return!0}catch(t){}return!1}(t)&&A(csEventtarget.apply(t))&&null!==csEventtarget.apply(t).getAttribute(qs))},t.getScrollContainer=function(){return window.csquerySelector[document.nodeType].call(document,`[${qs}]`)}}(zs||(zs={}));const Fs=function(){const t=csSymbol.for("propStore");return{getStore:e=>e[t],get(e,s){const i=e[t];return null==i?void 0:i[s]},set(e,s,i){let n=e[t];n||(n={},e[t]=n),n[s]=i}}}();var js;!function(t){function e(t,e){s(t,void 0,e)}function s(t,e,i){let n=!1;if(i(t,e,(()=>n=!0)),n)return;const r=t.shadowRoot;r&&s(r,t,i);const o=t.children;if(null==o?void 0:o.length)for(const e of o)if(e&&(s(e,t,i),n))break}t.setProperty=function(t,e,s){var i;t instanceof Node?Fs.set(t,e,s):(null!==(i=t.props)&&void 0!==i||(t.props={}),t.props[e]=s)},t.getProperty=function(t,e){var s;return t instanceof Node?Fs.get(t,e):null===(s=t.props)||void 0===s?void 0:s[e]},t.getProperties=function(t){return t instanceof Node?Fs.getStore(t):t.props},t.findDescendant=function(t,s){let i=null;return e(t,((t,e,n)=>s(t)&&(i=t)&&!!n())),i},t.traverse=e}(js||(js={}));let Gs,Ws=1,Ys=csSymbol("nodeIdentifier");function Qs(t){const e=js.getProperty(t,Ys);return null!=e?e:(js.setProperty(t,Ys,Ws++),js.getProperty(t,Ys))}function Zs(t){if(Gs||(Gs=document.createElement("div")),!t||!f(t))return mt.warn(`isValidSelector: invalid selector provided '${t}'`),!1;try{return Y.call(Gs,t),!0}catch(e){return mt.warn(`isValidSelector: invalid selector provided '${t}'`),!1}}function Xs(t,e){if(Q)return Q.call(t,e);let s=t;do{if(Y.call(s,e))return s;s=null==s?void 0:s.parentElement}while(null!==s&&1===s.nodeType);return null}var Ks;!function(t){let e;!function(t){t[t.NotMasked=0]="NotMasked",t[t.Parent=1]="Parent",t[t.Child=2]="Child"}(e=t.MaskedElementState||(t.MaskedElementState={})),t.maskedProp="masked",t.maskedAttributeProp="maskedAttribute",t.isSelectorUserInput=function(t){return!!(E(t)&&"Attributes"in t&&"PIISelectors"in t)&&t.Attributes instanceof Array&&t.PIISelectors instanceof Array},t.sanitizeSelectorUserInput=function(t){return E(t)&&null!==t?("Attributes"in t||(t.Attributes=[]),"PIISelectors"in t||(t.PIISelectors=[]),t):(mt.implementation(`setPIISelectors called with invalid input of type ${typeof t}: ${csJSON.stringify(t)}`),{Attributes:[],PIISelectors:[]})},t.getMaskedElementDetails=function(s){var i;return null!==(i=js.getProperty(s,t.maskedProp))&&void 0!==i?i:{state:e.NotMasked}},t.getMaskedAttributeDetails=function(e){var s;return null!==(s=js.getProperty(e,t.maskedAttributeProp))&&void 0!==s?s:{attributes:[]}},t.isMaskedElement=function(s){const i=js.getProperty(s,t.maskedProp);return(null==i?void 0:i.state)===e.Parent},t.isMaskedElementChild=function(s){const i=js.getProperty(s,t.maskedProp);return(null==i?void 0:i.state)===e.Child},t.isMaskedAttribute=function(e,s){const i=js.getProperty(e,t.maskedAttributeProp);return(null==(null==i?void 0:i.attributes)?void 0:csArray.prototype.indexOf.call(null==i?void 0:i.attributes,s))>-1},t.setMaskedElementProperty=function(e,s){js.setProperty(e,t.maskedProp,s)},t.unsetMaskedElementProperty=function(e){js.setProperty(e,t.maskedProp,void 0)},t.setMaskedAttributeProperty=function(e,s){js.setProperty(e,t.maskedAttributeProp,s)},t.getComputedSelectorSettings=function(t,e){const s=csArray.prototype.filter.call(t.PIISelectors,(t=>Zs(t)));e.elementSelector.length>0&&csArray.prototype.push.call(s,...csString.prototype.split.call(e.elementSelector,","));const i=function(t){if(t.length<=1)return t;const e=[];for(const s of t){const t=csString.prototype.split.call(s,",");for(const s of t)-1===csArray.prototype.indexOf.call(e,s)&&csArray.prototype.push.call(e,s)}return e}([...s]),n={elementSelector:csArray.prototype.join.call(i,","),attrSelector:e.attrSelector,attrSelectors:e.attrSelectors};return csArray.prototype.forEach.call(t.Attributes,(t=>{(null==t?void 0:t.attrName)&&(null==t?void 0:t.selector)&&Zs(t.selector)&&!function(t,e){return csArray.prototype.some.call(t,(t=>t.selector===e.selector&&t.attrName===e.attrName))}(n.attrSelectors,t)&&csArray.prototype.push.call(n.attrSelectors,t)})),n.attrSelector=function(t){let e="";return csArray.prototype.forEach.call(t,(t=>{const s=csString.prototype.split.call(t.selector,",");csArray.prototype.forEach.call(s,(t=>{Zs(t)&&(e&&(e+=","),e+=t)}))})),e}(n.attrSelectors),n}}(Ks||(Ks={}));class Js{constructor(){this.eventType="user",this.Js=[],this.Ks=[{type:"pointerup",listener:t=>this.pointerUpListener(t),boundElement:document},{type:"pointermove",listener:t=>this.pointerMoveListener(t),boundElement:document},{type:"pointerdown",listener:t=>this.pointerDownListener(t),boundElement:document}],this.Ys=[{type:"touchstart",listener:t=>this.touchStartListener(t),boundElement:document},{type:"touchmove",listener:t=>this.touchMoveListener(t),boundElement:document},{type:"touchend",listener:t=>this.touchEndCancelListener(t),boundElement:document},{type:"touchcancel",listener:t=>this.touchEndCancelListener(t),boundElement:document}],this.Xs=[{type:"click",listener:t=>this.clickListener(t),boundElement:document},{type:"keyup",listener:t=>this.keyUpListener(t),boundElement:document},{type:"keydown",listener:t=>this.keyDownListener(t),boundElement:document},{type:"copy",listener:t=>this.copyListener(t),boundElement:document},{type:"cut",listener:t=>this.cutListener(t),boundElement:document},{type:"paste",listener:t=>this.pasteListener(t),boundElement:document},{type:"scroll",listener:t=>this.scrollListener(csEventtarget.apply(t)),boundElement:document},{type:"mouseover",listener:t=>this.mouseOverListener(t),boundElement:document}],this.te=[{type:"scroll",listener:t=>this.scrollListener(csEventtarget.apply(t))}];const t=function(t){if(!f(t))return null;const e=/iP(ad|hone|od).+Version\/(\d+)\..*Safari/i.exec(t);return e?Number(e[2]):null}(window.navigator.userAgent);(null===t||t&&t>=16)&&csArray.prototype.push.call(this.te,{type:"mouseover",listener:t=>this.mouseOverListener(t)}),this.se=new Is(((t,e)=>{switch(e){case"initial":case"added":this.ee(t);break;case"removed":this.ie(t)}}))}init(){this.ne(),this.re(),this.oe()}onEvent(t){csArray.prototype.push.call(this.Js,t)}he(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];csArray.prototype.forEach.call(this.Js,(s=>s(t,e)))}start(){this.ce(),this.ee(document),this.se.observe()}stop(){this.ie(document),this.se.disconnect()}re(){this.ae()&&csArray.prototype.push.call(this.Xs,...this.Ks)}ne(){this.ue()&&csArray.prototype.push.call(this.Xs,...this.Ys)}ee(t){V(t)?csArray.prototype.forEach.call(this.Xs,(t=>Os(t))):csArray.prototype.forEach.call(this.te,(e=>{Os({type:e.type,listener:e.listener,boundElement:t})}))}ie(t){V(t)?csArray.prototype.forEach.call(this.Xs,(t=>Ps(t))):csArray.prototype.forEach.call(this.te,(e=>{Ps({type:e.type,listener:e.listener,boundElement:t})}))}ae(){return"PointerEvent"in window&&"function"==typeof window.PointerEvent}ue(){return"TouchEvent"in window&&"function"==typeof window.TouchEvent}ce(){this.le()}le(){const t=zs.getScrollContainer()||document,e=Qs(t),s=this.de(t);if(0!==s.top||0!==s.left){const t={type:Ds.SCROLL,args:[e,s.left,s.top],date:Ie()};this.he(t,!0)}}de(t){return t===document?{top:window.pageYOffset,left:window.pageXOffset}:{top:t.scrollTop,left:t.scrollLeft}}scrollListener(t){if(Ks.isMaskedElement(t)||Ks.isMaskedElementChild(t))return;const e=Qs(t),s=this.de(t),i={type:Ds.SCROLL,args:[e,s.left,s.top],date:Ie()};this.he(i)}mouseOverListener(t){if(Ks.isMaskedElementChild(t.target))return;const e=Qs(t.target),s={type:Ds.MOUSE_OVER,args:[e],date:Ie()};this.he(s)}clickListener(t){const e=Hs(t);if(Ks.isMaskedElementChild(e))return;const s=Qs(e),i={type:Ds.CLICK,args:[s],date:Ie()};this.he(i)}keyUpListener(t){const e=Hs(t);if(Ks.isMaskedElementChild(e))return;const s=Qs(e),i=this.fe[t.key];if(void 0===i)return;const n={type:Ds.KEY_UP,args:[s,i],date:Ie()};this.he(n)}keyDownListener(t){const e=Hs(t);if(Ks.isMaskedElementChild(e))return;const s=Qs(e),i=this.fe[t.key];if(void 0===i)return;const n={type:Ds.KEY_DOWN,args:[s,i],date:Ie()};this.he(n)}copyListener(t){const e=Hs(t);if(Ks.isMaskedElementChild(e))return;const s=Qs(e),i={type:Ds.CLIPBOARD_COMMAND,args:[s,Bs.COPY],date:Ie()};this.he(i)}cutListener(t){const e=Hs(t);if(Ks.isMaskedElementChild(e))return;const s=Qs(e),i={type:Ds.CLIPBOARD_COMMAND,args:[s,Bs.CUT],date:Ie()};this.he(i)}pasteListener(t){const e=Hs(t);if(Ks.isMaskedElementChild(e))return;const s=Qs(e),i={type:Ds.CLIPBOARD_COMMAND,args:[s,Bs.PASTE],date:Ie()};this.he(i)}pointerUpListener(t){const e=Hs(t);if(Ks.isMaskedElementChild(e))return;const s=Qs(e),i={type:Ds.POINTER_UP,args:[t.pointerId,t.pointerType,ks(t.clientX,1),ks(t.clientY,1),s,t.button],date:Ie()};this.he(i)}pointerMoveListener(t){const e={type:Ds.POINTER_MOVE,args:[t.pointerId,t.pointerType,ks(t.clientX,1),ks(t.clientY,1)],date:Ie()};this.he(e)}pointerDownListener(t){const e=Hs(t);if(Ks.isMaskedElementChild(e))return;const s=Qs(e),i={type:Ds.POINTER_DOWN,args:[t.pointerId,t.pointerType,ks(t.clientX,1),ks(t.clientY,1),s,t.button,{pageX:ks(t.pageX,1),pageY:ks(t.pageY,1)}],date:Ie()};this.he(i)}touchStartListener(t){if(!t.changedTouches)return;const{changedTouches:e}=t;for(let t=0;t<e.length;t+=1){const s=e[t],i={type:Ds.TOUCH_START,args:[s.identifier,ks(s.clientX,1),ks(s.clientY,1)],date:Ie()};this.he(i)}}touchMoveListener(t){if(!t.changedTouches)return;const{changedTouches:e}=t;for(let t=0;t<e.length;t+=1){const s=e[t],i={type:Ds.TOUCH_MOVE,args:[s.identifier,ks(s.clientX,1),ks(s.clientY,1)],date:Ie()};this.he(i)}}touchEndCancelListener(t){if(!t.changedTouches)return;const{changedTouches:e}=t;for(let s=0;s<e.length;s+=1){const i=e[s],n={type:"touchend"===t.type?Ds.TOUCH_END:Ds.TOUCH_CANCEL,args:[i.identifier,ks(i.clientX,1),ks(i.clientY,1)],date:Ie()};this.he(n)}}oe(){this.fe={},this.fe[" "]=Vs.SPACE,this.fe.Spacebar=Vs.SPACE,this.fe.Backspace=Vs.BACKSPACE,this.fe.Enter=Vs.ENTER,this.fe.Delete=Vs.DELETE,this.fe.ArrowUp=Vs.ARROWUP,this.fe.ArrowDown=Vs.ARROWDOWN,this.fe.ArrowLeft=Vs.ARROWLEFT,this.fe.ArrowRight=Vs.ARROWRIGHT,this.fe.Up=Vs.ARROWUP,this.fe.Down=Vs.ARROWDOWN,this.fe.Left=Vs.ARROWLEFT,this.fe.Right=Vs.ARROWRIGHT,this.fe.CapsLock=Vs.CAPSLOCK,this.fe.Shift=Vs.SHIFT,this.fe.Tab=Vs.TAB,this.fe.Escape=Vs.ESCAPE,this.fe.Esc=Vs.ESCAPE,this.fe.End=Vs.END,this.fe.Alt=Vs.ALT,this.fe.Control=Vs.CTRL,this.fe.Meta=Vs.META}}as([Nt("RecordingPageEvents.start")],Js.prototype,"start",null),as([yt("scroll")],Js.prototype,"scrollListener",null),as([yt("mouseOver"),os(),(t,e,s)=>{const i=s.value;return i&&(s.value=function(t){if(Hs(t)===csEventtarget.apply(t))return i.call(this,t)}),s}],Js.prototype,"mouseOverListener",null),as([yt("click"),os()],Js.prototype,"clickListener",null),as([yt("Event handler type: keyup")],Js.prototype,"keyUpListener",null),as([yt("Event handler type: keydown")],Js.prototype,"keyDownListener",null),as([yt("Event handler type: copy")],Js.prototype,"copyListener",null),as([yt("Event handler type: cut")],Js.prototype,"cutListener",null),as([yt("Event handler type: paste")],Js.prototype,"pasteListener",null),as([yt("Event handler type: pointerup"),os()],Js.prototype,"pointerUpListener",null),as([yt("Event handler type: pointermove"),os(),Ms({wait:33,ignoreThrottledCalls:!1})],Js.prototype,"pointerMoveListener",null),as([yt("Event handler type: pointerdown"),os()],Js.prototype,"pointerDownListener",null),as([yt("Event handler type: touchstart"),os()],Js.prototype,"touchStartListener",null),as([yt("Event handler type: touchmove"),os()],Js.prototype,"touchMoveListener",null),as([yt("Event handler type: touchend-cancel"),os()],Js.prototype,"touchEndCancelListener",null);class ti{constructor(t){this.pe=t,this.ve=0}addString(t){this.ve+=2*t.length}addArrayBuffer(t){this.ve+=t.byteLength}isThresholdReached(){return this.ve>this.pe}reset(){this.ve=0}}class ei{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048e3;this.we=t,this.ge=new ti(e)}addEvent(t){this.ge.addString(Kt(t)),csArray.prototype.push.call(this.we,t)}addEventByTimestamp(t){let e=0;for(;e<this.we.length&&!(this.we[e].date>=t.date);e+=1);csArray.prototype.splice.call(this.we,e,0,t)}eventsCount(){return this.we.length}clearEvents(){this.ge.reset(),this.we=[]}isFull(){return this.eventsCount()>=200}isThresholdReached(){return this.ge.isThresholdReached()}getEvents(){return this.we}extractEvents(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];const i=[],n=[];return csArray.prototype.forEach.call(this.we,(t=>{-1!==csArray.prototype.indexOf.call(e,t.type)?csArray.prototype.push.call(i,t):csArray.prototype.push.call(n,t)})),this.we=n,i}stringifyEvents(){return Kt(this.we)}ye(t){t.type===Ds.INITIAL_DOM&&(window.CSDomSerialized=window.CSDomSerialized?window.CSDomSerialized+1:1)}}as([Nt("RecordingBatch.addEvent")],ei.prototype,"addEvent",null);class si{constructor(){this.Ee=1}getCurrentIndex(){return this.Ee}increment(){this.Ee+=1}reset(){this.Ee=1}getRequestParameters(){return{ri:`${this.Ee}`}}}class ii{emit(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:document;const n=`${void 0!==s?`${s}`:`${ii.Ae}`}${t}`,r=ii.createEvent(n,{detail:e});null!==r&&i.dispatchEvent(r)}static createEvent(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"==typeof CustomEvent)return new CustomEvent(t,e);const s=this._e();if(null===s)return null;const{bubbles:i=!1,cancelable:n=!1,detail:r}=e;return s.initCustomEvent(t,i,n,r),s}static _e(){try{return document.createEvent("CustomEvent")}catch(t){return null}}}ii.Ae="cs.tracking.";class ni{constructor(){this._isStarted=!1}get isStarted(){return this._isStarted}start(){this._isStarted||(this._isStarted=!0,this.onStart(...arguments))}stop(){this._isStarted&&(this._isStarted=!1,this.onStop())}restart(){this.stop(),this.start()}}let ri="null",oi=null;const ai=[];function ci(t){null==oi||oi.postMessage(t)}!o&&(()=>{var t;return o||!!(null===(t=document.body)||void 0===t?void 0:t.getAttribute("data-cs-tag-extension"))})()&&(window._uxa?_uxa.push(["debugEvents",!0]):window._uxa=[["debugEvents",!0]],oi=new BroadcastChannel("cs-tag"),document.addEventListener("cs.tracking.recordingEvent",(t=>{ci({type:"UXA_EVENT",event:t.detail})})),oi.addEventListener("message",(t=>{if("CONNECT"===t.data.type){if(t.data.sessionId===ri)return;ri=t.data.sessionId,csArray.prototype.forEach.call(ai,(t=>t())),null==oi||oi.postMessage({type:"CONNECTED",sessionId:ri})}})));class hi{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.name=t,this.format=e}}class li extends hi{constructor(t){super(t,"Value: {count}"),this.count=0}increase(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.count+=t}decrease(){this.count>0&&this.count--}clear(){this.count=0}getData(){return{count:this.count}}}class di extends hi{constructor(t){super(t,"Living intances: {instances}<br/>Added: {added}<br/>Removed: {removed}"),this.added=0,this.removed=0}get value(){return this.added-this.removed}increase(){this.added++}decrease(){this.removed++}getData(){return{added:this.added,removed:this.removed,instances:this.added-this.removed}}}class ui extends hi{constructor(t){super(t,"Count: {count}<br/>Average: {average}ms<br/>Total: {total}ms"),this.total=0,this.count=0}get average(){return this.count?this.total/this.count:0}measure(t){const e=Oe();t(),this.count++,this.total+=Oe()-e}asyncMeasure(){const t=Oe();return()=>{this.count++,this.total+=Oe()-t}}getData(){return{total:this.total,count:this.count,average:this.average}}}const pi={general:{category:"General",nbEvents:new li("Nb of Events"),pendingTasks:new li("Pending Tasks"),pendingEvents:new li("Pending Tasks"),nbOfMutationObservers:new di("Nb of Mutation Observers")},mutations:{category:"Mutations",initialDOM:new ui("Initial DOM"),pendingMutations:new li("Nb of Mutations scheduled"),serializedMutations:new ui("Serialized Mutations"),count:new li("Mutation Count"),elementMutationObserved:new di("Nb of Elements Observed by MutationObserver"),unobserveGarbageCollection:new ui("Unobserve GC")},visibilityObserver:{category:"Visibility Observer",hiddenElements:new li("Nb of Hidden Elements "),nbElements:new li("Nb of  Elements")}};let gi=null;var mi,yi,fi,vi,Ei;function Si(t,e,s,i){var n,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,s,o):n(e,s))||o);return r>3&&o&&Object.defineProperty(e,s,o),o}function wi(t){return Me(t,"data:")}function Ri(t){return Me(t,"#")}function Ai(t){return!!t&&De(t,".css")}function bi(t){const e=csString.prototype.trim.call(t);if(""===t)return[];let[s,i]=(n=e,csString.prototype.split.call(n,/\s(.+)/));var n;return i?(De(s,",")||(i=function(t){return csString.prototype.split.call(t,/,(.+)/)[1]||""}(i)),[Ti(s),...bi(i)]):[Ti(s)]}function Ti(t){return csString.prototype.split.call(t,/,$/)[0]}mi=()=>{const t=t=>Object.keys(t),e=csArray.prototype.map.call(t(pi),(t=>pi[t])),s=csArray.prototype.map.call(e,(e=>csArray.prototype.filter.call(csArray.prototype.map.call(t(e),(t=>e[t])),(t=>t instanceof hi)))),i=csArray.prototype.map.call(e,((t,e)=>({category:t.category,performanceCounters:csArray.prototype.map.call(s[e],(t=>({name:t.name,format:t.format})))})));ci({type:"UXA_PERFORMANCE_COUNTER_SCHEMA",event:i}),gi||(gi=csSetInterval((()=>{ci({type:"UXA_PERFORMANCE_COUNTER",event:Mt(Lt(s,(t=>Lt(t,(t=>t.getData())))),(t=>t))})}),1e3))},o||(null!==ri&&csSetTimeout(mi),csSetTimeout((()=>csArray.prototype.push.call(ai,mi)))),function(t){t.QUOTA_REACHED="X",t.RECORDING_RULES_TARGETING="8",t.ANALYTICS_ONLY_RULES_TARGETING="9",t.ANALYTICS_ONLY="0",t.RECORDING_GLOBAL_SAMPLING="5",t.RECORDING_TEMPORARILY="T",t.RECORDING_URL_SAMPLING="6",t.RECORDING_ETR_SAMPLING="7",t.RECORDING_BLOCKED_BY_CONSENT_NOT_EXPRESSED="B",t.RECORDING_BLOCKED_BY_CONSENT_WITHDRAWN="W"}(yi||(yi={})),function(t){t.ETR_OFF="0",t.ETR_ON="1"}(fi||(fi={})),function(t){t.ETR_LEGACY="0",t.ETR_SESSION="1",t.ETR_PAGE="2"}(vi||(vi={})),function(t){t.ETR_DISABLED="0",t.ETR_PENDING="1",t.ETR_SAVED_PAGE="2",t.ETR_SAVED_SESSION="3",t.ETR_NOT_SAVED_SESSION="9"}(Ei||(Ei={}));const Ci=/(@import\s*("([^"]+)"|'([^']+)'))|(url\s*\(\s*((("([^"\]]+)"|'([^'\]]+)')\s*)|([^)\]]+))\))/g;function _i(t){const e=new Set;return function(t,e){csString.prototype.replace.call(t,Ci,(function(){const t=(arguments.length<=3?void 0:arguments[3])||(arguments.length<=4?void 0:arguments[4]),s=function(t){return csString.prototype.replace.call(t,/(\\)*\\(?:([a-fA-F0-9]{1,6})|(.))[\n\t\x20]?/g,((t,e,s,i)=>{if("\\"===e)return csString.prototype.slice.call(t,1);if(i)return i;const n=parseInt(s,16);return 55296<=n&&n<=57343||0===n||n>1114111?"ï¿½":csString.fromCodePoint(n)}))}((t||(arguments.length<=9?void 0:arguments[9])||(arguments.length<=10?void 0:arguments[10])||(arguments.length<=11?void 0:arguments[11])).trim());return`${t?"@import ":""}url(${function(t){return-1===csString.prototype.indexOf.call(t,'"')?`"${t}"`:-1===csString.prototype.indexOf.call(t,"'")?`'${t}'`:t}(e(s)||s)})`}))}(t,(t=>{var s,i;return e.add(null!==(i=null===(s=csString.prototype.match.call(t,/^["|'](.*)?["|']$/))||void 0===s?void 0:s[1])&&void 0!==i?i:t),t})),Ht(e)}const Ni=new Map,Ii=!o&&document.implementation.createHTMLDocument("");function Oi(t){try{if(t.disabled)return null;const e=t.sheet;return e?e.cssRules||e.rules:null}catch(t){if("SecurityError"!==t.name&&"InvalidAccessError"!==t.name)throw t;return null}}const Pi=t=>t instanceof HTMLFormElement?"form":t.localName;class ki{constructor(t){this.csId=Qs(t),this.props=Fs.getStore(t)}}class Li extends ki{constructor(t){super(t),this.nodeType=3,this.data=t.data}}class Mi extends ki{constructor(t){var e;super(t),this.attributes=[],this.nodeType=1,this.localName=Pi(t),this.namespaceURI=null!==(e=t.namespaceURI)&&void 0!==e?e:void 0,this.children=[];const s=function(t){if(!P(t))return null;const e=Oi(t);if(null===e||0===e.length)return null;let s="";if(T(t.textContent))Dt(e,(t=>s+=t.cssText));else{const i=function(t){if(!Ii)return 0;let e=Ni.get(t.textContent);if(e)return e;const s=t.cloneNode(!0);s.textContent=t.textContent,Ii.head.appendChild(s);const i=Oi(s);return e=i?i.length:0,Ni.set(t.textContent,e),Ii.head.removeChild(s),e}(t);if(i===e.length)return null;if(i>e.length)return null;const n=new csArray(e.length-i);for(let t=i,s=0;t<e.length;t+=1,s+=1)n[s]=e[t];Dt(n,(t=>s+=t.cssText))}return s}(t);if(s){this.children=new csArray(csNodechildNodes.apply(t).length);const e=document.createTextNode(s),i=new Li(e);csArray.prototype.push.call(this.children,i)}D(t)&&js.setProperty(this,"SVG",!0)}static isElement(t){return 1===t.nodeType}static getAttribute(t,e){return xt(t.attributes,(t=>t.name===e))}static getAttributeValue(t,e){var s;return null===(s=this.getAttribute(t,e))||void 0===s?void 0:s.value}}class Di{constructor(t){this.type="asyncEvent",this.Re=!1,t&&t((t=>this.resolve(t)))}resolve(e){if(this.Re)throw new Error("AsyncEvent already resolve.");null==e.timestamp&&(e=t._objectSpread2(t._objectSpread2({},e),{},{timestamp:this.timestamp})),this.Se=e,this.Re=!0,this.Qs&&this.Qs(this.Se)}complete(t){this.Re&&t(this.Se),this.Qs=t}wait(){return new Promise((t=>this.complete(t)))}}let xi=(Ui="queueMicrotask",Vi=csSetTimeout,void 0!==a[Ui]?a[Ui]:Vi);var Ui,Vi;"object"==typeof window&&R(window.csQueueMicrotask)&&(xi=window.csQueueMicrotask);const Bi=new vt,Hi=new vt;function $i(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"high";Bi.isEmpty&&Hi.isEmpty&&qi((()=>{const t=_t((()=>{for(;!Hi.isEmpty;)Hi.pop()();for(;!Bi.isEmpty;)Bi.pop()();Hi.isEmpty||t()}),"groupMicrotask.run");t()}));const s=ft(`groupMicrotask:${e}:${t.name||t.toString()}`,t);"high"===e?Hi.push(s):Bi.push(s)}function qi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;xi(0===e?t:()=>qi(t,e-1))}async function zi(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;for(let e=0;e<t;e++)await new Promise((t=>$i(t)))}function Fi(){const t=new Set;return{add(e){t.add(e),1===t.size&&csSetTimeout((()=>{t.clear()}))},has:e=>t.has(e),del(e){t.delete(e)},clear(){t.clear()},values:()=>Ht(t),get count(){return t.size}}}function ji(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=Fi();return{push(i){0===s.count&&(e?$i:csSetTimeout)((()=>{t(s.values()),s.clear()})),s.add(i)}}}const Gi=csSymbol();class Wi{constructor(t){var e,s,i,n,r,o,a,c;this.Qs=t,this.Te=null,this.Ie=null,this.Pe=null,this.be=null,this.Ve=ji((t=>this.processUpdateRulesInATick(t))),this.Qs=e=>$i((()=>t(e))),"function"==typeof(null===(s=null===(e=window.CSSStyleSheet)||void 0===e?void 0:e.prototype)||void 0===s?void 0:s.insertRule)&&(this.Te=Cs({target:window.CSSStyleSheet.prototype,methodName:"insertRule",hook:t=>{let{context:e,args:s}=t;this.processInsertRule(e,s)}})),"function"==typeof(null===(n=null===(i=window.CSSStyleSheet)||void 0===i?void 0:i.prototype)||void 0===n?void 0:n.deleteRule)&&(this.Ie=Cs({target:window.CSSStyleSheet.prototype,methodName:"deleteRule",hook:t=>{let{context:e,args:s}=t;this.processDeleteRule(e,s)}})),"function"==typeof(null===(o=null===(r=window.CSSGroupingRule)||void 0===r?void 0:r.prototype)||void 0===o?void 0:o.insertRule)&&(this.Pe=Cs({target:window.CSSGroupingRule.prototype,methodName:"insertRule",hook:t=>{let{context:e}=t;return this.processUpdateRule(e)}})),"function"==typeof(null===(c=null===(a=window.CSSGroupingRule)||void 0===a?void 0:a.prototype)||void 0===c?void 0:c.deleteRule)&&(this.be=Cs({target:window.CSSGroupingRule.prototype,methodName:"deleteRule",hook:t=>{let{context:e}=t;return this.processUpdateRule(e)}}))}observe(){var t,e,s,i;null===(t=this.Te)||void 0===t||t.activate(),null===(e=this.Ie)||void 0===e||e.activate(),null===(s=this.Pe)||void 0===s||s.activate(),null===(i=this.be)||void 0===i||i.activate()}disconnect(){var t,e,s,i;null===(t=this.Te)||void 0===t||t.deactivate(),null===(e=this.Ie)||void 0===e||e.deactivate(),null===(s=this.Pe)||void 0===s||s.deactivate(),null===(i=this.be)||void 0===i||i.deactivate()}processInsertRule(t,e){let[s,i]=e;if(null==t[Gi]&&!t.ownerNode)return;const n={type:"cssRuleInserted",sheet:t,rule:s,index:i};this.Qs(n)}processUpdateRule(t){let e=t;for(;null!==e.parentRule;)e=e.parentRule;null!==e.parentStyleSheet&&this.Ve.push(e)}processUpdateRulesInATick(t){for(const e of t){if(null===e.parentStyleSheet)return;const t=e.parentStyleSheet,s=csArray.prototype.indexOf.call(kt(t.cssRules),e);if(-1===s)return;const i={type:"cssRuleUpdated",sheet:t,rule:e.cssText,index:s};this.Qs(i)}}processDeleteRule(t,e){let[s]=e;if(null==t[Gi]&&!t.ownerNode)return;const i={type:"cssRuleDeleted",sheet:t,index:s};this.Qs(i)}}ae([yt()],Wi.prototype,"observe",null),ae([yt()],Wi.prototype,"disconnect",null),ae([yt()],Wi.prototype,"processInsertRule",null),ae([yt()],Wi.prototype,"processUpdateRule",null),ae([yt()],Wi.prototype,"processUpdateRulesInATick",null),ae([yt()],Wi.prototype,"processDeleteRule",null);class Yi{constructor(t){this.Ce=1,this.ke=new Set,this.Oe=null,this.Ne=null,this.xe=(t,e)=>{"initial"!==e&&"added"!==e||this.setStyleSheets(t,t.adoptedStyleSheets)},this.$e=t=>{const e=t.sheet;if(this.ke.has(e))if("cssRuleInserted"===t.type){const s={type:"adoptedStyleSheetRuleInserted",sheetId:e[Gi],rule:t.rule,index:t.index};this.Qs(s)}else if("cssRuleDeleted"===t.type){const s={type:"adoptedStyleSheetRuleDeleted",sheetId:e[Gi],index:t.index};this.Qs(s)}else if("cssRuleUpdated"===t.type){const s={type:"adoptedStyleSheetRuleUpdated",sheetId:e[Gi],rule:t.rule,index:t.index};this.Qs(s)}},this.Qs=e=>$i((async()=>{await zi(2),t(e)})),this.se=new Is(this.xe),"adoptedStyleSheets"in Document.prototype&&(this.Oe=_s(window.Document.prototype,"adoptedStyleSheets",((t,e)=>{this.setStyleSheets(t,e)}))),"ShadowRoot"in window&&"adoptedStyleSheets"in window.ShadowRoot.prototype&&(this.Ne=_s(window.ShadowRoot.prototype,"adoptedStyleSheets",((t,e)=>{this.setStyleSheets(t,e)}))),this.Me=new Wi(this.$e)}observe(){var t,e;this.setStyleSheets(document,document.adoptedStyleSheets),this.se.observe(),null===(t=this.Oe)||void 0===t||t.activate(),null===(e=this.Ne)||void 0===e||e.activate(),this.Me.observe()}disconnect(){var t,e;this.ke.clear(),this.se.disconnect(),null===(t=this.Oe)||void 0===t||t.deactivate(),null===(e=this.Ne)||void 0===e||e.deactivate(),this.Me.disconnect()}setStyleSheets(t,e){if(!e.length)return;this.Le(e);const s={type:"adoptedStyleSheetsSet",target:t,sheetsIds:Lt(e,(t=>t[Gi]))};this.Qs(s)}Le(t){Dt(t,(t=>{if(this.ke.has(t))return;const e=this.Ce++;t[Gi]=e,this.ke.add(t);const s={type:"adoptedStyleSheetRegistered",sheetId:e,cssRules:this.De(t)};this.Qs(s)}))}De(t){let e=[];try{e=Lt(t.cssRules,(t=>t.cssText))}catch(t){}return e}}ae([yt()],Yi.prototype,"observe",null),ae([yt()],Yi.prototype,"disconnect",null),ae([yt()],Yi.prototype,"setStyleSheets",null);const Qi=_t((function(t){const e=function(){const t=new Set,e=new Set,s=new Set,i=new Set,n=new Map,r=new Map,o=new Map,a=new Set,c=new Set,h=new Map,l=new Set;return{isMovedNode:e=>t.has(e),markAsMovedNode(e){l.delete(e),t.add(e)},isDetachedMove:t=>!!qt.findAncestor(t,(t=>l.has(t)),!0),isAddedNode(s){const i=qt.findAncestor(s,(s=>e.has(s)||c.has(s)||t.has(s)),!0);return!!i&&!t.has(i)},isMovedNodeIntoAddedNode:s=>t.has(s)&&!!qt.findAncestor(s,(t=>e.has(t)||c.has(t)),!0),markAsAddedNode(t){l.delete(t),c.delete(t),e.add(t)},markAsPendingInsert(t){c.add(t)},isPendingInsert:t=>c.has(t),isRemovedNode:t=>!!qt.findAncestor(t,(t=>s.has(t)),!0),markAsRemovedNode(t){s.add(t)},isUselessNode:t=>i.has(t),markAsUselessNode(t){i.add(t)},getPlaceholder(t,e){const s="previous"===e?r:n;return t&&s.has(t)?s.get(t)||null:t},getSiblings(t){const e=t.addedNodes.length,s=this.getPlaceholder(t.previousSibling,"previous"),i=this.getPlaceholder(t.nextSibling,"next");if(e){let o=s,a=i,c=t.previousSibling!==s,h=t.nextSibling!==i;for(let s=0;s<e;s++){const i=t.addedNodes[s],l=t.addedNodes[e-s-1];this.isLatestNodeMutation(i,t)?(r.delete(i),t.previousSibling&&c&&(n.set(t.previousSibling,i),c=!1),o=i):r.set(i,o),this.isLatestNodeMutation(l,t)?(n.delete(l),t.nextSibling&&h&&(r.set(t.nextSibling,l),h=!1),a=l):n.set(l,a)}}else t.previousSibling&&t.previousSibling!==s&&n.set(t.previousSibling,i),t.nextSibling&&t.nextSibling!==i&&r.set(t.nextSibling,s);return{previousSibling:s,nextSibling:i}},setAttributeMutation(t,e){const s=o.get(t)||new Set;s.add(e),o.set(t,s)},isAttributeMutated(t,e){var s;return!!(null===(s=o.get(t))||void 0===s?void 0:s.has(e))},setLatestNodeMutation(t,e){h.set(t,e)},isLatestNodeMutation:(t,e)=>h.get(t)===e,markAsFutureAddedNode(t){h.has(t)||l.add(t)},isTextMutated:t=>a.has(t),setTextMutated:t=>a.add(t)}}(),s=[];for(const s of t)"childList"===s.type&&Xi(s,e);for(const i of t)switch(i.type){case"attributes":Ji(i,e,s);break;case"characterData":Ki(i,e,s);break;case"childList":en(i,e,s)}return s}),"optimizeMutations"),Zi=csSymbol.for("ignoreNextSerialization");function Xi(t,e){for(let s=0;s<t.addedNodes.length;s++){const i=t.addedNodes[s];e.markAsFutureAddedNode(i),e.setLatestNodeMutation(i,t)}for(let s=0;s<t.removedNodes.length;s++){const i=t.removedNodes[s];e.setLatestNodeMutation(i,t)}}function Ki(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=t.target;return!qt.isConnected(i)||e.isTextMutated(i)||e.isAddedNode(i)||function(t,e,s){const i=csSymbol.for(e),n=Ie(),r=t[i];return!!(r&&n<r)||(t[i]=n+tn,!1)}(i,"characterData")||(e.setTextMutated(i),csArray.prototype.push.call(s,t)),s}function Ji(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=t.target,n=`${t.attributeNamespace}/${t.attributeName}`;return!qt.isConnected(i)||e.isAttributeMutated(i,n)||e.isAddedNode(i)||(e.setAttributeMutation(i,n),csArray.prototype.push.call(s,t)),s}const tn=30;function en(s,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const r=qt.isConnected(s.target),o=!r&&i.isRemovedNode(s.target),a=r&&i.isAddedNode(s.target),c=i.getSiblings(s),h=c.nextSibling;let l=c.previousSibling,d=null;const u=()=>{if(d){const{childListType:s,movedNodes:i}=d,r=t._objectWithoutProperties(d,e);csArray.prototype.push.call(n,"added"===s?r:t._objectSpread2(t._objectSpread2({},r),{},{movedNodes:i})),d=null}},p=t=>t===(null==d?void 0:d.childListType)?d:(u(),{childListType:t,type:"childList",target:s.target,addedNodes:[],removedNodes:[],movedNodes:[],previousSibling:l,nextSibling:h});if(r){for(let t=0;t<s.addedNodes.length;t++){const e=s.addedNodes[t];i.isLatestNodeMutation(e,s)?(i.isMovedNode(e)?(d=p("moved"),csArray.prototype.push.call(d.movedNodes,e)):(i.markAsAddedNode(e),a||(d=p("added"),csArray.prototype.push.call(d.addedNodes,e))),l=e):qt.isConnected(e)?i.isMovedNode(e)||i.markAsPendingInsert(e):i.markAsUselessNode(e)}u()}const g=Vt(s.removedNodes,(t=>{if(qt.isConnected(t)){if(!o&&!i.isPendingInsert(t)){if(i.isDetachedMove(t))return!0;i.markAsMovedNode(t),i.isMovedNodeIntoAddedNode(t)&&(t[Zi]=!0)}return!1}return!i.isUselessNode(t)&&(i.markAsRemovedNode(t),!0)}));return g.length&&csArray.prototype.push.call(n,{type:"childList",removedNodes:g,addedNodes:[],movedNodes:[],target:s.target,nextSibling:h,previousSibling:l}),n}var sn;const nn={childList:!0,subtree:!0,attributes:!0,characterData:!0,characterDataOldValue:!0,attributeOldValue:!0};class rn{static setShadowRootFilter(t){csArray.prototype.push.call(sn.shadowRootFilters,t)}static Ue(t){if(sn.shadowRootFilters.length>0&&B(t))for(let e=0;e<sn.shadowRootFilters.length;e++)if((0,sn.shadowRootFilters[e])(t))return;this.observedTargets.add(t),this.mutationObserver.observe(t,nn)}static disconnectShadowRoot(t){this.observedTargets.has(t)&&(this.observedTargets.delete(t),this.isRefreshing||(this.isRefreshing=!0,$i((()=>{this.isRefreshing=!1;const t=this.mutationObserver.takeRecords();t.length&&sn.mutationCallback(t),this.mutationObserver.disconnect(),this.observedTargets.forEach((t=>{this.mutationObserver.observe(t,nn)}))}))))}static observe(t,e){csArray.prototype.push.call(this.callbacks,t),e&&csArray.prototype.push.call(this.shadowRootCallbacks,e),this.started?e&&csArray.prototype.forEach.call(It.getAllShadowHosts(document),(t=>e(csElementshadowRoot.apply(t),"initial"))):(this.mutationObserver=new csMutationObserver(this.mutationCallback),this.Ue(document),this.shadowRootObserver=new Is(this.onShadowRoot),this.shadowRootObserver.observe(),this.started=!0,Dt(this.shadowRootObserver.shadowRoots,(t=>{this.Ue(t)})))}static disconnect(t,e){var s,i;this.callbacks=csArray.prototype.filter.call(this.callbacks,(e=>e!==t)),e&&(this.shadowRootCallbacks=csArray.prototype.filter.call(this.shadowRootCallbacks,(t=>t!==e))),0===this.callbacks.length&&(this.callbacks=[],this.shadowRootCallbacks=[],sn.shadowRootFilters=[],null===(s=this.shadowRootObserver)||void 0===s||s.disconnect(),null===(i=this.mutationObserver)||void 0===i||i.disconnect(),this.observedTargets.clear(),this.started=!1)}constructor(t,e){this.Qs=t,this.Fe=e;const s=ji((e=>t(e,this)),!0);this.Qs=ft("DocumentMutationObserver:callback",(t=>{Dt(t,(t=>s.push(t)))}))}get shadowRoots(){var t,e;return null!==(e=null===(t=sn.shadowRootObserver)||void 0===t?void 0:t.shadowRoots)&&void 0!==e?e:[]}takeRecords(){var t;const e=null===(t=sn.mutationObserver)||void 0===t?void 0:t.takeRecords(),s=sn.shadowRootObserver.takeRecords();return(null==e?void 0:e.length)&&s.length?function(t,e,s){const i=t.length+e.length+0,n=new csArray(i);let r=0;for(let e=0;e<t.length;e++)n[r++]=t[e];for(let t=0;t<e.length;t++)n[r++]=e[t];return n}(e,s):null!=e?e:s}observe(){sn.observe(this.Qs,this.Fe)}disconnect(){sn.disconnect(this.Qs,this.Fe)}}sn=rn,rn.callbacks=[],rn.shadowRootCallbacks=[],rn.started=!1,rn.observedTargets=new Set,rn.shadowRootFilters=[],rn.mutationCallback=t=>{pi.mutations.count.increase(t.length),csArray.prototype.forEach.call(sn.callbacks,(e=>e(t,sn.mutationObserver)))},rn.onShadowRoot=(t,e)=>{Dt(sn.shadowRootCallbacks,(s=>s(t,e))),"removed"!==e?sn.Ue(t):sn.disconnectShadowRoot(t)},rn.isRefreshing=!1,ae([yt()],rn.prototype,"observe",null),ae([yt()],rn.prototype,"disconnect",null);class on{constructor(t){this.Qs=t,this.Be=t=>{t.sheet.ownerNode&&("cssRuleInserted"===t.type?this.Qs({type:t.type,target:t.sheet.ownerNode,rule:t.rule,index:t.index}):"cssRuleDeleted"===t.type?this.Qs({type:t.type,target:t.sheet.ownerNode,index:t.index}):"cssRuleUpdated"===t.type&&this.Qs({type:t.type,target:t.sheet.ownerNode,rule:t.rule,index:t.index}))},this.Qs=e=>$i((()=>t(e))),this.qe=new Wi((t=>$i((async()=>{await zi(),this.Be(t)})))),"adoptedStyleSheets"in Document.prototype&&(this.He=new Yi(t))}observe(){var t;this.Fs=new rn((t=>this.ze(t)),((t,e)=>{"added"===e&&this.je(t)})),this.Fs.observe(),this.qe.observe(),null===(t=this.He)||void 0===t||t.observe()}disconnect(){var t,e;null===(t=this.Fs)||void 0===t||t.disconnect(),this.qe.disconnect(),null===(e=this.He)||void 0===e||e.disconnect()}ze(t){const e=Qi(t);for(let t=0;t<e.length;t++){const s=e[t];if(s)switch(s.type){case"attributes":this.processAttributeChanged(s);break;case"characterData":this.processCharacterDataChanged(s);break;case"childList":this.processChildListChanged(s);break;default:mt.error(`processRawMutations: unknown record type '${s.type}'`)}else mt.error("processRawMutations: empty record")}}processAttributeChanged(t){const e={type:"attributeChanged",target:t.target,attribute:t.attributeName,namespace:t.attributeNamespace,oldValue:t.oldValue,newValue:qt.getAttributeNS(t.target,t.attributeNamespace,t.attributeName)};this.Qs(e)}processCharacterDataChanged(t){const e={type:"characterDataChanged",target:t.target,oldValue:t.oldValue,newValue:t.target.data};this.Qs(e)}processChildListChanged(t){var e,s,i;if(null===(e=t.movedNodes)||void 0===e?void 0:e.length){const e={type:"nodesMoved",target:t.target,nodes:t.movedNodes,previousSibling:t.previousSibling,nextSibling:t.nextSibling};this.Qs(e)}if(null===(s=t.addedNodes)||void 0===s?void 0:s.length){const e={type:"nodesAdded",target:t.target,previousSibling:t.previousSibling,nextSibling:t.nextSibling,nodes:kt(t.addedNodes)};this.Qs(e)}if(null===(i=t.removedNodes)||void 0===i?void 0:i.length){const e={type:"nodesRemoved",target:t.target,nodes:Lt(t.removedNodes,(t=>t))};this.Qs(e)}}je(t){const e={type:"shadowRootAttached",target:t.host,shadowRoot:t};this.Qs(e)}}ae([yt()],on.prototype,"processAttributeChanged",null),ae([yt()],on.prototype,"processCharacterDataChanged",null),ae([yt()],on.prototype,"processChildListChanged",null);class an extends ki{constructor(t){super(t),this.nodeType=4,this.data=t.data}}class cn extends ki{constructor(t){super(t),this.nodeType=8,this.data=t.data}}class hn extends ki{constructor(t){super(t),this.nodeType=10,this.name=t.name,this.publicId=t.publicId,this.systemId=t.systemId}}class ln extends ki{constructor(t){super(t),this.nodeType=9,this.baseURI=ln.getBaseURI(t),this.children=[]}static getBaseURI(t){let e=t.baseURI;if(null==e){const s=t.getElementsByTagName("base");e=0!==s.length?s[0].href:t.URL}return e}}class dn extends ki{constructor(t){super(t),this.nodeType=11,this.mode=t.mode,this.children=[]}}class un{constructor(t,e,s){var i;"string"==typeof t?(this.name=t,this.value=e,this.namespaceURI=null!=s?s:""):(this.name=t.name,this.value=t.value,this.namespaceURI=null!==(i=t.namespaceURI)&&void 0!==i?i:"")}static create(t){var e,s;const i=t.attributes,n=new csArray(i.length);for(let r=0;r<n.length;r++){const o=i[r];n[r]=new un(o.name,o.value,o.namespaceURI),"href"===o.name&&O(t)&&(n[r].value=null!==(s=null===(e=t.sheet)||void 0===e?void 0:e.href)&&void 0!==s?s:o.value)}return n}}const pn={workTime:40,async:!0,initialDOM:!0};let gn=csSymbol("InitialDom");const mn=csSymbol.for("ignoreNextSerialization");function yn(t){return!!t[mn]&&(delete t[mn],!0)}function fn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pn;return function(e,s){var i;null!==(i=t.workTime)&&void 0!==i||(t.workTime=pn.workTime);const n=ft("serialize:callback",(t=>s(t))),r=new vt,o=(e,s)=>{e.hasChildNodes()&&r.push({node:e,serializedNode:s});const i=e instanceof Element&&csElementshadowRoot.apply(e);if(i){const e=s.shadowRoot=En(i);t.async&&t.initialDOM&&js.setProperty(i,gn,!0),o(i,e)}};let a,c=!0,h=8;const l=ft("work",(()=>{var i;if(c)a=En(e),t.async&&t.initialDOM&&js.setProperty(e,gn,!0),o(e,a),c=!1;else if(r.isEmpty)return;const d=function(t){let e=0,s=performance.now();return{started:s,elapsed(){return++e%100==0&&(s=performance.now()),s-this.started}}}();for(;!r.isEmpty;){if(t.async&&d.elapsed()>=t.workTime)return void(--h<=0&&csSetTimeout(l));const{node:e,serializedNode:s}=r.pop(),n=null!==(i=s.children)&&void 0!==i?i:[];if(M(e))continue;let a=0;for(let s=csNodefirstChild.apply(e);s;s=csNodenextSibling.apply(s)){if(yn(s))continue;const e=En(s);t.async&&t.initialDOM&&js.setProperty(s,gn,!0),n[a++]=e,o(s,e)}}t.async?csSetTimeout((()=>n(a))):s(a)}));if(t.async)for(let t=0;t<h;t++)csSetTimeout(l,1);else t.workTime=1/0,l()}}const vn=_t((function(t){const e=En(t),s=e;if(M(t))return e;let i=0;for(let e=csNodefirstChild.apply(t);e;e=csNodenextSibling.apply(e))yn(e)||(s.children[i++]=vn(e));const n=t.shadowRoot;return n&&(s.shadowRoot=vn(n)),e}),"serializeSync");function En(t){let e,s;switch(t.nodeType){case 1:s=e=new Mi(t),e.attributes=function(t){return M(t)?[]:un.create(t)}(t);break;case 3:s=new Li(t);break;case 4:s=new an(t);break;case 8:s=new cn(t);break;case 10:s=new hn(t);break;case 9:s=new ln(t);break;case 11:s=new dn(t);break;default:throw new Error("Node type not supported: "+t.nodeType)}return s}class Sn{constructor(){this.Ge=[],this.isStarted=!1}produceEvent(t){this.isStarted&&(t.timestamp=Ie(),csArray.prototype.forEach.call(this.Ge,(e=>e(t))))}onStop(){}start(){this.isStarted||(this.isStarted=!0,this.onStart())}stop(){this.isStarted&&(this.isStarted=!1,this.onStop(),this.Ge=[])}stopForInactivity(){this.isStarted&&(this.isStarted=!1,this.onStop())}subscribe(t){return csArray.prototype.push.call(this.Ge,t),()=>{const e=csArray.prototype.indexOf.call(this.Ge,t);csArray.prototype.splice.call(this.Ge,e,1)}}}const wn=fn();class Rn extends Sn{constructor(){super(...arguments),this.Ze=!1}onStart(){this.Ze=!0,this.Qs=function(t,e){let s=!1;const i=function(){if(!s)return t.apply(e,arguments)};return i.cancel=()=>s=!0,i}(this.We,this),this.Qe=new on(this.Qs),this.Qe.observe();const t=pi.mutations.initialDOM.asyncMeasure(),e=()=>{this.Ze=!1,gn=csSymbol("InitialDom"),t()};this.produceEvent(new Di((t=>wn(document,(s=>{e(),t({type:"DomEvent",domEvent:"initialDOM",initialDOM:s})})))))}onStop(){var t,e;this.Ze=!1,null===(t=this.Qs)||void 0===t||t.cancel(),null===(e=this.Qe)||void 0===e||e.disconnect()}Je(t,e){const s={type:"DomEvent",domEvent:e.type,target:0,targetProps:{}};return"target"in e&&(s.target=Qs(e.target),s.targetProps=js.getProperties(e.target)),[e,s]}We(t){if(!this.Ke(t))switch(t.type){case"attributeChanged":{const[e,s]=this.Je(t.type,t);s.attribute=e.attribute,s.isSvg=D(e.target),s.namespace=e.namespace,s.newValue=e.newValue,s.oldValue=e.oldValue,s.localName=Pi(e.target),s.linkRel=N(e.target)?e.target.rel:null,s.parentLocalName=e.target.parentElement?Pi(e.target.parentElement):void 0,"input"===s.localName&&(s.inputType=e.target.getAttribute("type")),this.produceEvent(s)}break;case"characterDataChanged":{const[e,s]=this.Je(t.type,t);s.newValue=e.newValue,s.oldValue=e.oldValue,s.targetNodeType=e.target.nodeType,s.parentLocalName=e.target.parentElement?Pi(e.target.parentElement):null,s.parentProps=e.target.parentElement?js.getProperties(e.target.parentElement):void 0,this.produceEvent(s)}break;case"nodesAdded":{const[e,s]=this.Je(t.type,t);s.targetLocalName=C(e.target)?Pi(e.target):null,s.nextSibling=e.nextSibling?Qs(e.nextSibling):null,s.previousSibling=e.previousSibling?Qs(e.previousSibling):null,pi.mutations.serializedMutations.measure((()=>{s.nodes=Lt(e.nodes,vn)})),this.produceEvent(s);break}case"nodesMoved":{const[e,s]=this.Je(t.type,t);s.previousSibling=e.previousSibling?Qs(e.previousSibling):null,s.nextSibling=e.nextSibling?Qs(e.nextSibling):null,s.nodesIds=Lt(e.nodes,Qs),this.produceEvent(s);break}case"nodesRemoved":{const[e,s]=this.Je(t.type,t);s.nodesIds=Lt(e.nodes,Qs),this.produceEvent(s);break}case"shadowRootAttached":{const[e,s]=this.Je(t.type,t);s.shadowRoot=En(e.shadowRoot),this.produceEvent(s);break}case"cssRuleInserted":{const[e,s]=this.Je(t.type,t);s.index=e.index,s.rule=e.rule,this.produceEvent(s);break}case"cssRuleDeleted":{const[e,s]=this.Je(t.type,t);s.index=e.index,this.produceEvent(s);break}case"cssRuleUpdated":{const[e,s]=this.Je(t.type,t);s.rule=e.rule,s.index=e.index,this.produceEvent(s);break}case"adoptedStyleSheetRegistered":{const[e,s]=this.Je(t.type,t);s.sheetId=e.sheetId,s.cssRules=e.cssRules,this.produceEvent(s);break}case"adoptedStyleSheetsSet":{const[e,s]=this.Je(t.type,t);s.sheetsIds=e.sheetsIds,this.produceEvent(s);break}case"adoptedStyleSheetRuleInserted":{const[e,s]=this.Je(t.type,t);s.sheetId=e.sheetId,s.rule=e.rule,s.index=e.index,this.produceEvent(s);break}case"adoptedStyleSheetRuleDeleted":{const[e,s]=this.Je(t.type,t);s.sheetId=e.sheetId,s.index=e.index,this.produceEvent(s);break}case"adoptedStyleSheetRuleUpdated":{const[e,s]=this.Je(t.type,t);s.sheetId=e.sheetId,s.rule=e.rule,s.index=e.index,this.produceEvent(s);break}}}Ye(t){return this.Ze&&!js.getProperty(t,gn)}Ke(t){switch(t.type){case"nodesAdded":case"nodesMoved":case"nodesRemoved":case"shadowRootAttached":return this.Ye(t.target)||Ks.isMaskedElement(t.target)||Ks.isMaskedElementChild(t.target);case"characterDataChanged":{const e=t.target.parentElement;return null!==e&&(this.Ye(e)||Ks.isMaskedElement(e)||Ks.isMaskedElementChild(e))}case"attributeChanged":return this.Ye(t.target)||Ks.isMaskedElementChild(t.target)||Ks.isMaskedAttribute(t.target,t.attribute);case"cssRuleInserted":case"cssRuleDeleted":case"cssRuleUpdated":return this.Ye(t.target)||Ks.isMaskedElementChild(t.target);default:return!1}}}var An,bn,Tn,Cn,_n,Nn,In;!function(t){t.isDOMEvent=function(t){return"DomEvent"===t.type}}(An||(An={}));class On{constructor(){this.Ge=[]}start(){}stop(){this.Ge.length=0,this.Ge=[]}pushEvent(t){if(On.pendingEvents++,this.isListening(t)){const e=this.Ge;csSetTimeout((()=>{const s=ft("Processor:processEvent",(t=>this.processEvent(t))),i=s(t);null!=i&&csArray.prototype.forEach.call(e,(t=>t(i))),On.pendingEvents--}))}else csSetTimeout((()=>{csArray.prototype.forEach.call(this.Ge,(e=>e(t)))}))}subscribe(t){return csArray.prototype.push.call(this.Ge,t),()=>{this.Ge=csArray.prototype.filter.call(this.Ge,(e=>e!==t))}}emitEvent(t){$i((()=>csArray.prototype.forEach.call(this.Ge,(e=>e(t)))))}}function Pn(t){const e=new ArrayBuffer(t.length),s=new Uint8Array(e);for(let e=0,i=t.length;e<i;e+=1)s[e]=csString.prototype.charCodeAt.call(t,e);return e}function kn(t){const e=new Uint8Array(t);let s="";for(let t=0;t<e.byteLength;t+=1)s+=csString.fromCodePoint(e[t]);return s}function Ln(t){return Pn(self.atob(t))}function Mn(t){const e=csArray.from(new Uint8Array(t));return csArray.prototype.join.call(csArray.prototype.map.call(e,(t=>csString.prototype.padStart.call(t.toString(16),2,"0"))),"")}function Dn(t){const e=-1!==csString.prototype.indexOf.call(t,";base64,"),s=csString.prototype.indexOf.call(t,","),i=e?[csString.prototype.substring.call(t,0,s-7),csString.prototype.substring.call(t,s+1)]:[csString.prototype.substring.call(t,0,s),csString.prototype.substring.call(t,s+1)];if(!e&&/^%3Csvg/i.test(i[1]))try{i[1]=decodeURIComponent(i[1])}catch(t){mt.warn(`${t}, calling decodeURIComponent on: ${i[1]}`)}const n=e?Ln(i[1]):Pn(i[1]);return new Blob([n],{type:csString.prototype.replace.call(i[0],"data:","")})}On.pendingEvents=0,function(t){t.ELLIPSIS="â€¦",t.stringReplaceAll=function(t,e,s){if("replaceAll"in csString.prototype)return csString.prototype.replaceAll.call(t,e,s);const i=new csRegExp((n=e,csString.prototype.replace.call(n,/[.*+?^${}()|[\]\\]/g,"\\$&")),"g");var n;return csString.prototype.replace.call(t,i,s)},t.truncate=function(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t.length<=e?t:csString.prototype.slice.call(t,0,e-s.length)+s}}(bn||(bn={}));class xn{static async toStaticResourceEvent(t,e,s){const i=await xn.Xe(t);if(!i)return null;const n=await xn.ti(i),r=wi(t)?void 0:t,o={type:"StaticResourceManagerEvent",timestamp:s,resourceId:e,resource:{hash:n,data:i}};return r&&(o.originalResourceName=r),o}static async toCSSStaticResourceEvent(t,e,s,i){const n=await xn.si(t,i),r=Fe(t),o=n.get(r);if(!o)return null;const a={type:"StaticResourceManagerEvent",timestamp:s,resourceId:e,resource:{hash:o.hash,data:o.data}};return n.delete(r),n.size&&(a.nestedResources=[],n.forEach((t=>{t&&csArray.prototype.push.call(a.nestedResources,{hash:t.hash,data:t.data})}))),a}static async ti(t){const e=await t.arrayBuffer();return Mn(await crypto.subtle.digest(this.ei,e))}static async Xe(t){let e;if(wi(t)){const s=Dn(t);if(!s)return null;e=s}else{const s=await window.fetch(t);e=await s.blob()}return e}static async si(t,e){const s=new Map,i=[{resourceRawPath:t,resourceAbsolutePath:Fe(t)}];for(;i.length>0;){const t=csArray.prototype.pop.call(i);if(e||null===t.resourceAbsolutePath||wi(t.resourceAbsolutePath)){if(void 0===s.get(t.resourceAbsolutePath))try{if(null===t.resourceRawPath||csString.prototype.indexOf.call(t.resourceRawPath,".css")>0){if(!t.data){const e=await fetch(t.resourceAbsolutePath);t.data=await e.text()}t.nestedResources||(t.nestedResources=_i(t.data));let e=!1,n=!1;for(const r of t.nestedResources){const o=wi(r)?r:t.resourceAbsolutePath?je(r,t.resourceAbsolutePath):Fe(r),a=s.get(o);if(void 0!==a){if(null!==a){const e=xn.ii(a,r);t.data=bn.stringReplaceAll(t.data,r,e)}continue}const c=void 0!==xt(i,(t=>t.resourceAbsolutePath===o));c||(e=!0,n||(csArray.prototype.push.call(i,t),n=!0),csArray.prototype.push.call(i,{resourceRawPath:r,resourceAbsolutePath:o}))}if(!e){const e=await xn.ni(t.data);s.set(t.resourceAbsolutePath,{hash:e.hash,data:e.data})}}else{let e;if(wi(t.resourceAbsolutePath)){const i=Dn(t.resourceAbsolutePath);if(!i){s.set(t.resourceAbsolutePath,null);continue}e=i}else{const s=await fetch(t.resourceAbsolutePath);e=await s.blob()}const i=await xn.ti(e);s.set(t.resourceAbsolutePath,{hash:i,data:e})}}catch(e){s.set(t.resourceAbsolutePath,null)}}else s.set(t.resourceAbsolutePath,null)}return s}static ii(t,e){let s=`cs://resources/${t.hash}`;return wi(e)||(s+=`?${xn.oi}=${e}`),s}static async ni(t){const e=new Blob([t],{type:"text/css"}),s=await e.arrayBuffer();return{data:e,hash:Mn(await crypto.subtle.digest(xn.ei,s))}}}xn.ei="SHA-256",xn.oi="original-resource-name";class Un extends On{constructor(){super(),this.hi="cssrm://",this.ci=0,this.ai=!1}isListening(t){return!(!Un.isSupported()||!An.isDOMEvent(t)||"initialDOM"!==t.domEvent&&"nodesAdded"!==t.domEvent&&"attributeChanged"!==t.domEvent&&"characterDataChanged"!==t.domEvent)}processEvent(t){switch(t.domEvent){case"initialDOM":case"nodesAdded":this.ui(t);break;case"attributeChanged":this.li(t);break;case"characterDataChanged":this.fi(t)}return t}disableOnlineAssets(){this.ai=!1}enableOnlineAssets(){this.ai=!0}isOnlineAssetsActivated(){return this.ai}ui(t){const e="initialDOM"===t.domEvent?[t.initialDOM]:t.nodes;for(const t of e)js.traverse(t,((t,e)=>{if(3===t.nodeType&&e)return void this.pi(t,e.localName);if(!Mi.isElement(t))return;const s=xt(t.attributes,(t=>"style"===t.name));if(s&&(s.value=this.mi(s.value)),this.wi(t)||this.gi(t,e)){const e=xt(t.attributes,(t=>"src"===t.name));e&&e.value&&(e.value=this.yi(e.value));const s=xt(t.attributes,(t=>"srcset"===t.name));if(s)return void(s.value=this.Ei(s.value))}if(this.Ai(t)&&this.ai){const e=xt(t.attributes,(t=>"href"===t.name));if(!e||!e.value)return;this.ci++,this._i(Fe(e.value),this.ci,!0),this.Ri(t,e,this.ci)}}))}Ri(t,e,s){csArray.prototype.push.call(t.attributes,{name:"data-cs-original-href",namespaceURI:"",value:e.value}),e.value=this.hi+s}pi(t,e){if(!t||"style"!==e)return;const s=this.mi(t.data);null!==s&&(t.data=s)}fi(t){if("style"!==t.parentLocalName||!t.newValue)return;const e=this.mi(t.newValue);null!==e&&(t.newValue=e)}li(t){if(!t.newValue||t.newValue===t.oldValue)return;const e="src"===t.attribute,s="srcset"===t.attribute;if("style"===t.attribute)return void(t.newValue=this.mi(t.newValue));if(!e&&!s)return;const i="img"===t.localName,n="source"===t.localName&&t.parentLocalName&&"picture"===t.parentLocalName;(i||n)&&(e&&(t.newValue=this.yi(t.newValue)),s&&(t.newValue=this.Ei(t.newValue)))}yi(t){return wi(t)||this.ai?(this.ci++,this._i(t,this.ci,!1,Ie()),this.hi+this.ci):t}Ei(t){if(!this.ai)return t;let e=t;const s=bi(t),i=Ie();for(const t of s)this.ci++,this._i(Fe(t),this.ci,!1,i),e=csString.prototype.replace.call(e,t,this.hi+this.ci);return e}mi(t){const e=_i(t);let s=t;const i=Ie();for(const t of e){const e=wi(t);if(!e&&!this.ai)continue;if(this.Si(t))continue;this.ci++,s=csString.prototype.replace.call(s,t,this.hi+this.ci);const n=Ai(t);e?this._i(t,this.ci,!1,i):this.ai&&(n?this._i(t,this.ci,!0,i):this._i(Fe(t),this.ci,!1,i))}return s}_i(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ie();const n=s?xn.toCSSStaticResourceEvent:xn.toStaticResourceEvent,r=new Di((async s=>{try{s(await n(t,e,i,this.ai)||{type:"warning",message:`Failed to process static resource: ${t}`})}catch(t){s({type:"warning",message:t})}}));this.emitEvent(r)}wi(t){return"img"===t.localName}gi(t,e){return"source"===t.localName&&!!e&&"picture"===e.localName}Ai(t){return"link"===t.localName&&csArray.prototype.some.call(t.attributes,(t=>"rel"===t.name&&"stylesheet"===t.value))}static isSupported(){return ke()&&function(){var t;return"undefined"!=typeof crypto&&R(null===(t=crypto.subtle)||void 0===t?void 0:t.digest)}()&&!!csArray.from}Si(t){return 0===csString.prototype.replace.call(t,/['"]+/g,"").length}}Si([Nt("StaticResourceManagerProcessor.processEvent")],Un.prototype,"processEvent",null),function(t){t.Visible="visible",t.Hidden="hidden",t.Blur="blur",t.PagehideVisible="pagehideVisible",t.PagehideHidden="pagehideHidden",t.ExitPageByNavigate="exitPageByNavigate"}(Tn||(Tn={}));class Vn{constructor(){this.Ti=!1,this.Ii=t=>{try{switch(t.type){case"visibilitychange":return"hidden"===document.visibilityState?this.Pi(Tn.Hidden):this.Pi(Tn.Visible);case"pagehide":return"hidden"===document.visibilityState?this.Pi(Tn.PagehideHidden):this.Pi(Tn.PagehideVisible);case"blur":return this.Pi(Tn.Blur);case"navigate":return this.bi(t)?this.Pi(Tn.ExitPageByNavigate):void 0;default:return}}catch(t){}}}start(){this.Ti||(this.Ti=!0,this.Vi(),this.Ci(),this.ki(),Le()&&this.Oi())}stop(){this.Ti&&(this.Ti=!1,this.Ni(),this.xi(),this.$i(),Le()&&this.Mi())}onEvent(t){this.Pi=t}Oi(){window.navigation.addEventListener("navigate",this.Ii)}Mi(){window.navigation.removeEventListener("navigate",this.Ii)}Vi(){document.addEventListener("visibilitychange",this.Ii)}Ni(){document.removeEventListener("visibilitychange",this.Ii)}Ci(){window.addEventListener("pagehide",this.Ii)}xi(){window.removeEventListener("pagehide",this.Ii)}ki(){window.addEventListener("blur",this.Ii)}$i(){window.removeEventListener("blur",this.Ii)}bi(t){return t instanceof NavigateEvent!=0&&!t.hashChange&&!t.downloadRequest&&!t.formData}}!function(t){t[t.Active=0]="Active",t[t.Paused=1]="Paused",t[t.Stopped=2]="Stopped"}(Cn||(Cn={}));class Bn{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.Li=t,this.Di=e,this.Ui=s,this.Fi=null,this.Bi=Cn.Active,this.qi=[]}reset(){this.Fi=null,this.qi=[],this.Bi=Cn.Active}disconnect(){this.Bi=Cn.Stopped}Hi(){this.Di(Cn.Paused),this.Bi=Cn.Paused,csSetTimeout((()=>{this.Bi===Cn.Paused&&this.zi()}),Bn.STOP_TIMEOUT)}ji(){this.Di(Cn.Active),this.Bi=Cn.Active,Dt(this.qi,this.Li),this.qi=[]}zi(){this.qi=[],this.Di(Cn.Stopped),this.Bi=Cn.Stopped}pushEvent(t,e){if(e.isUserEvent&&(this.Fi=t.date,this.Bi!==Cn.Active))return this.ji(),void this.Li(t);if(this.Gi(t))this.Li(t);else switch(this.Bi){case Cn.Active:if(this.Zi(t,e))return this.Hi(),void csArray.prototype.push.call(this.qi,t);this.Li(t);break;case Cn.Paused:csArray.prototype.push.call(this.qi,t);case Cn.Stopped:}}Zi(t,e){return!e.isUserEvent&&null!==this.Fi&&t.date-this.Fi>Bn.INACTIVITY_TIMEOUT}Gi(t){return csArray.prototype.indexOf.call(this.Ui,t.type)>-1}}Bn.INACTIVITY_TIMEOUT=5e3,Bn.STOP_TIMEOUT=5e3;class Hn extends ni{constructor(t,e,s,i,n,r,o,a,c,h,l,d,u,p){let g=arguments.length>14&&void 0!==arguments[14]?arguments[14]:[],m=arguments.length>15?arguments[15]:void 0,y=arguments.length>16?arguments[16]:void 0,f=arguments.length>17?arguments[17]:void 0,v=arguments.length>18?arguments[18]:void 0,E=arguments.length>19?arguments[19]:void 0;super(),this.wt=t,this.Wi=e,this.Qi=s,this.Ji=i,this.Ki=n,this.Vt=r,this.Yi=o,this.Xi=a,this.tn=c,this.en=h,this.nn=l,this.rn=d,this.hn=u,this.cn=p,this.an=g,this.un=m,this.ln=y,this.dn=f,this.fn=v,this.vn=E,this.mn=0,this.wn=new ii,this.gn={allowFromQuotaService:!0,allowFromSerialization:!0},this.yn=Ls((()=>{this.Wi.eventsCount()>0&&this.En()}),2e3),this.An=t=>this.processBrowserEvent(t),this._n=t=>this.Rn(t),this.Sn=0,this.Tn=0,this.In=new Vn,this.Pn=!1,this.bn=51200,this.Vn=!1,this.Cn=!1,this.kn=[],this.On=new Bn((t=>this.Nn(t)),(t=>{switch(t){case Cn.Active:this.xn();break;case Cn.Stopped:this.$n()}}),[Ds.RESOURCE_HASHES,Ds.TEXT_VISIBILITY]),this.Mn=t=>{this.rn.removeBatchInProgress(`${t.params.sn}.${t.params.pn}.${t.params.ri}`)}}init(){this.Ln(),this.nn.onLoad(this.Mn),this.nn.onError(this.Mn)}xn(){csArray.prototype.forEach.call(this.un,(t=>t.start()))}$n(){csArray.prototype.forEach.call(this.un,(t=>t.stopForInactivity()))}Ln(){var t,e,s;this.cn.onEvent(this.An,this._n),null===(t=this.en)||void 0===t||t.onInputNodeToEncrypt(this._n),null===(e=this.en)||void 0===e||e.onApiErrorToEncrypt((t=>{this.Dn(t)})),null===(s=this.en)||void 0===s||s.onUserIdentifierToEncrypt(this.An),this.In.onEvent((t=>{if(csSetTimeout((()=>this.Un("page-state",t))),t!==Tn.Visible){if(t===Tn.Blur)return this.Fn();if(!this.Pn)return this.Pn=!0,csSetTimeout((()=>{this.Pn=!1})),t===Tn.Hidden?this.Fn():this.Bn()}}))}isRecording(){return this.Vt.hasValidSession()&&this.isStarted}Fn(){if(!this.canSendEvents())return;this.cn.flush(),this.rn.saveBatchesInProgress(),Dt(this.an,(t=>{var e,s;return Dt(null!==(s=null===(e=t.getPendingEvents)||void 0===e?void 0:e.call(t))&&void 0!==s?s:[],(t=>this.Wi.addEvent(t)))}));const e=this.Wi.getEvents();if(0===e.length)return;this.Un("pending-events",this.cn.pendingEvents);const s=this.nn.getQueryParams();s.rst=this.getRecordingStartTimestamp(),s.let=this.getRecordingLastEventTimestamp();const i=this.Ji.getCurrentIndex();s.ri=i.toString(),this.hn.removeQueryParams(),this.hn.setQueryParams(s),this.Tn=e[e.length-1].date;const n=this.Wi.stringifyEvents();if(n.length>this.bn){const e=this.qn();if(e.length>0){const i=Kt(e);this.hn.send(i)||this.rn.save({key:`${s.sn}.${s.pn}.${s.ri}.last`,metadata:t._objectSpread2(t._objectSpread2({},s),{},{datatype:"json"}),events:i}),this.Ji.increment()}if(this.Wi.eventsCount()>0){s.ri=this.Ji.getCurrentIndex().toString();const e=this.Wi.stringifyEvents();this.rn.save({key:`${s.sn}.${s.pn}.${s.ri}.last`,metadata:t._objectSpread2(t._objectSpread2({},s),{},{datatype:"json"}),events:e}),this.Ji.increment()}}else this.hn.send(n)||this.rn.save({key:`${s.sn}.${s.pn}.${s.ri}.last`,metadata:t._objectSpread2(t._objectSpread2({},s),{},{datatype:"json"}),events:n}),this.Ji.increment();this.hn.removeQueryParams(),this.Wi.clearEvents()}Bn(){if(!this.canSendEvents())return;this.cn.flush();const e=this.nn.getQueryParams();this.rn.saveBatchesInProgress(),e.rst=this.getRecordingStartTimestamp(),delete e.ri,e.hlm="true",this.hn.removeQueryParams(),Dt(this.an,(t=>{var e,s;return Dt(null!==(s=null===(e=t.getPendingEvents)||void 0===e?void 0:e.call(t))&&void 0!==s?s:[],(t=>this.Wi.addEvent(t)))}));const s=this.Wi.getEvents();if(0===s.length)return delete e.let,delete e.rst,this.hn.setQueryParams(e),this.hn.send(),void this.hn.removeQueryParams();this.Un("pending-events",this.cn.pendingEvents),this.Tn=s[s.length-1].date,e.let=this.getRecordingLastEventTimestamp(),this.hn.setQueryParams(e);const i=this.Wi.stringifyEvents();if(i.length>this.bn){const s=this.qn();if(s.length>0){const i=Kt(s);this.hn.send(i)||this.rn.save({key:`${e.sn}.${e.pn}.last`,metadata:t._objectSpread2(t._objectSpread2({},e),{},{datatype:"json"}),events:i})}else delete e.let,delete e.rst,delete e.ri,this.hn.removeQueryParams(),this.hn.setQueryParams(e),this.hn.send(),this.hn.removeQueryParams();if(this.Wi.eventsCount()>0){e.rst=this.getRecordingStartTimestamp(),e.let=this.getRecordingLastEventTimestamp();const s=this.Ji.getCurrentIndex();e.ri=s.toString();const i=this.Wi.stringifyEvents();this.rn.save({key:`${e.sn}.${e.pn}.${e.ri}.last`,metadata:t._objectSpread2(t._objectSpread2({},e),{},{datatype:"json"}),events:i}),this.Ji.increment()}}else this.hn.send(i)||(this.rn.save({key:`${e.sn}.${e.pn}.${e.ri}.last`,metadata:t._objectSpread2(t._objectSpread2({},e),{},{datatype:"json"}),events:i}),this.Ji.increment());this.hn.removeQueryParams(),this.Wi.clearEvents()}blockSendingEventsFromQuotaService(){this.gn.allowFromQuotaService=!1}allowSendingEventsFromQuotaService(){this.gn.allowFromQuotaService=!0}blockSendingEventsFromSerialization(){this.gn.allowFromSerialization=!1}allowSendingEventsFromSerialization(){this.gn.allowFromSerialization=!0}canSendEvents(){return this.gn.allowFromQuotaService&&this.gn.allowFromSerialization}onIframeJavascriptError(t){var e;if(this.Yi&&this.fn){null===(e=this.Yi)||void 0===e||e.anonymize(t);const s=this.fn.translate({message:t.message,colno:t.colno,lineno:t.lineno,filename:t.filename,timestamp:Ie(),type:"JSError"});s&&this.An(s)}}onIframeCustomError(e){if(this.vn){const s=this.vn.translate(t._objectSpread2(t._objectSpread2({},e),{},{timestamp:Ie(),type:"CustomError"}));s&&this.An(s)}}onIframeDetailedApiError(t){this.Hn(t)}onIframeRecordingUserEvent(t){for(const e of t)this.Rn(e)}onIframeRecordingBrowserEvent(t){if(this.isStarted)for(const e of t)this.processBrowserEvent(e)}processBrowserEvent(t){this.Ki.isCurrentPageviewValid()&&this.On.pushEvent(t,{isUserEvent:!1})}Rn(t){this.Ki.refreshSession(),this.Ki.isSessionValid()&&this.On.pushEvent(t,{isUserEvent:!0})}Nn(t){pi.general.nbEvents.increase(),this.Wi.addEvent(t),this.Wi.isThresholdReached()?this.pushEvents():this.Wi.isFull()&&this.yn(),this.zn(t)}zn(e){this.wt.emitDebugEvents&&this.wn.emit("recordingEvent",t._objectSpread2(t._objectSpread2({},e),{},{typeName:Ds[e.type]}))}onStart(){var t;this.Un("tag-version","15.81.3"),this.Un("page-state",document.visibilityState),this.On.reset(),this.In.start(),this.initStates(),this.cn.start(),this.Xi&&this.tn&&this.Xi.subscribe(Hn.jn,(t=>this.Hn(t)),{detailedEvent:!0}),this.wt.emitDebugEvents&&this.wn.emit("replayRecordingStarted"),csArray.prototype.forEach.call(this.kn,(t=>this.Gn(t))),this.kn=[],this.Vn&&(null===(t=this.ln)||void 0===t||t.enableOnlineAssets(),this.Vn=!1)}onStop(){var t;this.In.stop(),this.Xi&&this.Xi.unsubscribe(Hn.jn),this.cn.stop(),this.On.disconnect(),null===(t=this.ln)||void 0===t||t.disableOnlineAssets()}clearStates(){this.cn.flush(),this.yn.cancel(),this.pushEvents(),this.nn.removeQueryParams()}initStates(){this.Sn=Ie(),this.Ji.reset(),this.mn=0,this.nn.setQueryParams(this.Qi.getRequestParameters())}pushEvents(){Dt(this.an,(t=>{var e;return null===(e=t.flushEvents)||void 0===e?void 0:e.call(t)})),this.Wi.eventsCount()>0&&(this.isStarted?this.En():this.Wi.clearEvents())}En(){if(!this.canSendEvents())return;const t=this.Wi.getEvents();this.Tn=t[t.length-1].date;const e=this.Ji.getCurrentIndex();this.nn.setQueryParams({ri:e.toString(),rst:this.getRecordingStartTimestamp(),let:this.getRecordingLastEventTimestamp()});const s=this.nn.getQueryParams();this.rn.addBatchInProgress(`${s.sn}.${s.pn}.${e}`,this.nn.getQueryParams(),t),this.nn.send(t),this.Ji.increment(),this.Wi.clearEvents(),this.Zn&&this.Zn()}addInitialDom(t){this.Wi.addEventByTimestamp(t),this.zn(t)}Hn(t){if(this.dn&&(t.plainCustomRequestHeaders||t.plainCustomResponseHeaders||t.requestBodyAttributes||t.responseBodyAttributes||t.customRequestHeaders||t.customResponseHeaders||t.queryParameters||t.requestBody||t.responseBody)){if(this.dn.truncate(t),this.en)return void this.en.registerApiErrorToEncrypt(t);t.customRequestHeaders="",t.customResponseHeaders="",t.requestBodyAttributes="",t.responseBodyAttributes="",t.queryParameters="",t.requestBody="",t.responseBody=""}this.Dn(t)}Dn(t){if(this.mn<Hn.Wn){const e={type:Ds.API_ERROR,date:Ie(),args:[this.tn.anonymize(t)]};this.An(e),this.mn=this.mn+1}}Qn(t){t===vi.ETR_SESSION?this.nn.setQueryParams({[Hn.Jn]:Hn.Kn}):t===vi.ETR_PAGE&&this.nn.setQueryParams({[Hn.Yn]:Hn.Kn})}clearEvents(){this.Wi.clearEvents()}onCustomJavaScriptErrorEvent(t){var e;const s=null===(e=this.fn)||void 0===e?void 0:e.translate({type:"JSError",timestamp:Ie(),message:t.message,colno:t.colno,lineno:t.lineno,filename:t.filename});s&&this.An(s)}onCustomErrorEvent(t){var e;const s=null===(e=this.vn)||void 0===e?void 0:e.translate({type:"CustomError",timestamp:Ie(),message:t.message,attributes:t.attributes});s&&this.An(s)}onPageEvent(t){this.Xn(t)}onUserIdentifierEvent(t){var e;const s={userIdentifier:t,date:Ie(),keyId:this.wt.encryptionPublicKeyId};null===(e=this.en)||void 0===e||e.registerUserIdentifierToEncrypt(s)}onEventTriggerRecording(t,e){this.isStarted?this.Gn({eventName:t,eventType:e}):csArray.prototype.push.call(this.kn,{eventName:t,eventType:e})}Gn(t){this.Qn(t.eventType),this.Xn(t.eventName),this.pushEvents()}Xn(t){const e={type:Ds.PAGE_EVENT,date:Ie(),args:[{eventName:csString.prototype.slice.call(t,0,Hn.tr)}]};this.Wi.addEvent(e)}triggerUnanonymizationConsentGranted(){const t={date:Ie(),type:Ds.UNANONYMIZED_CONSENT_GRANTED};this.Wi.addEvent(t)}triggerUnanonymizationConsentWithdrawn(){const t={date:Ie(),type:Ds.UNANONYMIZED_CONSENT_WITHDRAWN};this.Wi.addEvent(t)}triggerRecordingForSessionGranted(){this.Un("consent-granted")}triggerRecordingForSessionWithdrawn(){this.Un("consent-withdrawn")}activateOnlineAssetsOnNextPageview(){this.Cn=!0}getStaticResourceManagerStatus(){return this.ln?{isStarted:this.wt.useStaticResourceManager&&Un.isSupported(),onlineAssets:{activated:this.ln.isOnlineAssetsActivated(),enabledOnNextPageview:this.Cn}}:null}resetOnlineAssetsOnPageview(){this.Vn=!1,this.Cn=!1}updateOnlineAssetsOnPageview(){this.ln&&this.Cn&&(this.Vn=!0,this.Cn=!1)}onRecordingRequestSent(t){this.Zn=t}getRecordingStartTimestamp(){return this.Sn.toString()}getRecordingLastEventTimestamp(){return this.Tn.toString()}onOptOut(){Dt(this.an,(t=>{var e;return null===(e=t.releaseResources)||void 0===e?void 0:e.call(t)}))}Un(t,e){if(!this.wt.emitRecordInfoEvents)return;const s={date:Ie(),type:Ds.RECORDING_INFO_EVENT,args:null==e?[t]:[t,e]};this.Wi.addEvent(s)}qn(){return this.Wi.extractEvents(Ds.API_ERROR,Ds.JAVASCRIPT_ERROR,Ds.CUSTOM_ERROR,Ds.TEXT_VISIBILITY,Ds.POINTER_DOWN)}}Hn.jn="RecordingService",Hn.tr=255,Hn.Wn=20,Hn.Yn="etrp",Hn.Jn="etrs",Hn.Kn="1",as([Nt("addInitialDom")],Hn.prototype,"addInitialDom",null);class $n extends ni{constructor(t,e,s){super(),this.Is=t,this.hn=e,this.nn=s,this.er=!1,this.ir={},this.nr=t=>{if(0!==t.length)for(const e of t){const{metadata:t,events:s}=e;this.rr(t.rt)&&this.nn.send(s,t)}},window.addEventListener("focus",(()=>{this.recover()}))}onStart(){this.ir={}}onStop(){}recover(){this.Is.recover(this.nr)}addBatchInProgress(e,s,i){this.ir[e]={metadata:t._objectSpread2({},s),events:i}}removeBatchInProgress(t){delete this.ir[t]}blockSendingLastMessage(){this.er=!1}allowSendingLastMessage(){this.er=!0}sendLastMessageBeacon(){if(this.er){const e=this.nn.getQueryParams(),i=t._objectWithoutProperties(e,s);i.hlm="true",this.hn.setQueryParams(i),this.hn.send()}}rr(t){return!!t&&-1===csString.prototype.indexOf.call(t,yi.RECORDING_TEMPORARILY)}saveBatchesInProgress(){csArray.prototype.forEach.call(Object.keys(this.ir),(e=>{const{metadata:s,events:i}=this.ir[e];this.Is.save({key:`${s.sn}.${s.pn}.${s.ri}`,metadata:t._objectSpread2(t._objectSpread2({},s),{},{datatype:"json"}),events:csJSON.stringify(i)})}))}save(t){this.Is.save(t)}}as([yt("RecordingRecovery")],$n.prototype,"recover",null);class qn{constructor(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.hr=e}addProvider(t){csArray.prototype.push.call(this.hr,t)}getRequestParameters(){return csArray.prototype.reduce.call(this.hr,((e,s)=>t._objectSpread2(t._objectSpread2({},s.getRequestParameters()),e)),{})}}class zn{constructor(t,e){this.cr=t,this.gt=e,this.ar=[{boundElement:window,type:"hashchange",listener:()=>this.hashChangeListener()},{boundElement:document,type:"visibilitychange",listener:()=>this.visibilityChangeListener()}]}onEvent(t){this.ur=t}start(){this.ee(),this.triggerInitialEvents()}stop(){this.ie()}ee(){csArray.prototype.forEach.call(this.ar,(t=>Os(t)))}ie(){csArray.prototype.forEach.call(this.ar,(t=>Ps(t)))}triggerInitialEvents(){this.hashChangeListener()}hashChangeListener(){const t={type:Ds.HASH_CHANGE,args:[this.gt.anonymizePII(this.cr.href)],date:Ie()};this.ur(t)}visibilityChangeListener(){const t={type:Ds.VISIBILITY_CHANGE,args:[document.visibilityState],date:Ie()};this.ur(t)}}as([yt("hashChange")],zn.prototype,"hashChangeListener",null),as([yt("visibilityChange")],zn.prototype,"visibilityChangeListener",null);class Fn{constructor(){}onScannedAsset(t){this.lr=t}scanCssString(t){this.pr(_i(t))}scanElement(t,e){Ks.getMaskedElementDetails(t).state!==Ks.MaskedElementState.NotMasked||e&&Ks.isMaskedAttribute(t,e)||(P(t)?this.vr(t):O(t)?this.mr(t,e):(this.wr(t,e),this.gr(t,e),this.yr(t,e)))}mr(t,e){var s;if((!e||"href"===e)&&t.href){const e={assetId:(null===(s=t.sheet)||void 0===s?void 0:s.href)||t.href,assetBasePath:window.location.href,assetRawPath:t.getAttribute("href")};this.lr({type:"stylesheet",asset:e})}}vr(t){var e;const s=new Set;if(t.textContent)for(const e of _i(t.textContent))s.add(e);let i;try{i=null===(e=t.sheet)||void 0===e?void 0:e.cssRules}catch(t){"SecurityError"===t.name||"InvalidAccessError"===t.name||ns.error(t.message)}if(i)for(let t=0;t<i.length;t++){const e=i.item(t).cssText;for(const t of _i(e))s.add(t)}this.pr(Ht(s))}Er(t){return!this.Ar(t)&&!wi(t)&&!Ri(t)}wr(t,e){if(C(s=t)&&"img"===s.localName||function(t){return C(t)&&"source"===t.localName}(t)){if(!e||"src"===e){const e=t.getAttribute("src");if(e&&this.Er(e)){const s={assetId:t.src,assetRawPath:e,assetBasePath:window.location.href};this.lr({type:"asset",asset:s})}}e&&"srcset"!==e||!t.srcset||this._r(t.srcset)}var s}gr(t,e){if(1===t.nodeType){if(t.hasAttribute&&(!e||"style"===e)&&t.hasAttribute("style")){const e=t.getAttribute("style");if("string"!=typeof e)throw new Error("Unexpected style: "+t.outerHTML);this.scanCssString(e)}}else mt.warn(`StaticResourceUrlTracker: Wrong element nodeType: ${null==t?void 0:t.nodeName}/${t.nodeType}`)}_r(t){this.pr(bi(t))}yr(t,e){if((D(s=t)&&"image"===s.localName||function(t){return D(t)&&"use"===t.localName}(t)||function(t){return D(t)&&"feImage"===t.localName}(t))&&(!e||"href"===e||"xlink:href"===e)){const e=t.getAttribute("href")||t.getAttribute("xlink:href");if(e&&this.Er(e)){const t={assetId:Fe(e),assetRawPath:e,assetBasePath:window.location.href};this.lr({type:"asset",asset:t})}}var s}pr(t){return csArray.prototype.forEach.call(csArray.prototype.map.call(csArray.prototype.filter.call(t,(t=>this.Er(t))),(t=>({rawUrl:t,absoluteUrl:Fe(t)}))),(t=>{const e={assetId:t.absoluteUrl,assetBasePath:window.location.href,assetRawPath:t.rawUrl};this.lr({type:"asset",asset:e})}))}Ar(t){return/^https:\/\/\w+:\w+@/.test(t)}}class jn{constructor(t){this.Qs=t}observe(){this.Rr=_n.Sr.subscribe((t=>this.Qs(t))),_n.Tr||(_n.Tr=!0,_n.Ir.observe(),lt(document,NodeFilter.SHOW_ELEMENT).visitAll((t=>{_n.Pr.add(t),_n.Sr.next(t)})))}disconnect(){_n.Tr&&(this.Rr(),_n.Sr.hasObservers()||(_n.Tr=!1,_n.Ir.disconnect(),_n.Sr.clear(),_n.Pr.clear()))}}_n=jn,jn.Pr=Fi(),jn.Sr=new class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;this.br=[],this.qi=[],this.Vr=t}next(t){this.qi.length===this.Vr&&csArray.prototype.shift.call(this.qi),csArray.prototype.push.call(this.qi,t),1===this.qi.length&&csSetTimeout((()=>this.clear()));for(const e of this.br)e(t)}subscribe(t){if(xt(this.br,(e=>t===e)))return()=>{this.br=csArray.prototype.filter.call(this.br,(e=>e!==t))};csArray.prototype.push.call(this.br,t);for(const e of this.qi)t(e);return()=>{this.br=csArray.prototype.filter.call(this.br,(e=>e!==t))}}clear(){this.qi=[]}hasObservers(){return this.br.length>0}},jn.Cr=_t((t=>{$i((()=>{for(const e of t)"childList"===e.type&&Dt(e.addedNodes,(t=>{lt(t,NodeFilter.SHOW_ELEMENT).visitAll((t=>{_n.Pr.has(t)||(_n.Pr.add(t),_n.Sr.next(t))}))}))}))}),"ElementObserver.findAllElements"),jn.Tr=!1,jn.Ir=new rn(_n.Cr),ae([yt()],jn.prototype,"observe",null),ae([yt()],jn.prototype,"disconnect",null);class Gn{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.kr=t,this.Or=e,this.Nr=s,this.$r=new vt,this.kt=!1,this.Mr=0,this.Lr=()=>{for(this.Mr=0;this.$r.length;){if(this.Mr>=this.Or)return void csSetTimeout(this.Lr,this.Nr);const t=Oe(),e=this.$r.pop();if(!e)break;this.runTask(e);const s=Oe()-t;this.Mr+=s}this.kt=!1}}schedule(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.kr&&!e?(pi.general.pendingTasks.increase(),this.$r.push(t),this.Dr()):t()}Dr(){this.kt||(this.kt=!0,csSetTimeout((()=>{this.Lr()})))}runTask(t){pi.general.pendingTasks.decrease(),t()}runPendingTasks(){this.$r.forEach((t=>{this.runTask(t)})),this.$r.clear()}clearQueue(){pi.general.pendingTasks.clear(),pi.mutations.pendingMutations.clear(),this.$r.clear()}isEmpty(){return 0===this.$r.length}}as([yt("TaskScheduler"),Nt("runTask")],Gn.prototype,"runTask",null),as([Nt("runPendingTasks")],Gn.prototype,"runPendingTasks",null);class Wn{constructor(){this.zs=!1,this.Ur=new Wi((t=>"cssRuleInserted"===t.type&&this.Fr(t))),this.Br=ji((t=>{this.zs&&t.length>0&&this.qr.schedule((()=>Dt(t,(t=>this.Hr.scanElement(t)))))})),this.zr=t=>{let{type:e,asset:s}=t;var i,n,r;"stylesheet"===e&&(null===(i=this.jr)||void 0===i||i.call(this,s)),null===(n=this.Gr)||void 0===n||n.call(this,s);const o={date:Ie(),type:Ds.STATIC_RESOURCE_URL,args:[s.assetId]};null===(r=this.ur)||void 0===r||r.call(this,o)},this.qr=new Gn(!0,30,0),this.Zr=new jn((t=>this.Wr(t))),this.Fs=new rn((t=>this.Qr(t))),this.Hr=new Fn,this.Hr.onScannedAsset(this.zr)}onEvent(t){this.ur=t}onAsset(t){this.Gr=t}onStyleSheetFound(t){this.jr=t}start(){this.zs||(this.zs=!0,this.Ur.observe(),this.Zr.observe(),this.Fs.observe())}stop(){this.zs&&(this.Ur.disconnect(),this.Zr.disconnect(),this.Fs.disconnect(),this.zs=!1)}Fr(t){t.rule&&this.zs&&this.Hr.scanCssString(t.rule)}Wr(t){this.zs&&Ks.getMaskedElementDetails(t).state===Ks.MaskedElementState.NotMasked&&this.Br.push(t)}Qr(t){csSetTimeout((()=>{for(const e of t)switch(e.type){case"attributes":this.Hr.scanElement(e.target,e.attributeName);break;case"characterData":this.Jr(e.target)}}))}Jr(t){_(t)&&csNodeparentNode.apply(t)&&P(csNodeparentNode.apply(t))&&this.Hr.scanCssString(t.data)}}class Yn{constructor(t){this.Kr=[],this.Yr=[],this.gs={},this.ys=t}setQueryParams(t){csArray.prototype.forEach.call(Object.keys(t),(e=>{this.gs[e]=t[e]}))}removeQueryParams(t){t?csArray.prototype.forEach.call(t,(t=>{delete this.gs[t]})):this.gs={}}onBeaconSuccess(t){csArray.prototype.push.call(this.Kr,t)}onBeaconFailure(t){csArray.prototype.push.call(this.Yr,t)}send(e){const s=ie.toQuery(t._objectSpread2(t._objectSpread2({},this.gs),{},{ct:vs.UNCOMPRESSED})),i=this.Xr(s,e);return i?csArray.prototype.forEach.call(this.Kr,(t=>t())):csArray.prototype.forEach.call(this.Yr,(t=>t(this.gs))),i}Xr(t,e){try{if("function"!=typeof csNavigatorsendBeacon)return!1;const s=csNavigatorsendBeacon(`${this.ys}?${t}`,e||"");if(s)return s}catch(t){}return"function"==typeof navigator.sendBeacon&&navigator.sendBeacon(`${this.ys}?${t}`,e||"")}}class Qn{constructor(t){this.so={},this.eo=new ti(t)}save(t){let{key:e,metadata:s,events:i}=t;this.eo.isThresholdReached()||(this.eo.addString(e),"string"==typeof i?this.eo.addString(i):this.eo.addArrayBuffer(i),this.eo.isThresholdReached()||(this.so[e]={metadata:s,events:i}))}recover(t){const e=[];csArray.prototype.forEach.call(this.io(),(t=>{const s=this.so[t];void 0!==s&&(delete s.metadata.datatype,csArray.prototype.push.call(e,s),this.no(t))})),0!==e.length&&(t(e),this.eo.reset())}io(){return Object.keys(this.so)}no(t){delete this.so[t]}}!function(t){t[t.NOT_STARTED=0]="NOT_STARTED",t[t.OPEN_IN_PROGRESS=1]="OPEN_IN_PROGRESS",t[t.OPEN_FAILED=2]="OPEN_FAILED",t[t.READY=3]="READY"}(Nn||(Nn={}));class Zn{constructor(t,e,s){this.ro=t,this.oo=s,this.ho=Nn.NOT_STARTED,this.co=[],this.ao=0,this.uo=self.origin,this.lo="object"==typeof window?"":"worker-",this.eo=new ti(e),this.do()}async do(){await this.fo(),this.ho===Nn.READY?this.po():this.oo(this.co)}po(){csArray.prototype.forEach.call(this.co,(t=>{this.save(t)})),this.co=[]}async save(t){try{if(this.ho===Nn.OPEN_IN_PROGRESS)return void csArray.prototype.push.call(this.co,t);if(this.ho!==Nn.READY)return;if(this.eo.isThresholdReached())return;const{key:e,metadata:s,events:i}=t;if(this.eo.addString(e),"string"==typeof i?this.eo.addString(i):this.eo.addArrayBuffer(i),this.eo.isThresholdReached())return;await this.vo.put(`${this.uo}/${e}`,new Response(i,{headers:s}))}catch(t){}}async recover(t){(this.vo||(await this.fo(),this.ho===Nn.READY))&&this.mo(t)}async fo(){try{this.ho=Nn.OPEN_IN_PROGRESS,this.vo=await self.caches.open(`${this.lo}${this.ro}`),this.ho=Nn.READY}catch(t){this.ho=Nn.OPEN_FAILED}}async mo(t){try{if(this.ao++,this.ao>1)return;const e=await this.vo.keys();if(0===e.length)return;const s=await this.vo.matchAll(),i=csArray.prototype.map.call(s,(t=>{const e={};t.headers.forEach(((t,s)=>{e[s]=t})),delete e["content-type"];const s=e.datatype;return delete e.datatype,"json"===s||"base64"===s?t.text().then((t=>({metadata:e,events:t}))):t.arrayBuffer().then((t=>({metadata:e,events:t})))})),n=await Promise.all(i);await Promise.all(csArray.prototype.map.call(e,(t=>this.vo.delete(t)))),t(n),this.eo.reset()}catch(t){}finally{this.ao--}}}class Xn{constructor(t){try{this.wo(t)}catch(t){this.yo()}}wo(t){self.caches?this.Eo(t):this.yo()}save(t){this.Ao.save(t)}recover(t){this.Ao.recover(t)}Eo(t){this.Ao=new Zn(t,Xn._o,(t=>{this.yo(t)}))}yo(t){this.Ao=new Qn(Xn._o),t&&csArray.prototype.forEach.call(t,(t=>{this.Ao.save(t)}))}}Xn._o=16777216;class Kn extends On{isListening(t){return An.isDOMEvent(t)&&("initialDOM"===t.domEvent||"nodesAdded"===t.domEvent)}processEvent(t){let e=0;const s="initialDOM"===t.domEvent?[t.initialDOM]:t.nodes;for(const i of s){if(i instanceof Mi){const t=Ks.getMaskedAttributeDetails(i);i.attributes=this.Ro(i,t)}if(Ks.getMaskedElementDetails(i).state!==Ks.MaskedElementState.Child)js.traverse(i,(t=>{if(t instanceof Mi){const s=Ks.getMaskedAttributeDetails(t);t.attributes=this.Ro(t,s);const i=Ks.getMaskedElementDetails(t);i.state===Ks.MaskedElementState.Parent&&(this.So(t,i),e++)}}));else{if("initialDOM"===t.domEvent)return null;t.nodes=csArray.prototype.filter.call(t.nodes,(t=>t!==i))}}return e>0&&le.counters.sensitiveElements.count("masked-elements",e),t}Ro(t,e){return 0===e.attributes.length?t.attributes:csArray.prototype.filter.call(t.attributes,(t=>-1===csArray.prototype.indexOf.call(e.attributes,t.name)))}So(t,e){const s=`width: ${e.width}px !important; height: ${e.height}px !important;`;t.children=[],t.shadowRoot=void 0,csArray.prototype.push.call(t.attributes,{name:"style",value:s,namespaceURI:""}),Mi.getAttribute(t,"data-cs-mask")||csArray.prototype.push.call(t.attributes,{name:"data-cs-mask",value:"",namespaceURI:""})}}Si([Nt("MaskedElementProcessor.processEvent")],Kn.prototype,"processEvent",null),function(t){t.ANONYMIZED_TEXT_STATUS_PROP="anonymizationStatus",t.WHITELISTED_STATUS="whitelisted",t.isWhitelistedElement=function(e){return js.getProperty(e,t.ANONYMIZED_TEXT_STATUS_PROP)===t.WHITELISTED_STATUS},t.whitelistElement=function(e){js.setProperty(e,t.ANONYMIZED_TEXT_STATUS_PROP,t.WHITELISTED_STATUS)},t.removeWhitelistElement=function(e){js.setProperty(e,t.ANONYMIZED_TEXT_STATUS_PROP,void 0)}}(In||(In={}));const Jn=/[\u4E00-\u9FFF]|[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]/g,tr=/[^ï½\s]/g;function er(t){const e=csString.prototype.replace.call(t,Jn,"ï½");return csString.prototype.replace.call(e,tr,"a")}const sr=["id","class","style","srcset","sizes","rel","type","width","height","media","align","dir","bgcolor","color","border","colspan","rowspan","cols","rows","size","start","slot","data-cs-override-id"],ir=t=>{const e=new Set(sr);return csArray.prototype.forEach.call(t,(t=>{e.add(t)})),e},nr=["svg","slot"],rr={href:new Set(["a"]),src:new Set(["iframe"])};class or{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.To=t,this.Io=e,this.gt=s,this.Po=i,this.bo=n,this.Vo=ir(this.Io)}Co(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=this.gt.checkAndAnonymizePII(t,e);if(this.bo)for(const t of this.gt.getLogs())s?(le.counters.redactedPII.count("cc-in-text-nodes"),mt.implementation(`${t} - text-node`)):mt.implementation(`${t} - attribute`);return i}sanitize(t){return js.traverse(t,((t,e)=>{if(t.anonymized=this.To,3===t.nodeType){const{anonymizedValue:s,withAnonymization:i}=this.getAnonymizedValue(t.data,null==e?void 0:e.localName,e?js.getProperties(e):void 0);return t.anonymized=i,void(t.data=s)}if(Mi.isElement(t))return this.ko(t);4!==t.nodeType||(t.data=this.To?er(t.data):this.Co(t.data,this.Po))})),t}setAnonymization(t){this.To=t}getAnonymizedValue(t,e,s){if("style"===e)return{anonymizedValue:t,withAnonymization:!1};const i=(null==s?void 0:s[In.ANONYMIZED_TEXT_STATUS_PROP])===In.WHITELISTED_STATUS;return this.To&&!i?{anonymizedValue:er(t),withAnonymization:!0}:{anonymizedValue:this.Co(t,this.Po),withAnonymization:!1}}ko(t){if(js.getProperty(t,"SVG"))return;const e=xt(t.attributes,(t=>"type"===t.name)),s=null==e?void 0:e.value;t.attributes=csArray.prototype.map.call(t.attributes,(e=>(e.anonymized=this.To,e.value=this.getAnonymizedAttributeValue(t.localName,e.name,e.value,s),e)))}getAnonymizedAttributeValue(t,e,s,i){return this.Oo(t,e,i)?s:(t=>rr.hasOwnProperty(t))(e)?((t,e,s)=>{var i;return(null===(i=rr[e])||void 0===i?void 0:i.has(t))&&!wi(s)})(t,e,s)?this.gt.anonymizePII(s):s:this.To&&((t,e,s)=>("submit"===s||"button"===s)&&"input"===t&&"value"===e)(t,e,i)?er(s):("contenteditable"===e&&"false"!==s&&mt.implementation("Element found with contenteditable attr","contenteditable-attr"),this.To?"":this.Co(s,null,!1))}Oo(t,e,s){return((t,e,s)=>"radio"===s&&"input"===t&&"name"===e||csArray.prototype.indexOf.call(nr,t)>-1)(t,e,s)||this.Vo.has(e)}}class ar{static create(t,e){if(!ar.isSupported())throw new Error("IntersectionObserver is not supported");if(e&&e.delay&&e.delay<100)throw new Error("Visibility delay should be > 100ms");return(null==e?void 0:e.trackVisibility)&&(t=ar.xo(t)),new IntersectionObserver(t,e)}static isSupported(){return!!window.IntersectionObserver&&!!window.IntersectionObserverEntry}static xo(t){return(e,s)=>t(Lt(e,cr),s)}}function cr(t){return t.isVisible||!qt.isVisibleInViewportInForeground(t.target)?t:{boundingClientRect:t.boundingClientRect,intersectionRatio:t.intersectionRatio,intersectionRect:t.intersectionRect,isIntersecting:t.isIntersecting,rootBounds:t.rootBounds,target:t.target,time:t.time,isVisible:!0}}var hr;const lr=()=>(t,e,s)=>{s.value=function(t){const e=csSymbol("oncePerTickSymbol");let s=null;const i={},n=function(){const n=null!=this?this:i;s=arguments,n[e]||(n[e]=!0,dr((()=>{n[e]=!1,t.apply(n,s)})))};return n.oncePerTickSymbol=e,n}(s.value)},dr=null!==(hr=a.csQueueMicrotask)&&void 0!==hr?hr:csSetTimeout;lr.isScheduled=(t,e)=>t[e.oncePerTickSymbol];class ur{constructor(t){this.Qs=t,this.$o=new Map,this.Mo=t=>{const e=t.target;if(this.$o.has(e))return!0;let s=!1;return this.$o.forEach(((t,i)=>{!s&&this.$o.get(i).subtree&&(s=i.contains(e))})),s},pi.general.nbOfMutationObservers.increase(),this.Fs=new csMutationObserver((e=>{lr.isScheduled(this,this.garbageCollect)&&(e=Vt(e,this.Mo)),e.length&&$i((()=>t(e,this)))}))}disconnect(){pi.general.nbOfMutationObservers.decrease(),this.Fs.disconnect(),this.$o=new Map}takeRecords(){return this.Fs.takeRecords()}observe(t,e){return pi.mutations.elementMutationObserved.increase(),this.$o.set(t,e),this.Fs.observe(t,e)}unobserve(t){this.$o.has(t)&&(pi.mutations.elementMutationObserved.decrease(),this.$o.delete(t),this.garbageCollect())}garbageCollect(){pi.mutations.unobserveGarbageCollection.measure((()=>{const t=Vt(this.takeRecords(),this.Mo);t.length&&this.Qs(t,this),this.Fs.disconnect(),this.$o.forEach(((t,e)=>this.Fs.observe(e,t)))}))}}ae([lr()],ur.prototype,"garbageCollect",null);class pr{constructor(t){this.Qs=t,this.Lo=new Set}onMutations(t){if(Ut(t,(t=>{var e;return!!(null===(e=t.removedNodes)||void 0===e?void 0:e.length)})))for(const t of this.Lo.values())qt.isConnected(t)||(this.Lo.delete(t),this.Qs(t))}observe(t){this.Qe||(this.Qe=new rn((t=>csSetTimeout((()=>this.onMutations(t))))),this.Qe.observe()),this.Lo.add(t)}disconnect(){var t;null===(t=this.Qe)||void 0===t||t.disconnect(),this.Lo.clear(),this.Qe=void 0}}ae([yt("NodeDisconnectedObserver.onMutations")],pr.prototype,"onMutations",null);class gr{constructor(e){this.Do=new Set,this.Uo=new pr((t=>this.Fo(t))),this.zs=!1,this.Bo=e?t._objectSpread2(t._objectSpread2({},yr),e):yr}stop(){var t,e;this.zs=!1,null===(t=this.qo)||void 0===t||t.disconnect(),null===(e=this.Fs)||void 0===e||e.disconnect()}start(t){if(this.zs)throw new Error("VisibilityObserver is already started");this.Qs=ft("VisibilityObserver:callback",((e,s)=>t(e,s))),this.qo=ar.create((t=>this.handleIntersection(t)),{root:null,rootMargin:"0px",threshold:.5,trackVisibility:!0,delay:300}),this.Fs=new ur((t=>csSetTimeout((()=>{Dt(t,(t=>this.Fo(t.target)))})))),this.do(),this.zs=!0}observe(t){if(!this.zs)throw new Error("Observer is stopped.");!1===this.Bo.reobserve&&t[this.Ho]||(pi.visibilityObserver.nbElements.increase(),t[this.Ho]=!0,this.watchIntersection(t))}do(){this.zo=csSymbol("isVisible"),this.Ho=csSymbol("ObservedElement"),this.jo=csSymbol("LinkedElement"),this.Go=csSymbol("Tracked")}Fo(t){this.Do.add(t);for(const e of this.Zo(t))this.Do.add(e);this.recheckCssVisibilityAll()}recheckCssVisibilityAll(){Dt(this.Do.keys(),(t=>{t.isConnected&&!qt.areAncestorsHiddenByCSS(t)&&t[this.Ho]&&this.watchIntersection(t)})),this.Do.clear()}watchIntersection(t){this.Fs.unobserve(t),this.qo.unobserve(t);const e=qt.getTopAncestorHiddenByCSS(t);e?(e!==t&&(this.Wo(e,t),this.watchMutation(e)),this.watchMutation(t)):this.qo.observe(t)}watchMutation(t){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&delete t[this.zo],this.qo.unobserve(t),this.Fs.observe(t,{attributeFilter:["style","class","hidden"]})}handleIntersection(t){for(const e of t){const t=e.target;if(!e.isVisible){qt.isVisibleInDocument(t)||this.Qo(t);continue}const s=this.Bo.allowSameMatch||!e.target[this.zo];e.target[this.zo]=!0,s&&!this.Bo.delay&&this.onVisibilityChanged(e.target,mr.VisibleInViewPort)}this.Bo.delay&&csSetTimeout((()=>{for(const e of t){const t=e.isIntersecting&&e.isVisible;e.target[this.zo]&&t&&this.onVisibilityChanged(e.target,mr.VisibleInViewPort)}}),this.Bo.delay)}Qo(t){pi.visibilityObserver.hiddenElements.increase();const e=qt.getTopElement(t);this.watchMutation(t),e&&(this.Uo.observe(e),this.Wo(e,t),this.watchMutation(e,!1))}Wo(t,e){var s;(t[this.jo]=null!==(s=t[this.jo])&&void 0!==s?s:new Set).add(e)}Zo(t){var e,s;const i=[];return Dt(null!==(s=null===(e=t[this.jo])||void 0===e?void 0:e.values())&&void 0!==s?s:[],(t=>csArray.prototype.push.call(i,t))),i}onVisibilityChanged(t,e){if(e===mr.VisibleInViewPort&&this.Bo.trackOnce){if(this.qo.unobserve(t),this.Fs.unobserve(t),t[this.Go])return;t[this.Go]=!0}this.Qs(t,e)}static isSupported(){return ar.isSupported()}}var mr;ae([yt()],gr.prototype,"observe",null),ae([Ms({wait:50}),yt(),Nt("recheckCssVisibilityAll")],gr.prototype,"recheckCssVisibilityAll",null),ae([yt()],gr.prototype,"watchIntersection",null),ae([yt()],gr.prototype,"watchMutation",null),ae([yt(),Nt("VisibilityObserver.handleIntersection")],gr.prototype,"handleIntersection",null),ae([yt()],gr.prototype,"onVisibilityChanged",null),function(t){t.VisibleInViewPort="VisibleInViewPort",t.HiddenByAnother="HiddenByAnother",t.Hidden="Hidden"}(mr||(mr={}));const yr={delay:1e3,trackOnce:!0,reobserve:!1};class fr{constructor(t){this.Qs=t,this.Pr=Fi(),this.Jo=t=>{$i((()=>{for(const e of t)"childList"===e.type&&Dt(e.addedNodes,(t=>{lt(t,NodeFilter.SHOW_TEXT).visitAll((t=>{this.Pr.has(t)||(this.Pr.add(t),this.Qs(t))}))}))}))},this.Ir=new rn(this.Jo)}observe(){this.Ir.observe(),lt(document,NodeFilter.SHOW_TEXT).visitAll((t=>{this.Pr.add(t),this.Qs(t)}))}disconnect(){this.Pr.clear(),this.Ir.disconnect()}}var vr,Er;!function(t){t.ENCRYPTED_NODE_PROP="toEncrypt",t.shouldEncrypt=function(e){return!0===js.getProperty(e,t.ENCRYPTED_NODE_PROP)},t.markEncryptedNode=function(e){js.setProperty(e,t.ENCRYPTED_NODE_PROP,!0)},t.unmarkEncryptedNode=function(e){js.setProperty(e,t.ENCRYPTED_NODE_PROP,void 0)}}(vr||(vr={})),Si([yt()],class extends Sn{constructor(t){super(),this.Ko=new Set,this.Yo=new Set,this.Xo=!1,this.th=new Set,this.To=!1,this.eh=new gr(t),this.ih=new fr((t=>{const e=qt.getParentElement(t);!e||!e.isConnected||Ks.isMaskedElement(e)||Ks.isMaskedElementChild(e)||vr.shouldEncrypt(e)||P(e)||M(e)||L(e)||T(t.data)||(this.Ko.add(e),this.nh())}))}onStart(){gr.isSupported()&&(this.eh.start(((t,e)=>this.onVisibilityChanged(t,e))),this.ih.observe())}onStop(){gr.isSupported()&&(this.eh.stop(),this.ih.disconnect(),this.Ko.clear(),this.Yo.clear(),this.th.clear(),this.Xo=!1)}setAnonymization(t){this.To=t}nh(){this.Xo||(this.Xo=!0,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;csSetTimeout(function(t){return function(){try{t.apply(window,arguments)}catch(t){mt.critical(t)}}}(t),e)}((()=>{if(!this.isStarted)return;this.Xo=!1;const t=this.Ko;this.Ko=new Set;for(const e of Ht(t))e.isConnected&&!this.Yo.has(e)&&(this.Yo.add(e),Ut(csNodechildNodes.apply(e),(t=>3===t.nodeType))&&this.eh.observe(e))}),1001))}onVisibilityChanged(t,e){e!==mr.VisibleInViewPort||this.To&&!In.isWhitelistedElement(t)||Dt(csNodechildNodes.apply(t),(t=>{if(3!==t.nodeType)return;const s=t.data;this.th.has(s)||(this.th.add(s),this.produceEvent({type:"TextVisibility",text:s,state:e}))}))}}.prototype,"onVisibilityChanged",null),function(t){t.isTextVisibilityEvent=function(t){return"TextVisibility"===t.type}}(Er||(Er={}));class Sr extends On{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.gt=s,this.Po=i,this.rh=new or(t,e,s,i,!0)}setAnonymization(t){this.rh.setAnonymization(t)}isListening(t){return Er.isTextVisibilityEvent(t)||An.isDOMEvent(t)&&("initialDOM"===t.domEvent||"nodesAdded"===t.domEvent||"attributeChanged"===t.domEvent||"characterDataChanged"===t.domEvent)}processEvent(t){if(Er.isTextVisibilityEvent(t))return t.text=this.gt.checkAndAnonymizePII(t.text,this.Po),t;switch(t.domEvent){case"initialDOM":case"nodesAdded":this.oh(t);break;case"attributeChanged":this.hh(t);break;case"characterDataChanged":this.ah(t)}return t}oh(t){const e="initialDOM"===t.domEvent?[t.initialDOM]:t.nodes;for(const t of e)this.rh.sanitize(t)}hh(t){t.isSvg||t.newValue&&(null!==t.localName?t.newValue=this.rh.getAnonymizedAttributeValue(t.localName,t.attribute,t.newValue,t.inputType):t.newValue="")}ah(t){t.newValue=this.rh.getAnonymizedValue(t.newValue,t.parentLocalName,t.parentProps).anonymizedValue}}Si([Nt("AnonymizedTextProcessor.processEvent")],Sr.prototype,"processEvent",null);class wr extends On{constructor(t){super(),this.uh=t}isListening(t){return An.isDOMEvent(t)&&"initialDOM"===t.domEvent}processEvent(t){return"initialDOM"===t.domEvent&&(t.initialDOM.baseURI=this.uh.anonymizeUrl(t.initialDOM.baseURI)),t}}Si([Nt("UrlAnonymizationProcessor.processEvent")],wr.prototype,"processEvent",null);const Rr="textarea";class Ar extends On{isListening(t){return An.isDOMEvent(t)&&("initialDOM"===t.domEvent||"nodesAdded"===t.domEvent||"characterDataChanged"===t.domEvent)}processEvent(t){switch(t.domEvent){case"initialDOM":this.fh(t);break;case"nodesAdded":this.ph(t);break;case"characterDataChanged":this.mh(t)}return t}fh(t){js.traverse(t.initialDOM,((t,e)=>{this.gh(t,e)&&(t.data=this.yh(t.data))}))}ph(t){for(const e of t.nodes)js.traverse(e,((e,s)=>{this.Eh(e,s,t)&&(e.data=this.yh(e.data))}))}mh(t){t.parentLocalName===Rr&&(t.newValue=this.yh(t.newValue))}yh(t){return csString.prototype.replace.call(t,/\S/g,"â€¢")}Eh(t,e,s){return this.Ah(t,s)||this.gh(t,e)}Ah(t,e){return 3===t.nodeType&&e.targetLocalName===Rr}gh(t,e){return 3===t.nodeType&&S(e)&&e.localName===Rr}}Si([Nt("AnonymizedTextAreaProcessor.processEvent")],Ar.prototype,"processEvent",null);class br{constructor(t){this.Qs=t,this._h={boundElement:window,type:"resize",listener:()=>this.resizeListener()},this.Qs=t}observe(){Os(this._h),this.ce()}ce(){this.resizeListener()}disconnect(){Ps(this._h)}resizeListener(){const t={width:Ot.windowWidth(),height:Ot.windowHeight()};this.Qs(t)}}var Tr,Cr,_r,Nr,Ir,Or,Pr;ae([yt("resize")],br.prototype,"resizeListener",null),function(t){t.PORTRAIT="Portrait",t.LANDSCAPE="Landscape"}(Tr||(Tr={})),function(t){t.PORTRAIT_PRIMARY="portrait-primary",t.PORTRAIT_SECONDARY="portrait-secondary",t.LANDSCAPE_PRIMARY="landscape-primary",t.LANDSCAPE_SECONDARY="landscape-secondary"}(Cr||(Cr={})),function(t){t[t.PORTRAIT=0]="PORTRAIT",t[t.PORTRAIT_REVERSE=180]="PORTRAIT_REVERSE",t[t.LANDSCAPE=-90]="LANDSCAPE",t[t.LANDSCAPE_REVERSE=90]="LANDSCAPE_REVERSE"}(_r||(_r={})),function(t){let e=null;t.isScreenOrientationApiSupported=()=>{var t;return null!=e?e:e=!!(null===(t=a.screen)||void 0===t?void 0:t.orientation)},t.isDeprecatedScreenOrientationApiSupported=()=>"orientation"in a,t.getCurrentOrientation=function(){return t.isScreenOrientationApiSupported()?function(){var t;switch(null===(t=a.screen.orientation)||void 0===t?void 0:t.type){case Cr.PORTRAIT_PRIMARY:case Cr.PORTRAIT_SECONDARY:return Tr.PORTRAIT;case Cr.LANDSCAPE_PRIMARY:case Cr.LANDSCAPE_SECONDARY:return Tr.LANDSCAPE;default:return Tr.PORTRAIT}}():t.isDeprecatedScreenOrientationApiSupported()?function(){switch(window.orientation){case _r.PORTRAIT:case _r.PORTRAIT_REVERSE:return Tr.PORTRAIT;case _r.LANDSCAPE:case _r.LANDSCAPE_REVERSE:return Tr.LANDSCAPE;default:return Tr.PORTRAIT}}():Tr.LANDSCAPE}}(Nr||(Nr={}));class kr extends Sn{constructor(){super(...arguments),this.Rh=null,this.Sh=null,this.Th=new br((e=>{this.produceEvent(t._objectSpread2(t._objectSpread2({},e),{},{type:"viewportResize"})),this.onScreenPotentiallyChanged()}))}onScreenPotentiallyChanged(){const t=Nr.getCurrentOrientation(),{screenWidth:e,screenHeight:s}=this.Ih(t);if(e!==this.Rh||s!==this.Sh){this.Rh=e,this.Sh=s;const t={type:"screenResize",width:e,height:s};this.produceEvent(t)}}Ih(t){let e,s;const i=Ot.screenWidth(),n=Ot.screenHeight();return t===Tr.PORTRAIT?(e=i,s=n):(e=Math.max(i,n),s=Math.min(i,n)),{screenWidth:e,screenHeight:s}}onStart(){this.Th.observe()}onStop(){this.Rh=null,this.Sh=null,this.Th.disconnect()}}class Lr{get selectors(){return""===this.Ph?null:this.Ph}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{closest:!1};this.Qs=t,this.Bo=e,this.Ph="",this.bh=Fi(),this.Qr=_t((t=>{if(""===this.Ph)return;const e=[];for(const s of Mt(t,(t=>t.addedNodes)))(U(s)||this.Bo.closest&&_(s))&&Bt(this.Bo.closest?this.Vh(s,this.Ph):this.findMatchingElements(s,this.Ph),e);e.length&&this.Qs(e,"added")}),"SelectorObserver.processMutations"),this.Ch=(t,e)=>{if(""===this.Ph||"added"!==e)return;const s=this.findMatchingElements(t,this.Ph);s.length&&this.Qs(s,"added")},this.Qe=new rn(this.Qr,this.Ch)}observe(t){""===this.Ph?this.Qe.observe():this.Ph+=",",this.Ph+=t;const e=this.findMatchingElements(document,t);for(const s of this.Qe.shadowRoots)Bt(this.findMatchingElements(s,t),e);e.length&&(Dt(e,(t=>{this.bh.add(t)})),this.Qs(e,"initial"))}processPendingMutations(){this.Qr(this.Qe.takeRecords())}disconnect(){this.Qe.disconnect(),this.bh.clear(),this.Ph=""}Vh(t,e){const s=[];if(_(t)){if(t.parentElement){const i=Xs(t.parentElement,e);i&&csArray.prototype.push.call(s,i)}return csArray.prototype.filter.call(s,(t=>!1===this.bh.has(t)))}if(A(t)){const i=Xs(t,e);if(i)return csArray.prototype.push.call(s,i),csArray.prototype.filter.call(s,(t=>!1===this.bh.has(t)))}return this.findMatchingElements(t,e)}findMatchingElements(t,e){const s=kt(window.csquerySelectorAll[t.nodeType].call(t,e));return C(t)&&Y.call(t,e)&&csArray.prototype.push.call(s,t),csArray.prototype.filter.call(s,(t=>!1===this.bh.has(t)))}}ae([yt()],Lr.prototype,"observe",null),ae([yt()],Lr.prototype,"disconnect",null),ae([Nt("SelectorObserver.findMatchingElements")],Lr.prototype,"findMatchingElements",null);class Mr extends Sn{constructor(){super(),this.kh=t=>{const e=function(t){const e=csEventtarget.apply(t);return e&&C(e)&&csElementshadowRoot.apply(e)&&t.composedPath?t.__csOriginalTarget||t.composedPath()[0]:e}(t);e&&this.Oh(e,t.type)},this.se=new Is(((t,e)=>{switch(e){case"initial":case"added":this.Nh(t);break;case"removed":this.xh(t)}})),this.$h=new Lr(((t,e)=>{"initial"!==e&&"added"!==e||this.Mh(t)}))}static shouldProcessElement(t){return"VIDEO"===t.tagName&&qt.isConnected(t)&&!Ks.isMaskedElement(t)&&!Ks.isMaskedElementChild(t)}static isPlaying(t){return!t.paused&&!t.ended}onStart(){this.Nh(document),this.se.observe(),this.$h.observe("video")}onStop(){this.xh(document),this.se.disconnect(),this.$h.disconnect()}Oh(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];if(this.isStarted&&Mr.shouldProcessElement(t))for(const e of s){const s={type:"VideoEvent",videoEventType:e,nodeId:Qs(t)};"seeked"===e&&(s.newTimePositionInSec=t.currentTime),xi((()=>this.produceEvent(s)))}}Mh(t){for(const e of t)this.Oh(e,"seeked"),Mr.isPlaying(e)&&this.Oh(e,"play")}Nh(t){for(const e of["play","pause","seeked"])Os({type:e,listener:this.kh,boundElement:t})}xh(t){for(const e of["play","pause","seeked"])Ps({type:e,listener:this.kh,boundElement:t})}}function Dr(t){return"INPUT"===t.nodeName}function xr(t){return Dr(t)&&"number"===t.type}function Ur(t){return Dr(t)&&("checkbox"===t.type||"radio"===t.type)}class Vr extends Sn{constructor(t){super(),this.en=t,this.Lh=Fi(),this.Dh=t=>this.inputHandler(t),this.Uh=[],this.Fh(),this.Bh(),this.$h=new Lr((t=>{for(const e of t)this.qh(e)&&$i((()=>{this.Hh(e,Qs(e))}),"low")})),this.se=new Is(((t,e)=>{switch(e){case"initial":case"added":Os({type:"change",listener:this.Dh,boundElement:t});break;case"removed":Ps({type:"change",boundElement:t,listener:this.Dh})}}))}onStart(){Os({type:"keyup",boundElement:document,listener:this.Dh}),Os({type:"change",boundElement:document,listener:this.Dh}),Dt(this.Uh,(t=>t.activate())),this.$h.observe(csArray.prototype.join.call(Vr.zh,",")),this.se.observe()}onStop(){Ps({type:"keyup",boundElement:document,listener:this.Dh}),Ps({type:"change",boundElement:document,listener:this.Dh}),Dt(this.Uh,(t=>t.deactivate())),this.$h.disconnect(),this.se.disconnect(),this.Lh.clear()}Hh(t,e){var s,i,n;if(this.Lh.has(t))return;if(this.Lh.add(t),function(t){return"SELECT"===t.nodeName}(t)){const e={type:"InputEvent",inputType:"select",target:Qs(t),selectedIndex:t.selectedIndex,timestamp:Ie()};return void this.produceEvent(e)}if(Ur(t)){const e={type:"InputEvent",inputType:"checkable",target:Qs(t),checked:t.checked,timestamp:Ie()};return void this.produceEvent(e)}const r=function(t){return"TEXTAREA"===t.nodeName||Dr(t)&&!xr(t)&&!Ur(t)}(t),o=xr(t);if(r||o){const r=null!==(s=t.value)&&void 0!==s?s:"";if(null===(i=this.en)||void 0===i?void 0:i.shouldEncrypt(t))return void(null===(n=this.en)||void 0===n||n.registerInputNodeToEncrypt({targetId:e,targetValue:r,date:Ie()}));const a=o?"0":"â€¢",c={type:"InputEvent",inputType:"text",target:Qs(t),value:csString.prototype.replace.call(r,/\S/g,a),timestamp:Ie()};this.produceEvent(c)}}inputHandler(t){if(!this.isStarted)return;const e=Hs(t),s=Qs(e);s&&this.qh(e)&&qt.isConnected(e)&&$i((()=>{this.Hh(e,s)}),"low")}Fh(){this.trackChanges(HTMLInputElement,"checked"),this.trackChanges(HTMLInputElement,"value"),this.trackChanges(HTMLTextAreaElement,"value")}Bh(){this.trackChanges(HTMLSelectElement,"selectedIndex"),this.trackChanges(HTMLSelectElement,"value"),this.trackChanges(HTMLOptionElement,"selected",!0)}trackChanges(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=_s(t.prototype,e,((t,e,i)=>{if(i!==e&&qt.isConnected(t)){const e=s?t.parentElement:t;this.jh(e)}}));i&&csArray.prototype.push.call(this.Uh,i)}qh(t){return!Ks.isMaskedElement(t)&&!Ks.isMaskedElementChild(t)&&(k(t)||x(t)||L(t))}jh(t){if(this.isStarted&&qt.isConnected(t)){const e=Qs(t);e&&this.qh(t)&&$i((()=>{this.Hh(t,e)}),"low")}}}Vr.zh=["textarea","input:not([type])",'input[type="text"]','input[type="email"]','input[type="search"]','input[type="tel"]','input[type="url"]','input[type="password"]','input[type="number"]','input[type="checkbox"]','input[type="radio"]',"select"],Si([os()],Vr.prototype,"inputHandler",null),Si([yt()],Vr.prototype,"trackChanges",null);class Br extends Sn{constructor(){super(),this.Gh="object"==typeof window.customElements&&"function"==typeof window.customElements.whenDefined&&"function"==typeof window.Promise,this.Zh=ft("CustomElementRegistrationProducer:onElementsFound",(t=>{for(const s of t)Ks.isMaskedElement(s)||Ks.isMaskedElementChild(s)||C(e=s)&&w(e.tagName)&&csString.prototype.indexOf.call(e.tagName,"-")>0&&-1===csString.prototype.indexOf.call(e.tagName,":")&&-1===csString.prototype.indexOf.call(e.tagName,'"')&&-1===csString.prototype.indexOf.call(e.tagName,",")&&csArray.prototype.indexOf.call($,csString.prototype.toLocaleLowerCase.call(e.tagName))<0&&this.register(csString.prototype.toLowerCase.call(s.tagName));var e}));const t=ji(this.Zh);this.Zr=new jn((e=>t.push(e))),this.Ko=new Set}onStart(){this.Gh&&this.Zr.observe()}onStop(){this.Ko.clear(),this.Zr.disconnect()}async register(t){this.Ko.has(t)||(this.Ko.add(t),await window.customElements.whenDefined(t),this.produceEvent({type:"CustomElementRegistration",tagName:csString.prototype.toLowerCase.call(t)}))}}Si([yt()],Br.prototype,"register",null);class Hr{static isNavigationTimingObserverSupported(){var t,e;return(null==(null===(t=window.PerformanceObserver)||void 0===t?void 0:t.supportedEntryTypes)?void 0:csArray.prototype.indexOf.call(null===(e=window.PerformanceObserver)||void 0===e?void 0:e.supportedEntryTypes,"navigation"))>=0}static getTimeOrigin(){return window.performance.timeOrigin}static Wh(){if(this.isNavigationTimingObserverSupported())return new window.PerformanceObserver((t=>Hr.Qh(t)))}static Qh(t){const e=t.getEntriesByType("navigation")[0];e&&(this.Jh=e,Hr.Kh(e))}static Us(t){this.Yh(t),this.Jh&&t(this.Jh),this.Xh||this.tc()}static Yh(t){this.sc.add(t)}static ec(t){this.sc.delete(t)}static tc(){if(this.nc||(this.nc=this.Wh()),!this.nc)return this.Jh||(this.Jh={requestStart:window.performance.timing.requestStart,domInteractive:window.performance.timing.domInteractive}),void this.Kh(this.Jh);this.nc.observe({type:"navigation",buffered:!0}),this.Xh=!0}static Kh(t){this.sc.forEach((e=>e(t)))}static Ws(t){this.ec(t),0===this.sc.size&&this.rc()}static rc(){var t;this.Xh&&(null===(t=this.nc)||void 0===t||t.disconnect(),this.Xh=!1,this.Jh=null,this.nc=this.Wh())}constructor(t){this.Qs=t}observe(){Hr.Us(this.Qs)}disconnect(){Hr.Ws(this.Qs)}}Hr.Xh=!1,Hr.sc=new Set,Hr.Jh=null;class $r extends Sn{constructor(){super(...arguments),this.oc=null,this.hc=new Hr((t=>{if(this.oc)return;const e=this.cc(t);e&&(this.oc=e,this.produceEvent(e))}))}onStart(){this.oc?this.produceEvent(this.oc):this.hc.observe()}onStop(){this.hc.disconnect()}cc(t){const e=Hr.getTimeOrigin();return{type:"PerformanceTiming",timings:{timeOrigin:e,requestStart:Math.floor(e+t.requestStart),domInteractive:Math.floor(e+t.domInteractive)},timestamp:Ie()}}}!function(t){t[t.TAP=0]="TAP",t[t.LONG_PRESS=1]="LONG_PRESS",t[t.DRAG=2]="DRAG",t[t.FLICK=3]="FLICK",t[t.PINCH_IN=4]="PINCH_IN",t[t.PINCH_OUT=5]="PINCH_OUT"}(Ir||(Ir={})),function(t){t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT"}(Or||(Or={}));class qr{compute(t,e){const s=this.ac(e.x)-this.ac(t.x),i=this.ac(e.y)-this.ac(t.y),n=e.time-t.time;return{duration:n,distance:this.lc(s,i),direction:this.fc(s,i),velocity:this.vc(s,i,n)}}computePinchMetrics(t,e){const s=this.ac(e.x)-this.ac(t.x),i=this.ac(e.y)-this.ac(t.y);return{duration:e.time-t.time,distance:this.lc(s,i)}}getScale(t,e){return Math.abs(e/t-1)}ac(t){return t/window.devicePixelRatio}lc(t,e){return Math.round(Math.sqrt(t*t+e*e))}vc(t,e,s){const i=s/1e3,n=t/i,r=e/i;return Math.round(Math.abs(n)+Math.abs(r))}fc(t,e){return Math.abs(t)>Math.abs(e)?t>0?Or.RIGHT:Or.LEFT:e>0?Or.DOWN:Or.UP}}const zr="undefined"!=typeof performance&&!!performance.now,Fr=zr?()=>performance.now():csDate.now,jr=zr?null===(Pr=performance.timing)||void 0===Pr?void 0:Pr.navigationStart:0,Gr=()=>Math.round(Fr()+jr);function Wr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const s=Math.pow(10,e);return Math.round(t*s)/s}class Yr{constructor(){this.mc={},this.wc=()=>{},this.gc=new qr,this.yc()}static isGestureDetectionSupported(){return"undefined"!=typeof devicePixelRatio}onGesture(t){this.wc=t}isValidTouchEvent(t){return"touches"in t&&"changedTouches"in t}processActionDown(t){if(!this.Ec(t))return;this.Ac(t)&&this.yc();const e={x:t.touches[0].clientX,y:t.touches[0].clientY,time:Gr()};if(1===t.touches.length)this.mc.startPinchTime=e.time,this.mc.firstTouch=e;else if(2===t.touches.length&&(this.mc.secondTouch={x:t.touches[1].clientX,y:t.touches[1].clientY,time:Gr()},this.mc.firstTouch&&this.mc.secondTouch)){const t=this.gc.computePinchMetrics(this.mc.firstTouch,this.mc.secondTouch);this._c=t.distance}csArray.prototype.push.call(this.Rc,e),this.Sc=Hs(t)}processActionMove(){this.Tc=!0}processActionUp(t){if(this.Ic(t)){if(csArray.prototype.push.call(this.Rc,{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY,time:Gr()}),this.Pc(t)&&this.mc.startPinchTime){const e={x:t.touches[0].clientX,y:t.touches[0].clientY,time:this.mc.startPinchTime},s={x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY,time:Gr()};this.mc.firstTouch&&(this.mc.firstTouch=e,this.mc.secondTouch=s),this.bc(t)}this._c||this.Vc()&&this.Cc(t)}}yc(){this.Rc=[],this.Sc=null,this.Tc=!1,this._c=null,this.kc=!0}Cc(t){const e=this.gc.compute(this.Rc[0],this.Rc[1]);this.kc=t.isTrusted;const s=this.Tc?this.Oc(e):this.Nc(e);if(this.xc(s.type,t.changedTouches)){const e=t.changedTouches[0];s.pageX=Wr(e.pageX,1),s.pageY=Wr(e.pageY,1)}this.wc(s,t)}bc(t){if(!this.mc.firstTouch||!this.mc.secondTouch)return;const e=this.gc.computePinchMetrics(this.mc.firstTouch,this.mc.secondTouch);this.kc=t.isTrusted;const s=this.$c(e);s&&this.wc(s,t)}$c(t){if(this._c&&!(this.gc.getScale(this._c,t.distance)<.1))return{type:this._c>t.distance?Ir.PINCH_IN:Ir.PINCH_OUT,target:this.Sc,distance:t.distance,isTrusted:this.kc}}Oc(t){return{type:t.velocity<100?Ir.DRAG:Ir.FLICK,target:this.Sc,velocity:t.velocity,distance:t.distance,direction:t.direction,isTrusted:this.kc}}Nc(t){return{type:t.duration<1e3?Ir.TAP:Ir.LONG_PRESS,target:this.Sc,isTrusted:this.kc}}xc(t,e){return t===Ir.TAP&&e&&1===e.length}Ac(t){return 1===t.touches.length}Vc(){return 2===this.Rc.length}Ec(t){return t.touches.length>0}Ic(t){return t.changedTouches.length>0}Pc(t){return this.Tc&&!!this._c&&1===t.changedTouches.length&&1===t.touches.length}}class Qr{constructor(t){this.Qs=t}observe(){Qr.Mc&&Qr.Lc(this.Qs)}disconnect(){Qr.Mc&&Qr.Dc(this.Qs)}static Uc(t,e){csArray.prototype.forEach.call(Ht(Qr.sc),(s=>s(t,e)))}static Lc(t){Qr.sc.has(t)||(Qr.sc.add(t),1===Qr.sc.size&&(Qr.Fc.onGesture(Qr.Uc),csArray.prototype.forEach.call(Qr.ar,(t=>Os(t)))))}static Dc(t){Qr.sc.delete(t),0===Qr.sc.size&&csArray.prototype.forEach.call(Qr.ar,(t=>Ps(t)))}static Bc(t){if(Qr.Fc.isValidTouchEvent(t))switch(t.type){case"touchstart":Qr.Fc.processActionDown(t);break;case"touchmove":Qr.Fc.processActionMove();break;case"touchend":Qr.Fc.processActionUp(t)}}}Qr.ar=[{boundElement:a.document,type:"touchstart",listener:t=>Qr.Bc(t)},{boundElement:a.document,type:"touchmove",listener:t=>Qr.Bc(t)},{boundElement:a.document,type:"touchend",listener:t=>Qr.Bc(t)}],Qr.Mc=Yr.isGestureDetectionSupported(),Qr.sc=new Set,Qr.Fc=new Yr;class Zr extends Sn{constructor(){super(),this.qc=new Qr(this.Hc.bind(this))}onStart(){this.qc.observe()}onStop(){this.qc.disconnect()}Hc(t){const e=this.zc(t);e&&this.produceEvent(e)}zc(t){if(!this.jc(t))return null;const e=(s=t.target,js.getProperty(s,Ys));var s;return e?{type:"Gesture",targetId:e,data:{type:t.type,direction:t.direction,distance:t.distance,velocity:t.velocity,pageX:t.pageX,pageY:t.pageY}}:null}jc(t){return null!==t.target&&!(C(t.target)&&Ks.isMaskedElementChild(t.target))}}class Xr{constructor(t){this.Qs=t,this.Gc=!1,this._h={boundElement:a,type:"error",listener:t=>this.Zc(t)}}observe(){Os(this._h,this.Gc)}disconnect(){Ps(this._h,this.Gc)}Zc(t){this.Qs(t)}}class Kr extends Sn{constructor(){super(...arguments),this.Wc=new Xr((t=>this.Qc(t)))}Qc(t){let{message:e,filename:s,lineno:i,colno:n}=t;e=null!=e?e:"[NO ERROR MESSAGE]",s=!s||wi(s)?"":s,this.produceEvent({type:"JSError",message:e,filename:s,lineno:i,colno:n})}onStart(){this.Wc.observe()}onStop(){this.Wc.disconnect()}}class Jr extends On{constructor(t){super(),this.Jc=t,this.Kc=1024,this.Yc=150}isListening(t){return"JSError"===t.type}processEvent(t){return t.message=bn.truncate(t.message,this.Kc,bn.ELLIPSIS),t.filename=bn.truncate(t.filename,this.Yc,bn.ELLIPSIS),this.Jc(t)}}let to=[],eo=!1;const so=_t((function(){const t=csDate.now();for(let e=0;e<to.length;e++)if(to[e](),csDate.now()-t>=35)return to=csArray.prototype.slice.call(to,e+1),void csSetTimeout(so);to=[],eo=!1}),"executeTasks");var io,no;!function(t){t[t.Started=0]="Started",t[t.Stopped=1]="Stopped",t[t.Processing=2]="Processing",t[t.Completed=3]="Completed"}(io||(io={}));class ro{constructor(){this.Xc=new vt,this.Bi=io.Stopped,this.Qs=null,this.ta=t=>{this.Bi!==io.Stopped&&t&&(this.Qs(t),this.sa())}}get queueLength(){return this.Xc.length}start(t){if(this.Qs)throw new Error("callback already set");this.Bi=io.Started,this.Qs=t}push(t){this.Xc.push(t),this.ea()}stop(){this.Qs=null,this.Bi=io.Stopped,this.Xc.clear()}static pipe(t,e){let s=t;const i=new csArray;for(const t of e){const e=new ro;e.start((e=>{t.pushEvent(e)})),csArray.prototype.push.call(i,e),Dt(s,(t=>t.subscribe((t=>e.push(t))))),s=[t]}const n=new oo(i);return Dt(s,(t=>t.subscribe((t=>n.push(t))))),n}ia(){return this.Bi===io.Stopped}na(){return this.Bi===io.Processing}sa(){this.ia()||(this.Xc.isEmpty?this.Bi=io.Completed:(this.Bi=io.Processing,function(t){if(csArray.prototype.push.call(to,t),!eo){for(let t=0;t<3;t++)csSetTimeout(so);eo=!0}}((()=>{const t=this.Xc.pop();t instanceof Di?t.complete(this.ta):this.ta(t)}))))}ea(){this.ia()||this.na()||this.sa()}}class oo extends ro{constructor(t){super(),this.ra=t}get queueLength(){return csArray.prototype.reduce.call(this.ra,((t,e)=>t+e.queueLength),0)}stop(){super.stop(),Dt(this.ra,(t=>t.stop()))}}class ao{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.producers=t,this.processors=e,this.zs=!1,this.sc=[]}get pendingEvents(){var t,e;return null!==(e=null===(t=this.Xc)||void 0===t?void 0:t.queueLength)&&void 0!==e?e:0}start(){if(this.zs)throw new Error("Recording is already started.");const t=this.sc;this.Xc=ro.pipe(this.producers,this.processors),this.Xc.start((e=>csArray.prototype.forEach.call(t,(t=>t(e))))),Dt(this.producers,(t=>t.start())),Dt(this.processors,(t=>t.start())),this.zs=!0}stop(){this.Xc.stop(),this.sc.length=0;for(const t of this.producers)t.stop();for(const t of this.processors)t.stop();this.zs=!1,this.sc=[]}subscribe(t){if(this.zs)throw new Error("Recording is already started.");return csArray.prototype.push.call(this.sc,t),()=>this.sc=csArray.prototype.filter.call(this.sc,(e=>e!==t))}}class co extends Sn{constructor(t){super(),this.an=t}subscribe(t){return super.subscribe(t)}onStart(){Dt(this.an,(t=>{t.onEvent((e=>{var s;return this.Li(e,null!==(s=t.eventType)&&void 0!==s?s:"browser")}))})),Dt(this.an,(t=>{var e;null===(e=t.start)||void 0===e||e.call(t)}))}onStop(){Dt(this.an,(t=>{var e;return null===(e=t.stop)||void 0===e?void 0:e.call(t)}))}Li(t,e){this.produceEvent({timestamp:Ie(),type:"Legacy",originalEvent:t,eventType:e})}}function ho(t){switch(t){case Ir.DRAG:case Ir.FLICK:return Us.SWIPE;case Ir.LONG_PRESS:return Us.LONG_PRESS;case Ir.TAP:return Us.TAP;case Ir.PINCH_IN:return Us.PINCH_IN;case Ir.PINCH_OUT:return Us.PINCH_OUT}}!function(t){t.REQUEST_START="requestStart",t.DOM_INTERACTIVE="domInteractive",t.TIME_ORIGIN="timeOrigin"}(no||(no={}));let lo=0;class uo{get pendingEvents(){return this.oa.pendingEvents}constructor(t,e,s,i,n){this.oa=t,this.ha=e,this.ca=s,this.fn=i,this.vn=n,this.aa=()=>{},this.ua=()=>{},this.da=function(t){return function(t,e){let s=[],i=!1;return{push(t){csArray.prototype.push.call(s,t),s.length!==e.batchSize?e.autoFlushDelay&&e.autoFlushDelay>0&&!i&&(i=!0,csSetTimeout((()=>{i=!1,s.length>0&&this.flush()}),e.autoFlushDelay)):this.flush()},flush(){if(!s.length)return;const e=s;s=[],t(e)}}}((e=>{const s={visibleInViewPort:e},i={type:Ds.TEXT_VISIBILITY,date:Ie(),args:[s]};t(i)}),{batchSize:20,autoFlushDelay:1e3})}((t=>this.aa(t)))}start(){var e,s;this.fa={processEvent(e,s){if(e.originalEvent.type===Ds.PERFORMANCE_RESOURCE_TIMING)return lo>=500?null:(lo+=1,s(t._objectSpread2(t._objectSpread2({},e.originalEvent),{},{date:e.timestamp})));s(e.originalEvent)},reset(){lo=0}},this.oa.subscribe((t=>{var e,s,i,n,r,o;const a=t,{timestamp:c}=a;switch(a.type){case"Legacy":{const t="user"===a.eventType?null!==(e=this.ua)&&void 0!==e?e:()=>{}:this.aa;this.fa.processEvent(a,t)}break;case"CustomElementRegistration":this.aa({type:Ds.CUSTOM_ELEMENT_REGISTRATION,date:c,args:[a.tagName]});break;case"DomEvent":!function(t,e,s){const{timestamp:i}=t;switch(t.domEvent){case"initialDOM":{const{initialDOM:e}=t,n={type:Ds.INITIAL_DOM,date:i,args:[e]};s.emitInitialDomDone(n);break}case"nodesAdded":csArray.prototype.forEach.call(t.nodes,(s=>{e({type:Ds.MUTATION_INSERT,date:i,args:[t.target,t.nextSibling,s]})}));break;case"nodesMoved":for(const s of t.nodesIds)e({type:Ds.MUTATION_MOVE,date:i,args:[s,t.nextSibling,t.target]});break;case"nodesRemoved":csArray.prototype.forEach.call(t.nodesIds,(t=>{e({type:Ds.MUTATION_REMOVE,date:i,args:[t]})}));break;case"attributeChanged":{const{target:s,namespace:n,attribute:r,newValue:o}=t;e({type:Ds.MUTATION_ATTRIBUTE,date:i,args:[s,n,r,o]});break}case"characterDataChanged":{const{target:s,newValue:n}=t;e({type:Ds.MUTATION_CHARACTER_DATA,date:i,args:[s,n]});break}case"cssRuleInserted":{const{target:s,rule:n,index:r}=t,o=S(r)?[s,n,r]:[s,n];e({type:Ds.STYLESHEET_RULE_INSERT,date:i,args:o});break}case"cssRuleDeleted":{const{target:s,index:n}=t;e({type:Ds.STYLESHEET_RULE_DELETE,date:i,args:[s,n]});break}case"cssRuleUpdated":{const{target:s,rule:n,index:r}=t;e({type:Ds.STYLESHEET_RULE_UPDATE,date:i,args:[s,n,r]});break}case"shadowRootAttached":{const{target:s,shadowRoot:n}=t;e({type:Ds.ATTACH_SHADOW,date:i,args:[s,n]});break}case"adoptedStyleSheetRegistered":{const{sheetId:s,cssRules:n}=t;e({type:Ds.REGISTER_ADOPTED_STYLE_SHEET,date:i,args:[s,{cssRules:n}]});break}case"adoptedStyleSheetsSet":{const{target:s,sheetsIds:n}=t;e({type:Ds.SET_ADOPTED_STYLE_SHEETS,date:i,args:[s,n]});break}case"adoptedStyleSheetRuleInserted":{const{sheetId:s,rule:n,index:r}=t,o=S(r)?[s,n,r]:[s,n];e({type:Ds.ADOPTED_STYLESHEET_RULE_INSERT,date:i,args:o});break}case"adoptedStyleSheetRuleDeleted":{const{sheetId:s,index:n}=t;e({type:Ds.ADOPTED_STYLESHEET_RULE_DELETE,date:i,args:[s,n]});break}case"adoptedStyleSheetRuleUpdated":{const{sheetId:s,rule:n,index:r}=t,o=[s,n,r];e({type:Ds.ADOPTED_STYLESHEET_RULE_UPDATE,date:i,args:o});break}default:ns.error("translateDOMEvent: DOMEvent not supported")}}(a,this.aa,this.ha);break;case"InputEvent":{const t=function(t){switch(t.inputType){case"text":return{type:Ds.INPUT_TEXT,args:[t.target,t.value],date:t.timestamp};case"select":return{type:Ds.INPUT_SELECT,args:[t.target,t.selectedIndex],date:t.timestamp};case"checkable":return{type:Ds.INPUT_CHECKABLE,args:[t.target,t.checked],date:t.timestamp}}}(a);null===(s=this.ua)||void 0===s||s.call(this,t);break}case"encryptedCharacterDataChanged":{const{target:t,rawData:e,encryptedData:s,encryptionMetadata:i}=a;this.aa({type:Ds.MUTATION_ENCRYPTED_CHARACTER_DATA,date:c,args:[t,e,s,i]});break}case"StaticResource":{const{url:t}=a;this.aa({type:Ds.STATIC_RESOURCE_URL,date:c,args:[t]});break}case"ResizeMaskedElement":{const{target:t,width:e,height:s}=a;this.aa({type:Ds.MUTATION_ATTRIBUTE,date:c,args:[t,"","style",`width:${e}px !important;height:${s}px !important;`]});break}case"Gesture":{const e=function(t){const e=function(t){const e={type:ho(t.type)};for(const s in t){const i=t[s];void 0!==i&&"type"!==s&&(e[s]=i)}return e}(t.data);return{type:Ds.GESTURE_RECOGNITION,args:[t.targetId,e],date:t.timestamp}}(t);null===(i=this.ua)||void 0===i||i.call(this,e);break}case"TextVisibility":this.da.push(a.text);break;case"StaticResourceManagerEvent":null===(n=this.ca)||void 0===n||n.processEvent(a);break;case"screenResize":{const{width:t,height:e}=a,s={type:Ds.SCREEN_RESIZE,date:c,args:[t,e]};this.aa(s);break}case"viewportResize":{const{width:t,height:e}=a,s={type:Ds.RESIZE,date:c,args:[t,e]};this.aa(s);break}case"PerformanceTiming":this.aa(function(t){return{type:Ds.PERFORMANCE_TIMINGS,args:[{performanceTiming:no.REQUEST_START,timestamp:t.timings.requestStart},{performanceTiming:no.DOM_INTERACTIVE,timestamp:t.timings.domInteractive},{performanceTiming:no.TIME_ORIGIN,timestamp:t.timings.timeOrigin}],date:t.timestamp}}(a));break;case"CustomError":{const t=null===(r=this.vn)||void 0===r?void 0:r.translate(a);t&&this.aa(t);break}case"JSError":{const t=null===(o=this.fn)||void 0===o?void 0:o.translate(a);t&&this.aa(t);break}case"VideoEvent":{const t=function(t){switch(t.videoEventType){case"play":return{type:Ds.VIDEO_PLAY,args:[t.nodeId],date:t.timestamp};case"pause":return{type:Ds.VIDEO_PAUSE,args:[t.nodeId],date:t.timestamp};case"seeked":{const e=t;return{type:Ds.VIDEO_SEEK,args:[e.nodeId,e.newTimePositionInSec],date:t.timestamp}}default:return null}}(a);t&&this.aa(t);break}case"warning":ns.warn(a.message);break;default:ns.error(`WebRecorderEventTranslator: Event not supported (${a.type})`)}})),this.ha.emitInitialDomStart(),null===(e=this.fn)||void 0===e||e.start(),null===(s=this.vn)||void 0===s||s.start(),this.oa.start()}stop(){var t,e,s;this.reset(),this.flush(),this.oa.stop(),null===(t=this.ca)||void 0===t||t.flushEvents(),null===(e=this.fn)||void 0===e||e.stop(),null===(s=this.vn)||void 0===s||s.stop()}flush(){this.da.flush()}onEvent(t,e){var s;this.aa=t,this.ua=e,null===(s=this.ca)||void 0===s||s.onEvent((t=>this.aa(t)))}reset(){this.fa.reset()}}class po{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;this.pa=t,this.va={},this.ma=null,this.oi="original-resource-name"}onEvent(t){this.wa=t}processEvent(t){this.ga(t.resourceId,t.resource.hash,t.originalResourceName),this.ya(t)}flushEvents(){this.ma&&csClearTimeout(this.ma),this.Ea()}onSendStaticResource(t){this.ya=t}Ea(){if(!Object.keys(this.va).length)return;const t={type:Ds.RESOURCE_HASHES,date:Ie(),args:[this.va]};this.ma=null,this.va={},this.wa(t)}ga(t,e,s){let i=e;s&&(i+=`?${this.oi}=${s}`),this.va[t]=i,this.ma||(this.ma=window.csSetTimeout((()=>this.Ea()),this.pa))}}class go{constructor(t,e,s){this.ha=t,this.Vt=e,this.Aa=s,this._a=Ei.ETR_DISABLED,this.Ra=Ei.ETR_PENDING,this.Sa=!0}getEtrStatus(t){void 0===t&&(t=this.Vt.getSession());const e=null==t?void 0:t.etrStatus;return this.Ta()&&e===Ei.ETR_SAVED_SESSION?e:this._a}onEventTriggerRecording(t,e){switch(e){case vi.ETR_PAGE:this.Ia(Ei.ETR_SAVED_PAGE);break;case vi.ETR_LEGACY:case vi.ETR_SESSION:this.Ia(Ei.ETR_SAVED_SESSION)}}handleCollectStateChange(t){this.Sa=!1,t?this.Pa(this.Ra):this.Pa(Ei.ETR_DISABLED)}handleArtificialPageview(){this.Aa?(this.Sa=!0,this.Pa(Ei.ETR_DISABLED)):this.Ta()&&this.Pa(Ei.ETR_PENDING)}handleSessionRenewal(){this.Sa=!0,this.Pa(Ei.ETR_DISABLED)}Pa(t){this._a=t,this.Ra=Ei.ETR_PENDING,this.ba(t),this.ha.emitRecordingContextChange()}Ia(t){this.Sa?Number(t)>Number(this.Ra)&&(this.Ra=t):this.Ta()&&Number(t)>Number(this._a)&&(this._a=t,this.ba(t),this.ha.emitRecordingContextChange())}ba(t){const e=this.Vt.getSession();null!==e&&e.etrStatus===Ei.ETR_NOT_SAVED_SESSION&&t===Ei.ETR_SAVED_SESSION&&(e.etrStatus=t,this.Vt.setSession(e))}Ta(){return this._a!==Ei.ETR_DISABLED}}function mo(t,e){let s,i,n,r,o=null;const a=c=>{const h=Oe();if(!c&&null!==o){const t=e-(h-o);if(t>0)return void(i=window.csSetTimeout(a,t))}const l=h-n;i=null,o=null,n=null,r=t(l,...s)},c=function(){for(var t=arguments.length,c=new Array(t),h=0;h<t;h++)c[h]=arguments[h];if(s=[...c],!n)return n=Oe(),i=window.csSetTimeout(a,e),r;o=Oe()};return c.flushPending=()=>{i&&(window.csClearTimeout(i),a(!0))},c.cancel=()=>{o=null,n=null,i&&(window.csClearTimeout(i),i=null)},c}function yo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(e,s,i)=>{const n=i.value;let r=!1;i.value=function(){for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];r||(r=!0,csSetTimeout((()=>{r=!1,n.apply(this,s)}),t))}}}var fo;!function(t){t[t.NOT_EXIST=2]="NOT_EXIST"}(fo||(fo={}));class vo extends ni{constructor(t,e,s){super(),this.ca=t,this.Va=e,this.Ca=s,this.ka={},this.Oa=new Set,this.na=!1}initState(){ke()&&(this.Na=this.Ca.getRequestParameters(),this.xa=`${this.Va}/exist?${ie.toQuery(this.Na)}`,this.$a=`${this.Va}/putTag?${ie.toQuery(this.Na)}`,this.Ma=mo((async()=>{if(this.na)this.Ma();else{this.na=!0;try{await this.La()}finally{this.na=!1}}}),300),this.ca.onSendStaticResource((t=>{this.Da(t)})))}onStart(){}onStop(){}onIframeStaticResource(t){this.Da(t)}Da(t){this.Ua(t.resource.hash,t.resource.data),t.nestedResources&&t.nestedResources.length>0&&csArray.prototype.forEach.call(t.nestedResources,(t=>{this.Ua(t.hash,t.data)}))}Ua(t,e){this.Oa.has(t)||(this.Oa.add(t),this.ka[t]=e,this.Ma())}async La(){const t=this.ka;this.ka={};const e=await this.Fa(t);if(!e.length)return;const s=this.Ba(e);await Promise.all(csArray.prototype.map.call(s,(t=>window.fetch(this.$a,{method:"POST",body:t}))))}async qa(t){try{const e=Object.keys(t);if(!e.length)return[];const s={projectId:this.Na.pid,filter:fo.NOT_EXIST,hashes:e,touch:!0},i=await window.fetch(this.xa,{method:"POST",body:csJSON.stringify(s)});return await i.json()}catch(t){return[]}}async Fa(t){const e=[],s=await this.qa(t);return csArray.prototype.forEach.call(s,(s=>{const i=t[s];i?csArray.prototype.push.call(e,{hash:s,data:i}):ns.warn("SRM: received unknown hash: "+s)})),e}Ba(t){let e=0;const s=[new FormData];for(const i of t){const{data:t,hash:n}=i,r=s.length-1;if(e+=t.size,e<8388608)s[r].append("",t,n);else{const i=new FormData;i.append("",t,n),e=t.size,csArray.prototype.push.call(s,i)}}return s}}class Eo{constructor(t){this.Ha=t,this.za=20,this.ja=0,this.Ti=!1}translate(t){if(this.ja>=this.za)return this.Ha.stop(),null;this.ja+=1;const{filename:e,message:s,lineno:i,colno:n,timestamp:r}=t;return{type:Ds.JAVASCRIPT_ERROR,date:r,args:[{errorType:"jsError",message:s,filename:e,lineno:i,colno:n}]}}start(){this.Ti||(this.ja=0,this.Ti=!0)}stop(){this.Ti=!1}}const So="v2/recording",wo=["isRecording"],Ro=["replay:resourceManager:enableForOnlineResource:nextPageviewOnly","cssrm:onlineAssets:activateForNextPageview"],Ao=["replay:resourceManager:getStatus","cssrm:getStatus"];class bo{constructor(t,e,s,i,n,r,o,a,c,h,l,d,u,p,g,m,y,f,v,E,S,w){this.Ga=t,this.Vt=e,this.wt=s,this.Na=i,this.Za=n,this.gt=r,this.Ki=o,this.Wa=a,this.Yi=c,this.Xi=h,this.tn=l,this.Qa=d,this.ha=u,this.Ja=p,this.Ka=g,this.Ya=m,this.Xa=y,this.uh=f,this.dn=v,this.tu=E,this.su=S,this.en=w}init(){const t=[],e=[];csArray.prototype.push.call(e,new Kn),this.eu=new Sr(this.tu.shouldUseAnonymization(),this.wt.whitelistedAttributes,this.gt,this.wt.anonymizeDigits),this.iu();const s=new Xn("csPersisted");this.nu(s);const i=new si;this.Wi=new ei;const n=new Wn;csArray.prototype.push.call(t,n),this.wt.useStaticResourceManager&&Un.isSupported()&&(this.ln=new Un,this.ca=new po,this.ru=new vo(this.ca,this.wt.getStaticResourceManagerUri(),this.Na),this.Ka.addListener(this.ru),csArray.prototype.push.call(e,this.ln));const r=new qn(i,this.Na,{getRequestParameters:()=>({let:this.recordingService.getRecordingLastEventTimestamp()})},{getRequestParameters:()=>({rst:this.recordingService.getRecordingStartTimestamp()})},{getRequestParameters:()=>({rt:csArray.prototype.join.call(this.Vt.getCollectStates(),",")})}),o=new Yn(`${this.wt.getRecordingUri()}/${So}`);csArray.prototype.push.call(e,this.eu),csArray.prototype.push.call(e,new wr(this.uh)),csArray.prototype.push.call(e,new Ar),this.ou=new Js,this.ou.init(),csArray.prototype.push.call(t,this.ou),this.rn=new $n(s,o,this.nn),csArray.prototype.push.call(t,new zn(window.location,this.gt));const a=new Rn,c=new kr,h=new Mr,l=new Vr(this.en),d=new Br,u=[c,this.Wa,a,new co(csArray.prototype.filter.call(t,(t=>t))),d,new $r,new Zr,l,h];this.wt.jsErrorsEnabled&&(this.Ha=new Kr,this.hu=new Jr((t=>this.Yi.anonymize(t))),this.fn=new Eo(this.Ha),csArray.prototype.push.call(u,this.Ha),csArray.prototype.push.call(e,this.hu));const p=new ao(u,e),g=new uo(p,this.ha,this.ca,this.fn,this.vn),m=[a,c,h,l,d];this.recordingService=new Hn(this.wt,this.Wi,r,i,this.Ki,this.Vt,this.Yi,this.Xi,this.tn,this.en,this.nn,this.rn,o,g,t,m,this.ln,this.dn,this.fn,this.vn),this.Ja.addListener(this.recordingService),this.Ka.addListener(this.recordingService),this.recordingService.init(),this.Za.register(wo,(()=>this.Vt.isReplayRecorded()&&!this.Ya.isUrlExcludedForSessionReplay())),this.Za.register(Ro,(()=>{this.recordingService.activateOnlineAssetsOnNextPageview(),this.ha.emitRecordingContextChange()})),this.Za.register(Ao,(()=>this.recordingService.getStaticResourceManagerStatus())),this.au=new go(this.ha,this.Vt,this.wt.malkaUrlEnabled),this.Ja.addListener(this.au),this.Ga.enableRecordingContext(this.recordingService,this.Vt,this.au),this.lu()}onAfterNaturalPageView(){var t;this.Ya.isUrlExcludedForSessionReplay()?this.recordingService.resetOnlineAssetsOnPageview():this.recordingService.updateOnlineAssetsOnPageview(),null===(t=this.ru)||void 0===t||t.initState()}onStartTracking(){this.rn.recover(),this.iu(),this.Vt.isReplayRecorded()&&!this.Ya.isUrlExcludedForSessionReplay()&&(this.Vt.isTemporarilyRecorded()&&this.recordingService.blockSendingEventsFromQuotaService(),this.du())}onArtificialPageViewEnd(){!this.Vt.isReplayRecorded()||this.Ya.isUrlExcludedForSessionReplay()||this.Vt.isTemporarilyRecorded()||this.rn.sendLastMessageBeacon(),this.recordingService.clearStates()}onBeforeArtificialPageView(){this.au.handleArtificialPageview()}onAfterArtificialPageView(){this.iu(),this.Vt.isReplayRecorded()&&!this.Ya.isUrlExcludedForSessionReplay()?(this.Vt.isTemporarilyRecorded()&&this.recordingService.blockSendingEventsFromQuotaService(),this.recordingService.updateOnlineAssetsOnPageview(),this.fu()):(this.recordingService.resetOnlineAssetsOnPageview(),this.pu())}onBeforeSessionRenewal(){this.au.handleSessionRenewal(),this.recordingService.clearStates(),this.pu()}onOptout(){this.pu(),this.recordingService.onOptOut()}onReplayUnanonymizationConsentGranted(){this.iu(),this.recordingService.triggerUnanonymizationConsentGranted(),this.ha.emitRecordingContextChange()}onReplayUnanonymizationConsentWithdrawn(){this.iu(),this.recordingService.triggerUnanonymizationConsentWithdrawn(),this.ha.emitRecordingContextChange()}onCollectStateChange(t,e){if(t===yi.QUOTA_REACHED||t===yi.ANALYTICS_ONLY&&e===fi.ETR_OFF)this.recordingService.clearEvents(),this.pu();else{this.nn.setQueryParams({rt:csArray.prototype.join.call(this.Vt.getCollectStates(),",")}),this.recordingService.allowSendingEventsFromQuotaService(),this.recordingService.pushEvents();const s=t===yi.ANALYTICS_ONLY&&e===fi.ETR_ON;this.au.handleCollectStateChange(s)}}onInitialDomStart(){this.recordingService.blockSendingEventsFromSerialization(),this.rn.blockSendingLastMessage()}onInitialDomDone(t){this.recordingService.allowSendingEventsFromSerialization(),this.recordingService.addInitialDom(t),this.rn.allowSendingLastMessage(),this.ou.start(),this.recordingService.pushEvents()}onAfterReplayRecordingConsentGranted(){this.Vt.isReplayRecorded()&&!this.Ya.isUrlExcludedForSessionReplay()&&(this.Vt.isTemporarilyRecorded()&&this.recordingService.blockSendingEventsFromQuotaService(),this.du(),this.recordingService.triggerRecordingForSessionGranted())}onAfterReplayRecordingConsentWithdrawn(){this.recordingService.isRecording()&&(this.recordingService.triggerRecordingForSessionWithdrawn(),this.recordingService.clearStates(),this.pu())}lu(){var t,e,s,i;(null===(e=null===(t=this.wt.experimental.sessionReplay)||void 0===t?void 0:t.shadowRoot)||void 0===e?void 0:e.filterByHostSelector)&&Dt(null===(i=null===(s=this.wt.experimental.sessionReplay)||void 0===s?void 0:s.shadowRoot)||void 0===i?void 0:i.filterByHostSelector,(t=>{Zs(t)&&rn.setShadowRootFilter((e=>{try{return Y.call(e.host,t)}catch(t){return!1}}))}))}du(){this.recordingService.start(),this.rn.start(),this.ha.emitRecordingContextChange()}pu(){!function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(Ws=1),Ys=csSymbol("nodeIdentifier")}(),this.recordingService.stop(),this.rn.stop(),this.ha.emitRecordingContextChange()}fu(){this.pu(),this.du()}nu(t){this.nn=this.Xa.create(`${this.wt.getRecordingUri()}/${So}`,!0,"byteArray",t,["rt","v","pid","pn","sn","uu"])}iu(){var t;const e=this.tu.shouldUseAnonymization();this.eu.setAnonymization(e),null===(t=this.vu)||void 0===t||t.setAnonymization(e)}}var To,Co;as([Nt("Recording.onStartTracking")],bo.prototype,"onStartTracking",null),as([Nt("onInitialDomDone")],bo.prototype,"onInitialDomDone",null),function(t){t[t.NOT_NEEDED=1]="NOT_NEEDED",t[t.NOT_EXPRESSED=2]="NOT_EXPRESSED",t[t.WITHDRAWN=3]="WITHDRAWN",t[t.GRANTED=4]="GRANTED"}(To||(To={})),function(t){t.isReplayConsentNeeded=function(t){return t.replayConsentRequiredForSession},t.isRecordingBlockedByConsent=function(t){return t.collectState===yi.RECORDING_BLOCKED_BY_CONSENT_NOT_EXPRESSED||t.collectState===yi.RECORDING_BLOCKED_BY_CONSENT_WITHDRAWN},t.isRecordingWithDrawn=function(t){return t.collectState===yi.RECORDING_BLOCKED_BY_CONSENT_WITHDRAWN}}(Co||(Co={}));class _o{constructor(t,e,s,i){this.bt=t,this.Vt=e,this.wt=s,this.mu=i,this.wu=!1}isNaturalPageViewSent(){return this.wu}setNaturalPageViewSent(t){this.wu=t}getTrackingContext(){const e=this.Vt.getSession();if(!e)return null;const s=this.getSessionKey();if(!s)return null;const i=this.wt.projectId,n=this.wt.uxaDomain;return t._objectSpread2({projectId:i,sessionKey:s,pageNumber:e.pageNumber,pageViewType:this.mu.getPageViewType(),isRecording:this.Vt.isReplayRecorded(),uxaDomain:n,recordingConsentState:this.gu(e)},this.wt.smbConfig)}getSessionKey(){const t=this.bt.getVisitor();return t?`${t.id}.${t.visitsCount}`:null}gu(t){return Co.isReplayConsentNeeded(this.wt)?t.collectState===yi.RECORDING_BLOCKED_BY_CONSENT_NOT_EXPRESSED?To.NOT_EXPRESSED:t.collectState===yi.RECORDING_BLOCKED_BY_CONSENT_WITHDRAWN?To.WITHDRAWN:To.GRANTED:To.NOT_NEEDED}}class No{constructor(t){this.yu=t,this.Eu=[]}handleCommand(t){if(R(t)&&(this.Au(t),this.yu.isNaturalPageViewSent())){const e=this.yu.getTrackingContext();null!==e&&this._u(t,e)}}Au(t){csArray.prototype.push.call(this.Eu,t)}executeRegisteredCallbacks(){const t=this.yu.getTrackingContext();null!==t&&csArray.prototype.map.call(this.Eu,(e=>this._u(e,t)))}_u(t,e){csSetTimeout((()=>{t(e)}))}}class Io{constructor(t){this.yu=t,this.Ru=[]}handleCommand(t){return this.yu.isNaturalPageViewSent()?this.Su(t):void this.Tu(t)}Su(t){const e=this.yu.getSessionKey();return this.Iu(t)&&null!==e&&this._u(t.callback,e),e}Tu(t){this.Iu(t)&&csArray.prototype.push.call(this.Ru,t.callback)}flushPendingCallbacks(){const t=this.yu.getSessionKey();null!==t&&csArray.prototype.forEach.call(this.Ru,(e=>{this._u(e,t)})),this.Ru=[]}Iu(t){return t&&"function"==typeof t.callback}_u(t,e){csSetTimeout((()=>{t(e)}))}}class Oo{constructor(t,e){this.Pu=t,this.yu=e}onTrackingContextRequestCallback(e){const s=this.yu.getTrackingContext();null!==s&&this.Pu.sendToChildren(Je.TrackingContextResultMessage,t._objectSpread2(t._objectSpread2({},e),{},{trackingContext:s}))}onIframeIntegrationCallback(t){if(!this.yu.isNaturalPageViewSent())return;const e=this.yu.getTrackingContext();null!==e&&(t.trackingContext=e,this.Pu.sendToChildren(Je.IntegrationCallback,t))}sendAfterPageViewCallbackToChildren(){const t=this.yu.getTrackingContext();if(null===t)return;const e={trackingContext:t,initiator:Xe.AfterPageView};this.Pu.sendToChildren(Je.IntegrationCallback,e)}}function Po(t,e){const{isRecording:s,pageNumber:i,projectId:n,siteId:r,uxaDomain:o,csLiteDomain:a}=t,c=/^(.+)\.(\d+)$/.exec(t.sessionKey);let h;if(s&&c){const[,t,s]=c;h=r?`${a}/sites/${r}/player?uu=${t}&sn=${s}&pn=${i}`:`${o}/quick-playback/index.html?pid=${n}&uu=${t}&sn=${s}&pvid=${i}&recordingType=cs`,e.withTimestamp&&(h+="&t="+(Ie()-e.recordingStartTimestamp))}return{replayLink:h,isRecording:s}}class ko{constructor(t){this.yu=t}handleCommand(t,e){E(t)&&R(e)&&this._u(t,e)}_u(t,e){csSetTimeout((()=>{const s=this.yu.getTrackingContext();if(s){const i=Po(s,t);e(i)}}))}}class Lo{constructor(){this.Eu=new Set}handleCommand(t,e){return R(t)?this.Eu.has(t)?null:(this.Eu.add(t),e&&(this.lo=e,this.bu(t,e)),()=>this.Eu.delete(t)):null}executeCallbacks(t){this.Vu(t)&&(this.lo=t,this.Eu.forEach((e=>this.bu(e,t))))}bu(t,e){csSetTimeout((()=>{try{t(e)}catch(t){}}))}Vu(t){const{isRecording:e,recordingStartTimestamp:s,etrState:i,etrStatus:n,collectState:r}=t;return this.lo&&(this.lo.isRecording!==e||this.lo.recordingStartTimestamp!==s||this.lo.etrState!==i||this.lo.etrStatus!==n||this.lo.collectState!==r)}}const Mo=["afterPageView"],Do=["getSessionKey"],xo=["onRecordingContextChange","onRecordingStateChange"],Uo=["replay:link:generate"];class Vo{constructor(t,e,s,i,n,r,o,a){this.bt=t,this.Vt=e,this.Za=s,this.Cu=i,this.Pu=n,this.wt=r,this.mu=o,this.Ga=a}init(){this.yu=new _o(this.bt,this.Vt,this.wt,this.mu),this.ku=new No(this.yu),this.Ou=new Io(this.yu),this.Nu=new Lo,this.xu=new ko(this.yu),this.$u=new Oo(this.Pu,this.yu),this.Cu.addListener(this.$u),this.Za.register(Do,(t=>this.Ou.handleCommand(t))),this.Za.register(Mo,(t=>this.ku.handleCommand(t))),this.Za.register(xo,(t=>{this.Nu.handleCommand(t,this.Ga.getRecordingContext())})),this.Za.register(Uo,((e,s)=>{this.Mu&&this.xu.handleCommand(t._objectSpread2(t._objectSpread2({},e),{},{recordingStartTimestamp:this.Ga.getRecordingContext().recordingStartTimestamp}),s)}))}onAfterNaturalPageView(){this.yu.setNaturalPageViewSent(!0),this.Ou.flushPendingCallbacks(),this.ku.executeRegisteredCallbacks(),this.$u.sendAfterPageViewCallbackToChildren()}onAfterArtificialPageView(){this.ku.executeRegisteredCallbacks(),this.$u.sendAfterPageViewCallbackToChildren()}onCollectStateChange(){this.executeRecordingContextChangeCallbacks()}onRecordingContextChange(){this.executeRecordingContextChangeCallbacks()}executeRecordingContextChangeCallbacks(){this.Nu.executeCallbacks(this.Ga.getRecordingContext())}setRecordingService(t){this.Mu=t}}as([yo()],Vo.prototype,"executeRecordingContextChangeCallbacks",null);class Bo{constructor(t,e){this.key=csString.prototype.slice.call(t,0,512),this.value=f(e)?csString.prototype.slice.call(e,0,255):e}static isKeyValid(t){return f(t)}static isValueValid(t){return f(t)||y(t)}}class Ho extends ni{constructor(t,e){super(),this.Lu=t,this.gt=e,this.Du=[]}onStart(){csArray.prototype.forEach.call(this.Du,(t=>this.trackDynamicVariable(t.key,t.value))),this.Du=[]}onStop(){}trackDynamicVariable(t,e){if(this.isStarted)if(Bo.isKeyValid(t)&&Bo.isValueValid(e)){const s=this.gt.anonymizePII(t),i=y(e)?e:this.gt.anonymizePII(e);this.Lu.add(new Bo(s,i)),le.counters.commandApplied.count("dvars")}else le.counters.commandMisuse.count("dvars");else csArray.prototype.push.call(this.Du,{key:t,value:e})}}class $o{constructor(t){this.Uu=t,this.Lu=[]}add(t){csArray.prototype.push.call(this.Lu,t),this.setBatchReadyCall()}clear(){this.Lu=[]}onBatchReady(t){this.Fu=t}getRequestParameters(){const t={};for(const e of this.Lu)t[e.key]=e.value;return{dv:this.Uu.compressSync(csJSON.stringify(t),"base64"),ct:this.Uu.algorithm}}setBatchReadyCall(){this.Fu()}}as([yo(),yt("dynamicVariablesBatchReady")],$o.prototype,"setBatchReadyCall",null);const qo=["trackDynamicVariable"];class zo{constructor(t,e,s,i,n,r){this.Za=t,this.Vt=e,this.wt=s,this.Na=i,this.Uu=n,this.gt=r,this.tt=new re(this.wt.getTrackerUri(),"dvar"),this.Lu=new $o(this.Uu),this.Bu=new Ho(this.Lu,this.gt)}init(){var t=this;this.tt.setRequestParametersProviders(this.Na,this.Lu),this.Vt.setDynamicVariablesService(this.Bu),this.Lu.onBatchReady((()=>this.tt.send())),this.tt.after((()=>this.Lu.clear())),this.Za.register(qo,(function(){let{key:e,value:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.Bu.trackDynamicVariable(e,s)}))}onStartTracking(){this.Bu.start()}}class Fo{constructor(t,e){this.id=t,this.revenue=e}static from(t){const e=new Fo(t.id,parseFloat(t.revenue));return isNaN(parseFloat(t.tax))||(e.tax=parseFloat(t.tax)),isNaN(parseFloat(t.shipping))||(e.shipping=parseFloat(t.shipping)),f(t.currency)&&t.currency.length<=10&&(e.currency=t.currency),e}hasValidRevenue(){return!isNaN(this.revenue)&&this.revenue>=0}static isValid(t){return w(t)&&m(t.revenue)&&f(t.currency)&&t.currency.length<=10&&(!w(t.id)||f(t.id))}}class jo{constructor(t,e,s,i){this.id=t,this.name=e,this.price=s,this.quantity=i}static from(t){if(!jo.qu(t))return null;const e=new jo(t.id,t.name,parseFloat(t.price),parseInt(t.quantity,10));return S(t.sku)&&(e.sku=t.sku),S(t.category)&&(e.category=t.category),S(t.merchant)&&t.merchant.length>0&&(e.merchant=t.merchant.slice(0,100)),e}static qu(t){return w(t)&&f(t.id)&&f(t.name)&&m(parseFloat(t.price))&&y(parseInt(t.quantity,10))&&(!S(t.sku)||f(t.sku))&&(!S(t.category)||f(t.category))&&(!S(t.merchant)||f(t.merchant))}}class Go extends ni{constructor(t,e,s){super(),this.gt=t,this.Hu=e,this.Ki=s,this.zu=[],this.clear()}onStart(){csArray.prototype.forEach.call(this.zu,(t=>{this.ju=t.transaction,this.Gu=t.transactionItems,this.sendTransaction()})),this.zu=[]}onStop(){}addTransaction(t){const e=this.gt.anonymizeFields(t,["id"]);this.ju=Fo.from(e)}getTransaction(){return this.ju}sendTransaction(){if(!this.isStarted)return csArray.prototype.push.call(this.zu,{transaction:this.ju,transactionItems:[...this.Gu]}),void this.clear();null!==this.Hu&&null!==this.Ki&&(this.Ki.refreshSession(),this.Ki.isSessionValid()&&(this.ju.hasValidRevenue()?this.Hu.send():ns.warn("Transaction Service: unable to send transaction with invalid parameters")))}addItem(t){if(R(t))return;const e=this.gt.anonymizeFields(t,["id","name","sku","category"]),s=jo.from(e);null!==s&&csArray.prototype.push.call(this.Gu,s)}getItems(){return this.Gu}clear(){this.ju=Fo.from({revenue:NaN}),this.Gu=[]}getRequestParameters(){const t={id:this.ju.id?`${this.ju.id}`:"",revenue:`${this.ju.revenue}`};return S(this.ju.tax)&&(t.tax=`${this.ju.tax}`),S(this.ju.shipping)&&(t.shipping=`${this.ju.shipping}`),S(this.ju.currency)&&(t.cu=`${this.ju.currency}`),t.items=window.csJSON.stringify(this.Gu),t}}class Wo extends ni{constructor(t,e){super(),this.Zu=t,this.Ki=e,this.Wu=null,this.Qu=[]}onStart(){csArray.prototype.forEach.call(this.Qu,(t=>{this.Wu=t,this.Ju()})),this.Qu=[]}onStop(){}addToCart(t){const e={};f(t.sku)&&(e.sku=csString.prototype.slice.call(t.sku,0,100)),f(t.merchant)&&(e.merchant=csString.prototype.slice.call(t.merchant,0,100)),(e.sku||e.merchant)&&(this.Wu=e,this.Ju())}getCartItem(){return this.Wu}Ju(){if(!this.isStarted&&null!==this.Wu)return csArray.prototype.push.call(this.Qu,this.Wu),void this.clear();this.Ki.refreshSession(),this.Ki.isSessionValid()&&this.Zu.send()}clear(){this.Wu=null}getRequestParameters(){if(!this.Wu)return{};const t={};return f(this.Wu.sku)&&this.Wu.sku.length>0&&(t.sku=this.Wu.sku),f(this.Wu.merchant)&&this.Wu.merchant.length>0&&(t.me=this.Wu.merchant),t}}const Yo=["ecommerce:addToCart","ec:cart:add"],Qo=["ecommerce:addTransaction","ec:transaction:create"],Zo=["ecommerce:addItem","ec:transaction:items:add"],Xo=["ecommerce:send","ec:transaction:send"];class Ko{constructor(t,e,s,i,n,r,o){this.wt=t,this.Ca=e,this.bt=s,this.Za=i,this.gt=n,this.Ki=r,this.Nt=o}init(){const t=new re(this.wt.getTrackerUri(),"transaction"),e=new re(this.wt.getTrackerUri(),"addtocart");this.Ku=new Go(this.gt,t,this.Ki),this.Yu=new Wo(e,this.Ki);const s=new qn(this.Ca,this.bt,this.Nt,this.Ku);t.setRequestParametersProviders(s),t.after((()=>{this.Ku.clear()}));const i=new qn(this.Ca,this.bt,this.Nt,this.Yu);e.setRequestParametersProviders(i),e.after((()=>{this.Yu.clear()})),this.Za.register(Qo,(t=>{this.Ku.addTransaction(t)})),this.Za.register(Zo,(t=>this.Ku.addItem(t))),this.Za.register(Xo,(()=>this.Ku.sendTransaction())),this.Za.register(Yo,(t=>{this.Yu.addToCart(t)}))}onStartTracking(){this.Ku.start(),this.Yu.start()}}class Jo{constructor(t){this.Xu=t.performance}getRequestParameters(){if(this.tl())return{};const t=this.sl();return{str:t.startRender,di:t.domInteractive,dc:t.domComplete,fl:t.fullyLoaded}}sl(){const t=this.Xu.timing;return{startRender:""+(t.domLoading-t.requestStart),domInteractive:""+(t.domInteractive-t.requestStart),domComplete:""+(t.domComplete-t.requestStart),fullyLoaded:""+(t.loadEventEnd-t.requestStart)}}tl(){return!(this.Xu&&this.Xu.timing&&this.Xu.timing.loadEventEnd>0)}}var ta,ea;function sa(t){return void 0!==t.tgt}!function(t){t[t.RESIZE=0]="RESIZE",t[t.SCROLL=1]="SCROLL",t[t.MOUSEMOVE=2]="MOUSEMOVE",t[t.MOUSEDOWN=3]="MOUSEDOWN",t[t.MOUSEUP=4]="MOUSEUP",t[t.CLICK=5]="CLICK",t[t.MOUSEOVER=6]="MOUSEOVER",t[t.MOUSEOUT=7]="MOUSEOUT",t[t.CHANGE=10]="CHANGE",t[t.FOCUSIN=11]="FOCUSIN",t[t.FOCUSOUT=12]="FOCUSOUT",t[t.TAP=14]="TAP",t[t.KEYDOWN=15]="KEYDOWN",t[t.KEYUP=16]="KEYUP",t[t.COMMAND=17]="COMMAND",t[t.SUBMIT_COMMAND=18]="SUBMIT_COMMAND",t[t.PERFORMANCE=19]="PERFORMANCE",t[t.DRAG=20]="DRAG",t[t.FLICK=21]="FLICK",t[t.KEYBOARD_NAVIGATION=22]="KEYBOARD_NAVIGATION",t[t.ZOOM=23]="ZOOM",t[t.VIEWPORT_SCALE=24]="VIEWPORT_SCALE",t[t.TEXT_HIGHLIGHT=25]="TEXT_HIGHLIGHT",t[t.DEAD_CLICK=30]="DEAD_CLICK",t[t.DEAD_ZOOM=31]="DEAD_ZOOM",t[t.PAGE_RELOAD=32]="PAGE_RELOAD",t[t.THRASHED_CURSOR=33]="THRASHED_CURSOR",t[t.BLANK_PAGE=34]="BLANK_PAGE",t[t.EXTERNAL_EVENT=35]="EXTERNAL_EVENT",t[t.SUBMIT=36]="SUBMIT"}(ta||(ta={})),function(t){t.SUCCESS="success",t.FAILURE="failure",t.ATTEMPT="attempt"}(ea||(ea={}));class ia{static build(t,e,s){return csArray.prototype.reduce.call(s,((e,s)=>s.enhanceAnalysisEvent(t,e)),e)}}class na{constructor(t,e,s){this.el=t,this.il=e,this.Bo=s}processGesture(t,e){switch(t.type){case Ir.TAP:this.nl(e);break;case Ir.FLICK:this.rl(t,e);break;case Ir.DRAG:this.ol(t,e)}}nl(t){const e={type:ta.TAP,ts:0,x:0,y:0,tgt:""},s=ia.build(t,e,this.el);s.tgt!==zt.INVALID_ELEMENT&&this.ur(s)}ol(t,e){var s,i;const n={type:ta.DRAG,ts:0,fd:t.direction,tgt:""};(null===(s=this.Bo)||void 0===s?void 0:s.collectGestureDistance)&&(n.distance=t.distance),(null===(i=this.Bo)||void 0===i?void 0:i.collectGestureVelocity)&&(n.velocity=t.velocity);const r=ia.build(e,n,this.el);r.tgt!==zt.INVALID_ELEMENT&&this.ur(r)}rl(t,e){var s,i;const n={type:ta.FLICK,ts:0,fd:t.direction,tgt:""};(null===(s=this.Bo)||void 0===s?void 0:s.collectGestureDistance)&&(n.distance=t.distance),(null===(i=this.Bo)||void 0===i?void 0:i.collectGestureVelocity)&&(n.velocity=t.velocity);const r=ia.build(e,n,this.el);r.tgt!==zt.INVALID_ELEMENT&&this.ur(r)}onEvent(t){this.ur=t}start(){this.il.subscribe(na.hl,((t,e)=>this.processGesture(t,e)))}stop(){this.il.unsubscribe(na.hl)}}na.hl="AnalysisGestureTracker",as([os()],na.prototype,"processGesture",null);class ra{constructor(e,s,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:["submit"];this.el=e,this.cl=s,this.al=i,this.ul=n,this.ll="select, select *, input, textarea",this.dl="select, select *, input, textarea",this.pl="a, a *, button, button *, select, select *, input, textarea",this.vl="input, select, textarea",this.ml="form",this.wl=150,this.gl=400,this.yl=!1,this.El=mo(((t,e)=>this.scrollListener(t,e)),this.wl),this.Al=mo((t=>this.resizeListener(t)),this.wl),this._l=Ls((t=>this.mouseMoveListener(t)),this.gl),this.Rl=[{boundElement:window,type:"resize",listener:()=>this.Al()},{boundElement:document,type:"scroll",listener:t=>this.El(t)},{boundElement:window,type:"mousemove",listener:t=>{this._l(function(t){return t.composedPath&&Object.defineProperty(t,"__csOriginalTarget",{value:t.composedPath()[0],writable:!1,enumerable:!1}),t}(t))}},{boundElement:document,type:"mousedown",listener:t=>this.mouseDownListener(t)},{boundElement:document,type:"mouseup",listener:t=>this.mouseUpListener(t)},{boundElement:document,type:"click",listener:t=>this.clickListener(t)}],this.Sl=[{type:"change",listener:this.al.on(this.dl,(t=>this.changeListener(t)))},{type:"submit",listener:this.al.on(this.ml,(t=>this.submitListener(t)))}],this.Tl=[{boundElement:document,type:"mouseover",listener:this.al.on(this.pl,(t=>this.mouseOverListener(t)))},{boundElement:document,type:"mouseout",listener:this.al.on(this.pl,(t=>this.mouseOutListener(t)))},{boundElement:document,type:"focusin",listener:this.al.on(this.ll,(t=>this.focusInListener(t)))},{boundElement:document,type:"focusout",listener:this.al.on(this.ll,(t=>this.focusOutListener(t)))},{boundElement:document,type:"keyup",listener:this.al.on(this.vl,(t=>this.keyUpListener(t)))},{boundElement:document,type:"keydown",listener:this.al.on(this.vl,(t=>this.keyDownListener(t)))},{boundElement:document,type:"copy",listener:this.al.on(this.vl,(t=>this.copyListener(t)))},{boundElement:document,type:"cut",listener:this.al.on(this.vl,(t=>this.cutListener(t)))},{boundElement:document,type:"paste",listener:this.al.on(this.vl,(t=>this.pasteListener(t)))},...csArray.prototype.map.call(this.Sl,(e=>t._objectSpread2(t._objectSpread2({},e),{},{boundElement:document})))],this.fe={},this.xe=(t,e)=>{switch(e){case"initial":case"added":this.ee(t);break;case"removed":this.ie(t)}},this.se=new Is(this.xe),this.oe()}ee(e){if(V(e)){const t=this.Il();csArray.prototype.forEach.call(t,(t=>Os(t)))}else{const s=this.Pl();csArray.prototype.forEach.call(s,(s=>{Os(t._objectSpread2(t._objectSpread2({},s),{},{boundElement:e}))}))}}ie(e){if(V(e)){const t=this.Il();csArray.prototype.forEach.call(t,(t=>Ps(t)))}else{const s=this.Pl();csArray.prototype.forEach.call(s,(s=>{Ps(t._objectSpread2(t._objectSpread2({},s),{},{boundElement:e}))}))}}onEvent(t){this.ur=t}start(){this.se.observe(),this.ee(document),this.resizeListener()}stop(){this.ie(document),this.se.disconnect()}flushPendingDebouncedListeners(){this.El.flushPending(),this.Al.flushPending()}bl(t){return csArray.prototype.some.call(this.ul,(e=>e===t))}Pl(){return this.al.isMatchesSelectorSupported()?csArray.prototype.filter.call(this.Sl,(t=>!this.bl(t.type))):(ns.warn("Element.matches is not implemented yet"),[])}Il(){const t=[];return csArray.prototype.push.call(t,...this.Rl),this.al.isMatchesSelectorSupported()?csArray.prototype.push.call(t,...this.Tl):ns.warn("Element.matches is not implemented yet"),csArray.prototype.filter.call(t,(t=>!this.bl(t.type)))}resizeListener(t){const e=zs.getScrollContainer(),s=A(e);s&&(this.yl=!0);const i={type:ta.RESIZE,ts:0,x:s?e.clientWidth:Ot.windowWidth(),y:s?e.clientHeight:Ot.windowHeight()};void 0!==t&&(i.d=t),this.ur(i)}scrollListener(t,e){const s=zs.isEventOnScrollContainer(e);!this.yl&&s&&this.resizeListener();const i={type:ta.SCROLL,ts:0,x:s?csEventtarget.apply(e).scrollLeft:Ot.windowOffsetX(),y:s?csEventtarget.apply(e).scrollTop:Ot.windowOffsetY(),d:t},n=ia.build(e,i,this.el);this.ur(n)}mouseMoveListener(t){const e={type:ta.MOUSEMOVE,ts:0,x:t.pageX,y:t.pageY},s=ia.build(t,e,this.el);this.ur(s)}mouseDownListener(t){const e={type:ta.MOUSEDOWN,ts:0,x:t.pageX,y:t.pageY,tgt:""},s=ia.build(t,e,this.el);this.Vl(s)}mouseUpListener(t){const e={type:ta.MOUSEUP,ts:0,x:t.pageX,y:t.pageY,tgt:""},s=ia.build(t,e,this.el);this.Vl(s)}clickListener(t){const e={type:ta.CLICK,ts:0,x:t.pageX,y:t.pageY,tgt:""},s=ia.build(t,e,this.el);this.Vl(s)}mouseOverListener(t){const e={type:ta.MOUSEOVER,ts:0,x:t.pageX,y:t.pageY,tgt:""},s=ia.build(t,e,this.el);this.Vl(s)}mouseOutListener(t){const e={type:ta.MOUSEOUT,ts:0,x:t.pageX,y:t.pageY,tgt:this.cl.getEventTargetPath(t)},s=ia.build(t,e,this.el);this.Vl(s)}focusInListener(t){const e={type:ta.FOCUSIN,ts:0,tgt:this.cl.getEventTargetPath(t)},s=ia.build(t,e,this.el);this.Vl(s)}focusOutListener(t){const e={type:ta.FOCUSOUT,ts:0,tgt:this.cl.getEventTargetPath(t)},s=ia.build(t,e,this.el);this.Vl(s)}changeListener(t){const e={type:ta.CHANGE,ts:0,tgt:""},s=ia.build(t,e,this.el);this.Vl(s)}submitListener(t){const e={type:ta.SUBMIT,ts:0,tgt:""},s=ia.build(t,e,this.el);this.Vl(s)}copyListener(t){const e={type:ta.COMMAND,ts:0,tgt:this.cl.getEventTargetPath(t),key:Bs.COPY};this.Vl(e)}cutListener(t){const e={type:ta.COMMAND,ts:0,tgt:this.cl.getEventTargetPath(t),key:Bs.CUT};this.Vl(e)}pasteListener(t){const e={type:ta.COMMAND,ts:0,tgt:this.cl.getEventTargetPath(t),key:Bs.PASTE};this.Vl(e)}keyUpListener(t){const e={type:ta.KEYUP,ts:0,tgt:this.cl.getEventTargetPath(t),key:this.Cl(t)};this.Vl(e)}keyDownListener(t){const e={type:ta.KEYDOWN,ts:0,tgt:this.cl.getEventTargetPath(t),key:this.Cl(t)};this.Vl(e)}Cl(t){const e=this.fe[t.key];return void 0===e?Vs.ALPHANUMERICAL:e}Vl(t){sa(t)&&t.tgt!==zt.INVALID_ELEMENT&&this.ur(t)}oe(){this.fe[" "]=Vs.SPACE,this.fe.Spacebar=Vs.SPACE,this.fe.Enter=Vs.ENTER,this.fe.Backspace=Vs.BACKSPACE,this.fe.Delete=Vs.DELETE,this.fe.ArrowUp=Vs.ARROWUP,this.fe.ArrowDown=Vs.ARROWDOWN,this.fe.ArrowLeft=Vs.ARROWLEFT,this.fe.ArrowRight=Vs.ARROWRIGHT,this.fe.Up=Vs.ARROWUP,this.fe.Down=Vs.ARROWDOWN,this.fe.Left=Vs.ARROWLEFT,this.fe.Right=Vs.ARROWRIGHT,this.fe.CapsLock=Vs.CAPSLOCK,this.fe.Shift=Vs.SHIFT,this.fe.Tab=Vs.TAB}}as([yt("Event handler type: resize")],ra.prototype,"resizeListener",null),as([yt("Event handler type: scroll")],ra.prototype,"scrollListener",null),as([yt("Event handler type: mouseMove"),os()],ra.prototype,"mouseMoveListener",null),as([yt("Event handler type: mouseDown"),os()],ra.prototype,"mouseDownListener",null),as([yt("Event handler type: mouseUp"),os()],ra.prototype,"mouseUpListener",null),as([yt("Event handler type: click"),os()],ra.prototype,"clickListener",null),as([yt("Event handler type: mouseOver"),os()],ra.prototype,"mouseOverListener",null),as([yt("Event handler type: mouseOut"),os()],ra.prototype,"mouseOutListener",null),as([yt("Event handler type: focusIn")],ra.prototype,"focusInListener",null),as([yt("Event handler type: focusOut")],ra.prototype,"focusOutListener",null),as([yt("Event handler type: change")],ra.prototype,"changeListener",null),as([yt("Event handler type: submit"),os()],ra.prototype,"submitListener",null),as([yt("Event handler type: copy")],ra.prototype,"copyListener",null),as([yt("Event handler type: cut")],ra.prototype,"cutListener",null),as([yt("Event handler type: paste")],ra.prototype,"pasteListener",null),as([yt("Event handler type: keyup")],ra.prototype,"keyUpListener",null),as([yt("Event handler type: keydown")],ra.prototype,"keyDownListener",null);class oa{constructor(){this.kl=100,this.Ol=0,this.Nl=Ot.documentHeight(),this.xl={boundElement:document,type:"scroll",listener:t=>this.maxScrollRateListener(t)},this.Ol=this.$l(zs.getScrollContainer()).maxScrollRate}onEvent(t){this.ur=t}start(){Os(this.xl)}stop(){Ps(this.xl)}reset(){const t=zs.getScrollContainer(),{maxScrollRate:e,maxDocumentHeight:s}=this.$l(t);this.Nl=s,this.Ol=e,this.ur()}$l(t){let e=0,s=0;if(null===t)s=Ot.documentHeight(),e=this.Ml(s);else{const i=this.Ll(t);s=this.Dl(t,i),e=this.Ul(t,i)}return{maxScrollRate:e,maxDocumentHeight:s}}maxScrollRateListener(t){let e=null;zs.isEventOnScrollContainer(t)&&(e=csEventtarget.apply(t));const{maxScrollRate:s,maxDocumentHeight:i}=this.$l(e);(s>this.Ol||i>this.Nl)&&(this.Ol=s,i>this.Nl&&(this.Nl=i),this.ur())}Ml(t){const e=Math.round(this.Fl()/t*100);return Math.min(e,this.kl)}Fl(){const t=Ot.windowHeight();return Ot.windowOffsetY()+t}Ul(t,e){const s=t.scrollTop+t.clientHeight+t.getBoundingClientRect().top+e,i=this.Dl(t,e),n=Math.round(s/i*100);return Math.min(n,this.kl)}Ll(t){const e=window.getComputedStyle(t).paddingTop||"0px";return parseInt(e,10)}Dl(t,e){return t.scrollHeight+t.getBoundingClientRect().top+e}getRequestParameters(){return{sr:`${this.Ol}`,mdh:`${this.Nl}`}}}as([yt("MaxScrollRate handler")],oa.prototype,"maxScrollRateListener",null);class aa{constructor(t,e,s,i,n,r,o,a,c,h,l,d,u,p,g,m,y,f,v,E,S){this.wt=t,this.Bl=e,this.il=s,this.ql=i,this.Hl=n,this.zl=r,this.jl=o,this.Gl=a,this.Ki=c,this.Is=h,this.Zl=l,this.Wl=d,this.In=u,this.nn=p,this.Ql=g,this.Jl=m,this.Kl=y,this.Yl=f,this.Xl=v,this.td=E,this.sd=S,this.wn=new ii,this.nd=!1}init(){var t,e,s,i,n,r,o;this.Bl.onEvent((t=>this.Rn(t))),this.il.onEvent((t=>this.Rn(t))),this.ql.onEvent((()=>{const t=this.ql.getRequestParameters();this.nn.setQueryParams(t),this.jl.setQueryParams(t)})),this.Wl.onEvent((t=>this.rd(t))),this.od(),null===(t=this.Ql)||void 0===t||t.onEvent((t=>this.Rn(t))),null===(e=this.Xl)||void 0===e||e.onEvent((t=>this.Rn(t))),null===(s=this.Jl)||void 0===s||s.onEvent((t=>this.Rn(t))),null===(i=this.Kl)||void 0===i||i.onEvent((t=>this.Rn(t))),this.ad(),null===(n=this.Yl)||void 0===n||n.onEvent((t=>this.rd(t))),null===(r=this.td)||void 0===r||r.onEvent((t=>this.rd(t))),null===(o=this.sd)||void 0===o||o.onEvent((t=>this.rd(t)))}ad(){this.jl.onBeaconSuccess((()=>{this.zl.clearEvents()})),this.jl.onBeaconFailure((t=>{this.ud(t)}))}initStates(){const t=this.Gl.getRequestParameters(),e=this.Hl.getRequestParameters(),s=this.ql.getRequestParameters();this.nn.setQueryParams(t),this.nn.setQueryParams(e),this.nn.setQueryParams(s),this.jl.setQueryParams(t),this.jl.setQueryParams(e),this.jl.setQueryParams(s),this.ld()}clearStates(t){var e,s;this.Bl.flushPendingDebouncedListeners(),null===(e=this.Jl)||void 0===e||e.flushPendingKeyboardNavigationEvent(),null===(s=this.Kl)||void 0===s||s.flushPendingTextHighlightEvent(),t?(this.dd(),this.sendLastMessageBeacon()):this.sendEvents(),this.ql.reset(),this.nn.removeQueryParams()}start(t){var e,s,i,n,r,o,a;t||null===(e=this.Yl)||void 0===e||e.start(),this.In.start(),this.Bl.start(),this.ql.start(),this.il.start(),null===(s=this.Ql)||void 0===s||s.start(),null===(i=this.Kl)||void 0===i||i.start(),t||this.Wl.start(),null===(n=this.Jl)||void 0===n||n.start(),null===(r=this.Xl)||void 0===r||r.start(),null===(o=this.td)||void 0===o||o.start(),null===(a=this.sd)||void 0===a||a.start()}collectInitialEvents(){var t;null===(t=this.Ql)||void 0===t||t.collectInitialEvents()}onIframeAnalysisBrowserEvent(t){this.rd(t)}onIframeAnalysisUserEvent(t){this.Rn(t)}onExternalEvent(t){this.Nn(t)}rd(t){this.Ki.isCurrentPageviewValid()&&this.Nn(t)}Rn(t){this.Ki.refreshSession(),this.Ki.isSessionValid()&&this.Nn(t)}Nn(e){this.zl.addEvent(this.pd(e)),this.zl.isFull()&&this.sendEvents(),this.wt.emitDebugEvents&&this.wn.emit("analysisEvent",t._objectSpread2(t._objectSpread2({},e),{},{typeName:ta[e.type]}))}pd(t){return t.ts=this.vd(),t}dd(){this.jl.setQueryParams({hlm:"true"}),this.nd=!0}sendLastMessageBeacon(){this.jl.setQueryParams(this.Hl.getRequestParameters()),this.jl.send(this.zl.stringifyEvents()),this.jl.removeQueryParams(["hlm"]),this.nd=!1}sendEvents(){this.zl.isEmpty()||(this.nn.setQueryParams(this.Gl.getRequestParameters()),this.nn.setQueryParams(this.Hl.getRequestParameters()),this.nn.send(this.zl.getEvents()),this.zl.clearEvents())}stop(){var t,e,s,i,n,r,o;this.In.stop(),this.Bl.stop(),this.ql.stop(),this.il.stop(),this.Wl.stop(),null===(t=this.Ql)||void 0===t||t.stop(),null===(e=this.Jl)||void 0===e||e.stop(),null===(s=this.Kl)||void 0===s||s.stop(),null===(i=this.Xl)||void 0===i||i.stop(),this.zl.empty(),null===(n=this.Yl)||void 0===n||n.stop(),null===(r=this.td)||void 0===r||r.stop(),null===(o=this.sd)||void 0===o||o.stop()}ld(){this.md=Ie()}vd(){return Ie()-this.md}od(){this.In.onEvent((t=>{var e,s;t!==Tn.Visible&&(null===(e=this.Jl)||void 0===e||e.flushPendingKeyboardNavigationEvent(),null===(s=this.Kl)||void 0===s||s.flushPendingTextHighlightEvent(),t===Tn.PagehideVisible?this.dd():t===Tn.PagehideHidden?(this.dd(),this.sendLastMessageBeacon()):this.zl.isEmpty()&&!this.nd||this.sendLastMessageBeacon())}))}ud(t){try{this.zl.isEmpty()&&!this.nd||this.Is.save({requestParameters:t,events:this.zl.getEvents()})}catch(t){}}pushSubmitCommandEvent(t,e){if(!function(t){return t===ea.SUCCESS||t===ea.FAILURE||t===ea.ATTEMPT}(t))return void ns.warn(`AnalysisEvents Service: invalid submit status: ${t}`);if(!A(e))return void ns.warn(`AnalysisEvents Service: invalid element: ${e}`);const s={status:t,type:ta.SUBMIT_COMMAND,ts:0,tgt:this.Zl.getElementPath(e)};s.tgt!==zt.INVALID_ELEMENT&&this.rd(s)}}class ca{constructor(t,e){this.Is=t,this.nn=e,this.wd=()=>{"visible"===document.visibilityState&&this.gd()}}start(){this.gd(),this.Vi()}stop(){this.Ni()}getRecoveryStorage(){return this.Is}gd(){const t=this.Is.recover();if(null!==t){const{requestParameters:e,events:s}=t;this.nn.send(s,e)}}Vi(){document.addEventListener("visibilitychange",this.wd)}Ni(){document.removeEventListener("visibilitychange",this.wd)}}class ha{constructor(t){this.ro=t}save(t){localStorage.setItem(this.ro,csJSON.stringify(t))}clear(){localStorage.removeItem(this.ro)}recover(){const t=localStorage.getItem(this.ro);if(null===t)return null;let e=null;try{e=csJSON.parse(t)}catch(e){ns.error(`Invalid item in localStorage.\n         (key:${this.ro}; value:${t})`)}finally{this.clear()}return e}}class la{constructor(t){this.yd=t,this.Ed=t=>this.processMetric(t),this.Ti=!1}onEvent(t){this.ur=t}start(){this.Ti||(this.Ti=!0,this.yd.onFCP(this.Ed),this.yd.onCLS(this.Ed),this.yd.onFID(this.Ed),this.yd.onLCP(this.Ed),this.yd.onTTFB(this.Ed),this.yd.onINP(this.Ed))}stop(){this.Ti=!1}processMetric(t){if(!this.Ti)return;const e={type:ta.PERFORMANCE,name:t.name,val:t.value,ts:0};this.ur(e)}}as([yt("Performance metric handler")],la.prototype,"processMetric",null);var da,ua,pa,ga,ma,ya,fa,va=-1,Ea=function(t){addEventListener("pageshow",(function(e){e.persisted&&(va=e.timeStamp,t(e))}),!0)},Sa=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},wa=function(){var t=Sa();return t&&t.activationStart||0},Ra=function(t,e){var s=Sa(),i="navigate";return va>=0?i="back-forward-cache":s&&(document.prerendering||wa()>0?i="prerender":document.wasDiscarded?i="restore":s.type&&(i=s.type.replace(/_/g,"-"))),{name:t,value:void 0===e?-1:e,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:i}},Aa=function(t,e,s){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var i=new PerformanceObserver((function(t){Promise.resolve().then((function(){e(t.getEntries())}))}));return i.observe(Object.assign({type:t,buffered:!0},s||{})),i}}catch(t){}},ba=function(t,e,s,i){var n,r;return function(o){e.value>=0&&(o||i)&&((r=e.value-(n||0))||void 0===n)&&(n=e.value,e.delta=r,e.rating=function(t,e){return t>e[1]?"poor":t>e[0]?"needs-improvement":"good"}(e.value,s),t(e))}},Ta=function(t){requestAnimationFrame((function(){return requestAnimationFrame((function(){return t()}))}))},Ca=function(t){var e=function(e){"pagehide"!==e.type&&"hidden"!==document.visibilityState||t(e)};addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0)},_a=function(t){var e=!1;return function(s){e||(t(s),e=!0)}},Na=-1,Ia=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},Oa=function(t){"hidden"===document.visibilityState&&Na>-1&&(Na="visibilitychange"===t.type?t.timeStamp:0,ka())},Pa=function(){addEventListener("visibilitychange",Oa,!0),addEventListener("prerenderingchange",Oa,!0)},ka=function(){removeEventListener("visibilitychange",Oa,!0),removeEventListener("prerenderingchange",Oa,!0)},La=function(){return Na<0&&(Na=Ia(),Pa(),Ea((function(){setTimeout((function(){Na=Ia(),Pa()}),0)}))),{get firstHiddenTime(){return Na}}},Ma=function(t){document.prerendering?addEventListener("prerenderingchange",(function(){return t()}),!0):t()},Da=[1800,3e3],xa=function(t,e){e=e||{},Ma((function(){var s,i=La(),n=Ra("FCP"),r=Aa("paint",(function(t){t.forEach((function(t){"first-contentful-paint"===t.name&&(r.disconnect(),t.startTime<i.firstHiddenTime&&(n.value=Math.max(t.startTime-wa(),0),n.entries.push(t),s(!0)))}))}));r&&(s=ba(t,n,Da,e.reportAllChanges),Ea((function(i){n=Ra("FCP"),s=ba(t,n,Da,e.reportAllChanges),Ta((function(){n.value=performance.now()-i.timeStamp,s(!0)}))})))}))},Ua=[.1,.25],Va={passive:!0,capture:!0},Ba=new Date,Ha=function(t,e){da||(da=e,ua=t,pa=new Date,za(removeEventListener),$a())},$a=function(){if(ua>=0&&ua<pa-Ba){var t={entryType:"first-input",name:da.type,target:da.target,cancelable:da.cancelable,startTime:da.timeStamp,processingStart:da.timeStamp+ua};ga.forEach((function(e){e(t)})),ga=[]}},qa=function(t){if(t.cancelable){var e=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,e){var s=function(){Ha(t,e),n()},i=function(){n()},n=function(){removeEventListener("pointerup",s,Va),removeEventListener("pointercancel",i,Va)};addEventListener("pointerup",s,Va),addEventListener("pointercancel",i,Va)}(e,t):Ha(e,t)}},za=function(t){["mousedown","keydown","touchstart","pointerdown"].forEach((function(e){return t(e,qa,Va)}))},Fa=[100,300],ja=0,Ga=1/0,Wa=0,Ya=function(t){t.forEach((function(t){t.interactionId&&(Ga=Math.min(Ga,t.interactionId),Wa=Math.max(Wa,t.interactionId),ja=Wa?(Wa-Ga)/7+1:0)}))},Qa=function(){return ma?ja:performance.interactionCount||0},Za=[200,500],Xa=0,Ka=function(){return Qa()-Xa},Ja=[],tc={},ec=function(t){var e=Ja[Ja.length-1],s=tc[t.interactionId];if(s||Ja.length<10||t.duration>e.latency){if(s)s.entries.push(t),s.latency=Math.max(s.latency,t.duration);else{var i={id:t.interactionId,latency:t.duration,entries:[t]};tc[i.id]=i,Ja.push(i)}Ja.sort((function(t,e){return e.latency-t.latency})),Ja.splice(10).forEach((function(t){delete tc[t.id]}))}},sc=[2500,4e3],ic={},nc=[800,1800],rc=function t(e){document.prerendering?Ma((function(){return t(e)})):"complete"!==document.readyState?addEventListener("load",(function(){return t(e)}),!0):setTimeout(e,0)},oc=function(t,e){e=e||{};var s=Ra("TTFB"),i=ba(t,s,nc,e.reportAllChanges);rc((function(){var n=Sa();if(n){var r=n.responseStart;if(r<=0||r>performance.now())return;s.value=Math.max(r-wa(),0),s.entries=[n],i(!0),Ea((function(){s=Ra("TTFB",0),(i=ba(t,s,nc,e.reportAllChanges))(!0)}))}}))};class ac{onFCP(t){xa(t,{reportAllChanges:!0})}onCLS(t){!function(t,e){e=e||{},xa(_a((function(){var s,i=Ra("CLS",0),n=0,r=[],o=function(t){t.forEach((function(t){if(!t.hadRecentInput){var e=r[0],s=r[r.length-1];n&&t.startTime-s.startTime<1e3&&t.startTime-e.startTime<5e3?(n+=t.value,r.push(t)):(n=t.value,r=[t])}})),n>i.value&&(i.value=n,i.entries=r,s())},a=Aa("layout-shift",o);a&&(s=ba(t,i,Ua,e.reportAllChanges),Ca((function(){o(a.takeRecords()),s(!0)})),Ea((function(){n=0,i=Ra("CLS",0),s=ba(t,i,Ua,e.reportAllChanges),Ta((function(){return s()}))})),setTimeout(s,0))})))}(t,{reportAllChanges:!0})}onFID(t){!function(t,e){e=e||{},Ma((function(){var s,i=La(),n=Ra("FID"),r=function(t){t.startTime<i.firstHiddenTime&&(n.value=t.processingStart-t.startTime,n.entries.push(t),s(!0))},o=function(t){t.forEach(r)},a=Aa("first-input",o);s=ba(t,n,Fa,e.reportAllChanges),a&&Ca(_a((function(){o(a.takeRecords()),a.disconnect()}))),a&&Ea((function(){var i;n=Ra("FID"),s=ba(t,n,Fa,e.reportAllChanges),ga=[],ua=-1,da=null,za(addEventListener),i=r,ga.push(i),$a()}))}))}(t,{reportAllChanges:!0})}onLCP(t){!function(t,e){e=e||{},Ma((function(){var s,i=La(),n=Ra("LCP"),r=function(t){var e=t[t.length-1];e&&e.startTime<i.firstHiddenTime&&(n.value=Math.max(e.startTime-wa(),0),n.entries=[e],s())},o=Aa("largest-contentful-paint",r);if(o){s=ba(t,n,sc,e.reportAllChanges);var a=_a((function(){ic[n.id]||(r(o.takeRecords()),o.disconnect(),ic[n.id]=!0,s(!0))}));["keydown","click"].forEach((function(t){addEventListener(t,(function(){return setTimeout(a,0)}),!0)})),Ca(a),Ea((function(i){n=Ra("LCP"),s=ba(t,n,sc,e.reportAllChanges),Ta((function(){n.value=performance.now()-i.timeStamp,ic[n.id]=!0,s(!0)}))}))}}))}(t,{reportAllChanges:!0})}onTTFB(t){oc(t,{reportAllChanges:!0})}onINP(t){!function(t,e){e=e||{},Ma((function(){var s;"interactionCount"in performance||ma||(ma=Aa("event",Ya,{type:"event",buffered:!0,durationThreshold:0}));var i,n=Ra("INP"),r=function(t){t.forEach((function(t){t.interactionId&&ec(t),"first-input"===t.entryType&&!Ja.some((function(e){return e.entries.some((function(e){return t.duration===e.duration&&t.startTime===e.startTime}))}))&&ec(t)}));var e,s=(e=Math.min(Ja.length-1,Math.floor(Ka()/50)),Ja[e]);s&&s.latency!==n.value&&(n.value=s.latency,n.entries=s.entries,i())},o=Aa("event",r,{durationThreshold:null!==(s=e.durationThreshold)&&void 0!==s?s:40});i=ba(t,n,Za,e.reportAllChanges),o&&("PerformanceEventTiming"in window&&"interactionId"in PerformanceEventTiming.prototype&&o.observe({type:"first-input",buffered:!0}),Ca((function(){r(o.takeRecords()),n.value<0&&Ka()>0&&(n.value=0,n.entries=[]),i(!0)})),Ea((function(){Ja=[],Xa=Qa(),n=Ra("INP"),i=ba(t,n,Za,e.reportAllChanges)})))}))}(t,{reportAllChanges:!0})}}class cc{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.we=t}stringifyEvents(){return csJSON.stringify(this.we)}addEvent(t){csArray.prototype.push.call(this.we,t)}eventsCount(){return this.we.length}clearEvents(){this.we=[]}empty(){this.clearEvents()}isFull(){return this.eventsCount()>=50}isEmpty(){return 0===this.we.length}getEvents(){return this.we}}class hc{isEventTypeSupported(t){return-1!==csArray.prototype.indexOf.call(this.supportedEventTypes,t)}enhanceAnalysisEvent(t,e){return this.isEventTypeSupported(e.type)?this.baseEnhanceAnalysisEvent(t,e):e}}class lc extends hc{constructor(){super(...arguments),this.supportedEventTypes=[ta.CHANGE],this.Ad=["text","email","number","search","tel","url","password"]}baseEnhanceAnalysisEvent(t,e){const s=Hs(t);return k(s)&&csArray.prototype.indexOf.call(this.Ad,s.type)>=0&&(e.isBlank=""===s.value),e}}class dc extends hc{constructor(t){super(),this.cl=t,this.supportedEventTypes=[ta.MOUSEDOWN,ta.MOUSEUP,ta.CLICK,ta.MOUSEOVER,ta.TAP,ta.DRAG,ta.FLICK,ta.SUBMIT,ta.CHANGE]}baseEnhanceAnalysisEvent(t,e){return e.tgt||(e.tgt=this.cl.getEventTargetPath(t)),e}}!function(t){t.getRelativePosition=function(t){const e=Hs(t);if(!(e&&C(e)&&R(e.getBoundingClientRect)&&w(t.pageX)&&w(t.pageY)))return{xRel:-1,yRel:-1,valid:!1};const s=e.getBoundingClientRect();let i=t.pageX-s.left-Ot.windowOffsetX(),n=t.pageY-s.top-Ot.windowOffsetY();e!==document.documentElement&&(i+=e.scrollLeft,n+=e.scrollTop);const r=Math.max(e.scrollWidth,s.width),o=Math.max(e.scrollHeight,s.height);return{xRel:Math.round(i/r*65535),yRel:Math.round(n/o*65535),valid:!0}}}(ya||(ya={}));class uc extends hc{constructor(t,e){super(),this.Y=t,this.cl=e,this.supportedEventTypes=[ta.MOUSEMOVE,ta.CLICK],this._d=""}baseEnhanceAnalysisEvent(t,e){const{valid:s,xRel:i,yRel:n}=ya.getRelativePosition(t);if(s){const s=this.cl.getEventTargetPath(t);s!==zt.INVALID_ELEMENT&&(e.xRel=i,e.yRel=n,e.type===ta.MOUSEMOVE&&(s!==this._d||this.Y.iframesTracking?(this._d=s,e.tgtHM=s):e.tgtHM=""))}else e.type===ta.MOUSEMOVE&&(this._d="");return e}}!function(t){t[t.ANONYMIZED=0]="ANONYMIZED",t[t.CAPTURED=1]="CAPTURED",t[t.MASKED=2]="MASKED",t[t.ENCRYPTED=3]="ENCRYPTED"}(fa||(fa={}));class pc extends hc{constructor(t,e,s){super(),this.wt=t,this.Rd=e,this.gt=s,this.supportedEventTypes=[ta.TAP,ta.CLICK]}Sd(t){let e="";const s=document.createTreeWalker(t,NodeFilter.SHOW_TEXT);let i=s.nextNode();for(;i;){if(e+=i.textContent,this.Rd.getElementSensitiveStatus(i.parentElement)!==fa.CAPTURED)return!0;if(csString.prototype.trim.call(e).length>=100)break;i=s.nextNode()}return!1}baseEnhanceAnalysisEvent(t,e){if(A(csEventtarget.apply(t))){const s=Xs(csEventtarget.apply(t),"button,a");if(s&&f(s.textContent)&&!this.Sd(s)&&!this.gt.hasPII(s.textContent,this.wt.anonymizeDigits)){const t=bn.truncate(csString.prototype.trim.call(s.textContent),100);t.length>0&&(e.text=t)}}return e}}function gc(t,e,s){const i=[];return t.mouseMoveHeatmapEnabled&&csArray.prototype.push.call(i,new uc(t,e)),t.isClickedElementTextEnabled()&&csArray.prototype.push.call(i,new pc(t,s,new Re)),csArray.prototype.push.call(i,new lc,new dc(e)),i}function mc(t,e,s){const i=[];return t.isClickedElementTextEnabled()&&csArray.prototype.push.call(i,new pc(t,s,new Re)),csArray.prototype.push.call(i,new dc(e)),i}const yc="v2/events",fc=["submit"];class vc{constructor(t,e,s,i,n,r,o,a,c,h,l,d){this.wt=t,this.Ca=e,this.bt=s,this.Zl=i,this.al=n,this.Za=r,this.Ki=o,this.il=a,this.Cu=c,this.Xa=h,this.Td=l,this.Rd=d}init(){const t=new cc,e=this.Xa.create(`${this.wt.getTrackerUri()}/${yc}`,!0,"base64");this.Id=this.Pd(e),this.bd=this.Vd(t,this.Id.getRecoveryStorage(),e),this.bd.init(),this.Td.addListener(this.bd),this.Cu.addListener(this.bd),this.Za.register(fc,((t,e)=>{this.bd.pushSubmitCommandEvent(t,e)}))}onStartTracking(t){this.Id.start(),this.bd.start(t)}onAfterNaturalPageView(){this.bd.initStates()}onAfterArtificialPageView(){this.bd.initStates(),this.bd.collectInitialEvents()}onArtificialPageViewEnd(){this.bd.clearStates(!0)}onBeforeSessionRenewal(){this.bd.clearStates(),this.bd.stop(),this.Id.stop()}onOptout(){this.bd.stop(),this.Id.stop()}Vd(t,e,s){const i=new Jo(window),n=new oa,r=gc(this.wt,this.Zl,this.Rd),o=[];this.wt.collectHierarchy||csArray.prototype.push.call(o,"submit");const a=new ra(r,this.Zl,this.al,o),c=mc(this.wt,this.Zl,this.Rd),h=new na(c,this.il),l=new la(new ac),d=new Vn,u=new Yn(`${this.wt.getTrackerUri()}/${yc}`),p=new qn(this.Ca,this.bt);return new aa(this.wt,a,h,n,i,t,u,p,this.Ki,e,this.Zl,l,d,s,void 0,void 0,void 0,void 0,void 0,void 0,void 0)}Pd(t){return new ca(new ha("csAnalysisEventsPersisted"),t)}}var Ec;!function(t){t.Artificial="a",t.Renewal="r",t.Natural="n"}(Ec||(Ec={}));class Sc extends ni{constructor(t,e,s,i,n){super(),this.ha=t,this.Td=e,this.Cd=s,this.Nt=i,this.mu=n}init(){this.kd()}onStart(t){t?this.Od():this.Nd()}onStop(){}triggerArtificialPageView(t,e){this.isStarted?this.xd(t,e):w(t)&&this.Nt.overridePath(t,e),this.isStarted||(this.Td.emitTargetingRulesArtificialPageview(this.Nt.getUrl()),this.Nt.cleanupOverrideLifespan())}Nd(){this.mu.setPageViewType(Ec.Natural),this.ha.emitBeforeNaturalPageView(),this.Cd.send(),this.Nt.cleanupOverrideLifespan(),this.ha.emitAfterNaturalPageView()}Od(){this.mu.setPageViewType(Ec.Renewal),this.ha.emitBeforeNaturalPageView(),this.Cd.send(),this.ha.emitAfterNaturalPageView()}xd(t,e){this.mu.setPageViewType(Ec.Artificial),this.ha.emitArtificialPageViewEnd(),w(t)&&this.Nt.overridePath(t,e),this.ha.emitBeforeArtificialPageView(),this.Cd.send(),this.Nt.cleanupOverrideLifespan(),this.ha.emitAfterArtificialPageView()}kd(){window.addEventListener("pageshow",(t=>{this.isStarted&&t.persisted&&this.xd()}))}}const wc=window.navigator.language||window.navigator.userLanguage||window.navigator.browserLanguage||window.navigator.systemLanguage||"unknown";function Rc(){return{la:wc}}class Ac{constructor(t,e){this.uh=t,this.Qa=e,this.$d=!1}getRequestParameters(){return{dr:this.Md()}}addUrlMaskingPattern(t){this.Qa.addUrlMaskingPattern(t)}enableRemoveQueryString(){this.$d=!0}disableRemoveQueryString(){this.$d=!1}Md(){const t=this.$d?this.uh.removeQueryString(this.Ld()):this.Ld();return this.uh.anonymizeUrl(t,this.Qa.getUrlMaskingPatterns())}Ld(){let t="";try{t=window.top.document.referrer}catch(e){if(window.parent)try{t=window.parent.document.referrer}catch(e){t=""}}return""===t&&(t=document.referrer),"string"!=typeof t&&(t=""),t}}class bc{constructor(t){this.Vt=t,this.Dd=this.Ud()&&window.CSCurrentScript}Fd(){const t=window.CSCurrentScript;if(!t)return null;const e=window.performance.getEntriesByName(t.src,"resource")[0];return!e||this.Bd(e)?null:Math.round(e.responseEnd-e.fetchStart)}Bd(t){const e=t.transferSize;return void 0!==e?0===e||300===e||e<t.encodedBodySize:t.connectStart===t.domainLookupEnd}getRequestParameters(){if(!this.Dd||1!==this.qd())return{};const t=this.Fd();return null===t?{}:{dt:`${Math.min(t,99999)}`}}qd(){var t;return(null===(t=this.Vt.getSession())||void 0===t?void 0:t.pageNumber)||null}Ud(){return"object"==typeof window.performance&&"function"==typeof window.performance.getEntriesByName}}function Tc(t){const e=[],s=function(t){let e=t;return Yt(t,"/")&&(e=csString.prototype.substring.call(e,1)),De(t,"/")&&(e=csString.prototype.slice.call(e,0,-1)),e}(t),i=csString.prototype.split.call(s,"/");for(const t of i)Yt(t,":")?csArray.prototype.push.call(e,{key:t,value:`CS_ANONYMIZED_${csString.prototype.toUpperCase.call(csString.prototype.slice.call(t,1))}`}):csArray.prototype.push.call(e,{key:t,value:null});return e}class Cc{constructor(){this.Hd=new Set,this.zd=[],this.jd=new Set,this.Gd=[]}addUrlMaskingPattern(t){if(this.Hd.has(t))return;this.Hd.add(t);const e=Tc(t);csArray.prototype.push.call(this.zd,e)}getUrlMaskingPatterns(){return this.zd}resetPartialUrlMaskingPatterns(){this.jd.clear(),this.Gd=[]}addPartialUrlMaskingPattern(t){if(this.jd.has(t))return;this.jd.add(t);const e=Tc(t);csArray.prototype.push.call(this.Gd,e)}getPartialUrlMaskingPatterns(){return this.Gd}}const _c=["trackPageview"],Nc=["setPath"],Ic=["setQuery"],Oc=["referrer:maskUrl"],Pc=["referrer:removeQueryString"],kc=["referrer:keepQueryString"];class Lc{constructor(t,e,s,i,n,r,o,a,c,h,l,d,u,p,g){this.wt=t,this.Za=e,this.ha=s,this.Na=i,this.bt=n,this.Vt=r,this.Zd=o,this.Ms=a,this.uh=c,this.Nt=h,this.Ya=l,this.mu=d,this.Td=u,this.Wd=p,this.Qd=g}init(){var t;const e=new re(this.wt.getTrackerUri(),"pageview");this.Jd=new Sc(this.ha,this.Td,e,this.Nt,this.mu);const s=new Ac(this.uh,new Cc);this.Jd.init();const i=new qn(this.Na,this.bt,Ot,s,this.Nt,this.Zd,n,this.Ms,this.mu,new bc(this.Vt),this.Ya);this.Wd&&i.addProvider(this.Wd),this.Qd&&i.addProvider(this.Qd);const r=this.wt.isCsCrosswritingHeap();if(r||this.wt.isCsSideloadingHeap()||this.wt.isHeapSideloadsCs()){const e=null===(t=this.wt.heapEnvironment)||void 0===t?void 0:t.env_id;i.addProvider({getRequestParameters(){const t={cw:r?"1":"2"};return e&&(t.happid=e),t}})}e.setRequestParametersProviders(i),this.Za.register(_c,((t,e)=>{f(t)?this.Kd(e)?this.Jd.triggerArtificialPageView(t,e):this.Jd.triggerArtificialPageView(t):this.Jd.triggerArtificialPageView()})),this.Za.register(Nc,((t,e)=>{f(t)&&(this.Kd(e)?this.Nt.overridePath(t,e):this.Nt.overridePath(t))})),this.Za.register(Ic,((t,e)=>{f(t)&&(this.Kd(e)?this.Nt.overrideQuery(t,e):this.Nt.overrideQuery(t))})),this.Za.register(Oc,(t=>{f(t)&&s.addUrlMaskingPattern(t)})),this.Za.register(Pc,(()=>s.enableRemoveQueryString())),this.Za.register(kc,(()=>s.disableRemoveQueryString()))}start(t){this.Jd.start(t)}onBeforeSessionRenewal(){this.Jd.stop()}Kd(t){return E(t)&&null!==t}}class Mc{constructor(t){this.cl=t}on(t,e){return s=>{this.cl.hasValidEventTarget(s)&&this.Yd(s,t)&&e(s)}}Yd(t,e){const s=Hs(t);return Y.call(s,e)}isMatchesSelectorSupported(){return!!Y}}class Dc{constructor(){}onLoad(t){this.Vs=t}onLoadCallbackExecute(){this.Vs()}start(){const t=this.onLoadCallbackExecute.bind(this);this.Xd(t)}Xd(t){function e(){document.removeEventListener("DOMContentLoaded",e),window.removeEventListener("load",e),t()}"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?csSetTimeout(t):(document.addEventListener("DOMContentLoaded",e),window.addEventListener("load",e))}}as([yt("onLoad")],Dc.prototype,"onLoadCallbackExecute",null);class xc{constructor(t,e,s){this.wt=t,this.bt=e,this.Vt=s,this.md=Ie()}resetStartTime(){this.md=Ie()}getSessionData(){const{projectId:t}=this.wt,e=this.bt.getVisitor();null==e&&ns.warn("Visitor is null. This happens when a snippet tries to get Session Data before the tag was initialized.");const{id:s,visitsCount:i}=null!=e?e:{},n=this.Vt.getSession();null===n&&ns.warn("Session is null. This happens when a snippet tries to get Session Data before the tag was initialized.");const{pageNumber:r}=null!=n?n:{};return{projectId:t,userId:s,sessionNumber:i,pageNumber:r,relativeTimestamp:Ie()-this.md}}}const Uc=["clearSession"],Vc=["extendSession"],Bc=["getSessionData"],Hc=["session:start:newVisitor"],$c=["session:clear:visitor"];class qc{constructor(t,e,s,i){this.wt=t,this.bt=e,this.Vt=s,this.Za=i}init(){this.tf=new xc(this.wt,this.bt,this.Vt),this.Za.register(Uc,(()=>this.Vt.removeSession())),this.Za.register(Vc,(()=>this.Vt.extendSessionPeriodically()),{disableApplyPending:!0}),this.Za.register(Bc,(()=>this.tf.getSessionData()),{disableApplyPending:!0}),this.Za.register(Hc,(()=>this.bt.renewVisitor())),this.Za.register($c,(()=>{this.bt.resetVisitor()}),{disableApplyImmediate:!0})}onBeforeNaturalPageView(){this.bt.createOrUpdateVisitor(),this.Vt.createOrUpdateSession()}onBeforeArtificialPageView(){this.Vt.abortQuotaServiceRequest(),this.bt.createOrUpdateVisitor(),this.Vt.createOrUpdateSession()}onAfterNaturalPageView(){this.tf.resetStartTime()}onAfterArtificialPageView(){this.tf.resetStartTime()}onOptout(){this.bt.removeVisitor(),this.Vt.removeSession()}onCollectStateChange(t,e){this.Vt.updateCollectState(t,e)}}class zc{constructor(t,e){this.Vt=t,this.bt=e,this.sf=!1,this.ef=Ls((()=>this.Vt.refreshSession()),3e4)}onSessionExpired(t){this.if=t}isSessionValid(){return!(!this.sf&&(!this.Vt.hasValidSession()||this.Vt.pollCacheRefreshEvent()&&this.bt.isSessionRenewed()))}isCurrentPageviewValid(){const t=this.Vt.hasValidSession();return this.Vt.pollCacheRefreshEvent(!1)?!this.bt.isSessionRenewed():t}refreshSession(){this.isSessionValid()?this.ef():this.nf()&&(this.rf=Ie(),this.renewSession())}renewSession(){this.sf=!0,this.if(),this.sf=!1}nf(){return!S(this.rf)||Ie()-this.rf>6e4}}var Fc,jc;function Gc(t){return t.tagDeploymentMode===Fc.DualCollectionReview||t.tagDeploymentMode===Fc.DualCollection}!function(t){t.ContentSquare="CONTENTSQUARE",t.LoadedByClicktale="LOADED_BY_CLICKTALE",t.LoadClicktalePtc="LOAD_CLICKTALE_PTC",t.DualCollectionReview="DUAL_COLLECTION_REVIEW",t.DualCollection="DUAL_COLLECTION",t.ContentSquareTagClickTaleEndpoints="CONTENTSQUARE_TAG_CLICKTALE_ENDPOINTS"}(Fc||(Fc={})),function(t){t.isRecording=function(){return window.ClickTaleIsRecording&&window.ClickTaleIsRecording()},t.stopRecording=function(){window.ClickTaleStop&&window.ClickTaleStop()},t.triggerLogicalPageView=function(t){window.ClickTaleLogicalWithUploadPage&&window.ClickTaleLogicalWithUploadPage(t)},t.sendPageEvent=function(t){window.ClickTaleEvent&&window.ClickTaleEvent(t)},t.sendEventTriggerRecording=function(t){window.ClickTaleEventTrigger&&window.ClickTaleEventTrigger(t)}}(jc||(jc={}));const Wc="RSA-OAEP",Yc="AES-CTR";var Qc;!function(t){var e;let s,i=!1,n=null;const r="undefined"!=typeof TextEncoder?new TextEncoder:null;let o;function c(){var t,e;return null!=(null===(e=null===(t=a.self.crypto)||void 0===t?void 0:t.subtle)||void 0===e?void 0:e.encrypt)&&null!=a.self.CryptoKey}async function h(e){if(!c()||i)return null;await s;let r=Pn(e);r.byteLength>190&&(r=r.slice(0,190));try{return kn(await t.crypto.encrypt({name:Wc},n,r))}catch(t){return null}}t.crypto=null===(e=a.crypto)||void 0===e?void 0:e.subtle,t.MAX_DIGEST_INPUT_SIZE=100,t.isKeyImported=function(){return!i},t.getCryptoKey=function(){return n},t.isSupported=c,t.importKey=async function(e){s=t.crypto.importKey("spki",Ln(e),{name:Wc,hash:"SHA-256"},!1,["encrypt"]).catch((()=>(i=!0,null))),n=await s,s=void 0,n||mt.warn(`Fail to import public key '${e}'`)},t.asymmetricEncrypt=h,t.symmetricEncrypt=async function(e,s){if(!c()||i)return null;const n={counter:s.initializationVector,name:Yc,length:64},o=r.encode(e);try{return kn(await t.crypto.encrypt(n,s.cryptoKey,o))}catch(t){return null}},t.encryptSecret=async function(e){const s=await async function(e){var s;if(!c())return null;try{return null!==(s=(await t.crypto.exportKey("jwk",e)).k)&&void 0!==s?s:null}catch(t){return null}}(e);if(!s)throw new Error("Export secret failed");const i=await h(s);if(!i)throw new Error("Encrypt secret failed");return i},t.generateSymmetricKey=async function(){if(!c()||i)return null;try{return{cryptoKey:await t.crypto.generateKey({name:Yc,length:128},!0,["encrypt","decrypt"]),initializationVector:a.crypto.getRandomValues(new Uint8Array(16))}}catch(t){return null}},t.setDigestSalt=function(t){o=t},t.digest=async function(e){e=csString.prototype.toLocaleLowerCase.call(csString.prototype.trim.call(e)),o&&(e=`${e}:${o}`);const s=r.encode(e);try{return Mn(await t.crypto.digest("SHA-1",s))}catch(t){return null}},t.generateKeyPair=function(){return a.crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt","decrypt"])}}(Qc||(Qc={}));class Zc extends ni{constructor(t,e,s,i){super(),this.wt=t,this.hf=e,this.Uu=s,this.Td=i,this.cf=[],this.kn=[]}onStart(){csArray.prototype.forEach.call(this.cf,(t=>this.trackPageEvent(t))),this.cf=[],csArray.prototype.forEach.call(this.kn,(t=>this.trackEventTriggerRecording(t))),this.kn=[]}onStop(){}trackPageEvent(t){this.isStarted?Zc.af(t)&&(this.uf(t)?Qc.isSupported()&&this.lf(t):this.df(t)):csArray.prototype.push.call(this.cf,t)}uf(t){return Yt(t,"@user-identifier@")}async lf(t){if(!this.wt.customHashIdEnabled)return;const e=csString.prototype.slice.call(t,17);if(e.length>Qc.MAX_DIGEST_INPUT_SIZE)return void ns.warn("UserIdentifier event: invalid user identifier");const s=await Qc.digest(e);s?(this.ff={eventName:s,isETR:!1,isCustomHashId:!0},this.pf()):ns.warn("Page event: unable to compute customHashId"),this.wt.encryptionEnabled&&this.Td.emitUserIdentifierEvent(e)}df(t){this.Td.emitPageEvent(t),this.ff={eventName:t,isETR:!1,isCustomHashId:!1},this.pf(),this.wt.tagDeploymentMode===Fc.LoadClicktalePtc&&jc.sendPageEvent(t)}trackEventTriggerRecording(t){this.isStarted?Zc.af(t)&&(this.wt.malkaEtrEnabled?this.vf(t):this.mf(t)):csArray.prototype.push.call(this.kn,t)}vf(t){Yt(t,"@ETP@")?this.Td.emitEventTriggerRecording(t,vi.ETR_PAGE):this.Td.emitEventTriggerRecording(t,vi.ETR_SESSION),this.ff={eventName:t,isETR:!0,isCustomHashId:!1},this.pf()}mf(t){var e;(Gc(e=this.wt)||e.tagDeploymentMode===Fc.LoadClicktalePtc)&&(this.Td.emitEventTriggerRecording(t,vi.ETR_LEGACY),this.ff={eventName:t,isETR:!0,isCustomHashId:!1},this.pf(),this.wt.tagDeploymentMode===Fc.LoadClicktalePtc&&jc.sendEventTriggerRecording(t))}getRequestParameters(){return{value:this.Uu.compressSync(this.ff.eventName,"base64"),ct:this.Uu.algorithm,isETR:`${this.ff.isETR}`,isCustomHashId:`${this.ff.isCustomHashId}`}}pf(){this.hf.send()}static af(t){return f(t)&&!!csString.prototype.trim.call(t)}}const Xc=["trackPageEvent"],Kc=["trackEventTriggerRecording"];class Jc{constructor(t,e,s,i,n){this.wt=t,this.Za=e,this.Uu=s,this.Na=i,this.Td=n}init(){const t=new re(this.wt.getTrackerUri(),"pageEvent");this.wf=new Zc(this.wt,t,this.Uu,this.Td),t.setRequestParametersProviders(this.wf,this.Na),this.Za.register(Xc,(t=>{this.wf.trackPageEvent(t)})),this.Za.register(Kc,(t=>{this.wf.trackEventTriggerRecording(t)}))}onStartTracking(){this.wf.start()}}class th{constructor(){this.subscriptions={}}subscribe(t,e){this.subscriptions[t]=e,1===Object.keys(this.subscriptions).length&&this.onStartTracking()}unsubscribe(t){delete this.subscriptions[t],0===Object.keys(this.subscriptions).length&&this.onStopTracking()}}class eh extends th{constructor(){super(),this.Qe=new Xr((t=>this.errorListener(t)))}onStartTracking(){this.Qe.observe()}onStopTracking(){this.Qe.disconnect()}errorListener(t){const e=this.gf(t);for(const t in this.subscriptions)(0,this.subscriptions[t])(e)}yf(t){return t=null!=t?t:"[NO ERROR MESSAGE]",bn.truncate(t,eh.Kc,bn.ELLIPSIS)}Ef(t){return!t||wi(t)?"":bn.truncate(t,eh.Yc,bn.ELLIPSIS)}gf(t){return{errorType:"jsError",message:this.yf(t.message),filename:this.Ef(t.filename),lineno:t.lineno,colno:t.colno}}}eh.Kc=1024,eh.Yc=150,as([yt("Event handler type: error")],eh.prototype,"errorListener",null);class sh{constructor(t){this.Za=t}init(){this.Af(sh._f,Ve),this.Af(sh.Rf,Ue)}Af(t,e){this.Za.register([t],((t,s)=>{f(t)&&(f(s)||b(s))&&ns.error(s,`${e}${t}`)}))}}sh.Rf="logSnippetError",sh._f="logImplementationSnippetError";class ih{constructor(t,e,s,i,n){this.wt=t,this.Pu=e,this.Ga=s,this.Rd=i,this.Cu=n}init(){this.Pu.onChildMessage(((t,e,s)=>this.Cu.emitIframeEvent(t,e,s))),this.Pu.setSentiveStatusCallback((()=>this.Rd.getSensitiveStatus())),this.Pu.setRecordingContextCallback((()=>this.Ga.getRecordingContext()))}onStartTracking(){this.wt.iframesTracking&&this.Pu.start()}onOptout(){this.wt.iframesTracking&&this.Pu.stop()}onSensitiveStatusChange(){if(this.wt.iframesTracking){const t=this.Rd.getSensitiveStatus();this.Pu.onSensitiveStatusChange(t)}}onRecordingContextChange(){if(this.wt.iframesTracking){const t=this.Ga.getRecordingContext();this.Pu.onRecordingContextChange(t)}}}class nh extends ni{constructor(t){super(),this.wt=t,this.Sf=0,this.Tf=new Map,this.If={boundElement:window,type:"message",listener:t=>this.Pf(t)}}onChildMessage(t){this.bf=t}setRecordingContextCallback(t){this.Vf=t}setSentiveStatusCallback(t){this.Cf=t}onSensitiveStatusChange(e){const s=ts.buildBaseMessage(Je.SensitiveStatus,Ke.Parent,this.wt.projectId);s.content=e;const i=ts.buildBaseMessage(Je.SensitiveStatus,Ke.Parent,this.wt.projectId);i.content=t._objectSpread2(t._objectSpread2({},e),{},{started:!1,useAnonymization:!0,capturedElementSelector:""}),this.Tf.forEach((t=>{if(t.port){const e=this.kf(t)?i:s;this.Of(t,e)}}))}onRecordingContextChange(t){const e=ts.buildBaseMessage(Je.RecordingContext,Ke.Parent,this.wt.projectId);e.content=t,this.Tf.forEach((t=>{!this.kf(t)&&t.port&&this.Of(t,e)}))}sendToChildren(t,e){const s=ts.buildBaseMessage(t,Ke.Parent,this.wt.projectId);s.content=e,this.Nf(s)}onStart(){Os(this.If,!1),this.xf()}onStop(){this.$f(),Ps(this.If,!1),this.Mf()}xf(){const t=this.Lf();this.Df(t),csArray.prototype.forEach.call(t,(t=>{if(null===this.Uf(t)){const e={iframe:t};this.Tf.set(this.Sf,e),this.Sf+=1}})),this.Ff()}Lf(){return csArray.prototype.filter.call(qt.findAllElements("iframe"),(t=>this.Bf(t)))}Df(t){this.Tf.forEach(((e,s)=>{e.iframe&&-1===csArray.prototype.indexOf.call(t,e.iframe)&&this.qf(s,e)}))}qf(t,e){e.port&&ts.closeChannelPort(e.port),this.Tf.delete(t)}Mf(){this.Tf.forEach((t=>{t.port&&ts.closeChannelPort(t.port)})),this.Tf.clear()}Uf(t){let e=null;return this.Tf.forEach(((s,i)=>{null===e&&s.iframe===t&&(e=i)})),e}Bf(t){return t.id!==c&&(!t.src||We(Ge(t.src),this.wt.hostnames))}Nf(t){this.Tf.forEach((e=>{this.Of(e,t)}))}Of(t,e){const s=e.type===Je.SensitiveStatus||e.type===Je.RecordingContext;!t.port||s&&!t.initialStatusSent||ts.sendChannelMessage(t.port,e)}Ff(){this.Tf.forEach(((t,e)=>{if(t.iframe.contentWindow){const s=this.Hf(e);ts.sendPostMessage(t.iframe.contentWindow,"*",s)}}))}$f(){const t=this.zf();this.Tf.forEach((e=>{e.port?ts.sendChannelMessage(e.port,t):e.iframe.contentWindow&&ts.sendPostMessage(e.iframe.contentWindow,"*",t)}))}Hf(t){return ts.buildBaseMessage(Je.Discovery,Ke.Parent,this.wt.projectId,t)}zf(){return ts.buildBaseMessage(Je.Stop,Ke.Parent,this.wt.projectId)}jf(t,e){const s=this.Tf.get(t);void 0!==s?(s.port=e,s.port.onmessage=t=>{this.Gf(t,s)}):ns.error(`Parent received channel messaging initialization from unknow child id : ${t} (${this.Sf})`)}Zf(t){if(!t.port)return;const e=ts.buildBaseMessage(Je.SensitiveStatus,Ke.Parent,this.wt.projectId),s=this.Cf();this.kf(t)&&(s.started=!1,s.capturedElementSelector="",s.useAnonymization=!0),e.content=s,ts.sendChannelMessage(t.port,e)}Wf(t){if(!t.port)return;const e=ts.buildBaseMessage(Je.RecordingContext,Ke.Parent,this.wt.projectId),s=this.Vf();this.kf(t)&&(s.isRecording=!1,s.isMutationTrackerStarted=!1),e.content=s,ts.sendChannelMessage(t.port,e)}Gf(t,e){if(void 0===e)return void ns.error(`Parent received channelMessage from unknown child : ${csJSON.stringify(t.data)}`);const s=t.data.type,i=t.data.content;s===Je.EndOfBufferedMessages?(this.Zf(e),this.Wf(e),e.initialStatusSent=!0):this.bf(e.iframe,s,i)}Pf(t){if(ts.isMessageValid(t,Ke.Child,this.wt.projectId,this.wt.hostnames))switch(t.data.type){case Je.Discovery:if(void 0===t.data.id)return void this.xf();if(t.ports&&1===t.ports.length&&this.Tf.has(t.data.id))return void this.jf(t.data.id,t.ports[0]);ns.error(`Parent received wrong channelMessage initialization : (${t.origin}) : ${csJSON.stringify(t.data)}`);break;case Je.ChildLogMessage:this.bf(null,Je.ChildLogMessage,t.data.content);break;default:ns.warn(`Parent received unexpected postMessage type from child (${t.origin}) : ${csJSON.stringify(t.data)}`)}}kf(t){return Ks.isMaskedElement(t.iframe)||Ks.isMaskedElementChild(t.iframe)}}class rh{constructor(t){this.Qf=t}buildApiErrors(t,e){const s=this.Qf.collectDataPoints(t,e);if(null===s)return null;const i=this.Jf(t,s);return e?{apiError:i,detailedApiError:this.Kf(t,s)}:{apiError:i}}Kf(t,e){const s=this.Yf(t);return e.collectQueryParam&&t.queryParameters&&(s.queryParameters=t.queryParameters),e.collectRequestBody&&t.requestBody&&(s.requestBody=t.requestBody),e.collectResponseBody&&t.responseBody&&(s.responseBody=t.responseBody),Object.keys(e.standardRequestHeaders).length>0&&(s.standardRequestHeaders=e.standardRequestHeaders),Object.keys(e.standardResponseHeaders).length>0&&(s.standardResponseHeaders=e.standardResponseHeaders),Object.keys(e.customRequestHeaders).length>0&&(s.customRequestHeaders=csJSON.stringify(e.customRequestHeaders)),Object.keys(e.customResponseHeaders).length>0&&(s.customResponseHeaders=csJSON.stringify(e.customResponseHeaders)),Object.keys(e.plainCustomRequestHeaders).length>0&&(s.plainCustomRequestHeaders=e.plainCustomRequestHeaders),Object.keys(e.plainCustomResponseHeaders).length>0&&(s.plainCustomResponseHeaders=e.plainCustomResponseHeaders),e.plainResponseBodyAttributes&&Object.keys(e.plainResponseBodyAttributes).length>0&&(s.plainResponseBodyAttributes=e.plainResponseBodyAttributes),e.plainRequestBodyAttributes&&Object.keys(e.plainRequestBodyAttributes).length>0&&(s.plainRequestBodyAttributes=e.plainRequestBodyAttributes),Object.keys(e.responseBodyAttributes).length>0&&(s.responseBodyAttributes=csJSON.stringify(e.responseBodyAttributes)),Object.keys(e.requestBodyAttributes).length>0&&(s.requestBodyAttributes=csJSON.stringify(e.requestBodyAttributes)),s}Yf(t){return{errorType:"apiError",url:t.url,method:t.method,requestTime:t.requestTime,responseTime:t.responseTime,statusCode:t.statusCode,library:t.library}}Jf(t,e){const s=this.Yf(t);return e.matchingBodyContents.length>0&&(s.matchingBodyContents=e.matchingBodyContents),Object.keys(e.plainResponseBodyAttributes).length>0&&(s.plainBodyResponseAttributes=e.plainResponseBodyAttributes),s}}class oh extends th{constructor(t,e,s){super(),this.Xf=t,this.tp=e,this.sp=s,this.ep=0,this.ip=new rh(s)}subscribe(t,e,s){(null==s?void 0:s.detailedEvent)&&(Object.defineProperty(e,"detailedEvent",{value:s.detailedEvent}),this.ep++),super.subscribe(t,e)}unsubscribe(t){var e;(null===(e=this.subscriptions[t])||void 0===e?void 0:e.hasOwnProperty("detailedEvent"))&&this.ep--,super.unsubscribe(t)}init(){const t=this.sp.computeApiErrorCollectionOptions();this.Xf.setCollectionOptions(t),this.Xf.onEvent((t=>this.np(t))),this.tp.setCollectionOptions(t),this.tp.onEvent((t=>this.np(t)))}onStartTracking(){this.Xf.start(),this.tp.start()}onStopTracking(){this.Xf.stop(),this.tp.stop()}np(t){const e=this.ip.buildApiErrors(t,0!==this.ep);if(e)for(const t in this.subscriptions){const s=this.subscriptions[t];s.hasOwnProperty("detailedEvent")?e.detailedApiError&&s(e.detailedApiError):s(e.apiError)}}}class ah{constructor(t,e){this.Qa=t,this.uh=e}addUrlMaskingPattern(t){this.Qa.addUrlMaskingPattern(t)}anonymize(e){const s=this.uh.removeQueryString(e.url);return t._objectSpread2(t._objectSpread2({},e),{},{url:this.uh.anonymizeUrl(s,this.Qa.getUrlMaskingPatterns(),this.Qa.getPartialUrlMaskingPatterns()),library:e.library?this.uh.anonymizeUrl(e.library,this.Qa.getUrlMaskingPatterns(),this.Qa.getPartialUrlMaskingPatterns()):void 0})}}class ch{constructor(t,e){this.gt=t,this.Nt=e}anonymize(t){return f(t.message)&&(t.message=this.rp(t.message),t.message=this.gt.anonymizePII(t.message)),f(t.filename)&&(t.filename=this.Nt.computeOverriddenUrl(t.filename)),t}rp(t){return csString.prototype.replace.call(t,/(value\s*=\s*".*"|value\s*=\s*'.*')/,"value='CS_ANONYMIZED_VALUE'")}}class hh extends th{constructor(t){super(),this.op=t,this.ar=[{boundElement:document,type:"touchstart",listener:t=>this.Nn(t)},{boundElement:document,type:"touchmove",listener:t=>this.Nn(t)},{boundElement:document,type:"touchend",listener:t=>this.Nn(t)}],this.hp=new Yr,this.hp.onGesture(((t,e)=>this.Hc(t,e)))}Hc(t,e){for(const s in this.subscriptions)(0,this.subscriptions[s])(t,e)}onStartTracking(){this.canDetectGesture()&&csArray.prototype.forEach.call(this.ar,(t=>Os(t)))}onStopTracking(){this.canDetectGesture()&&csArray.prototype.forEach.call(this.ar,(t=>Ps(t)))}canDetectGesture(){return"undefined"!=typeof devicePixelRatio}Nn(t){this.op.tryToExecute("process gesture event",(()=>{if(this.hp.isValidTouchEvent(t))switch(t.type){case"touchstart":this.hp.processActionDown(t);break;case"touchmove":this.hp.processActionMove();break;case"touchend":this.hp.processActionUp(t)}}))()}static isSwipe(t){return t.type===Ir.FLICK||t.type===Ir.DRAG}}class lh extends ni{constructor(t,e){super(),this.nn=t,this.cp=e,this.ap=0}onStart(){ns.isPerfLoggingActive()&&(this.up=window.csSetInterval((()=>this.lp()),lh.dp))}onStop(){ns.isPerfLoggingActive()&&(this.lp(),csClearInterval(this.up))}lp(){if(Rt.isEmpty||this.ap>=lh.fp)return;this.ap++;const e=t._objectSpread2({a:lh.pp,l:lh.vp},this.cp.getRequestParameters()),s=[];Rt.forEach((i=>{csArray.prototype.forEach.call(i,(i=>{csArray.prototype.push.call(s,t._objectSpread2(t._objectSpread2({},i),e))}))})),this.nn.send(s),Rt.clear()}}lh.pp="uxa",lh.vp="perf",lh.dp=5e3,lh.fp=5;class dh{constructor(t,e,s){this.wt=t,this.cp=e,this.Xa=s}init(){this.mp=new lh(this.Xa.create(this.wt.getLoggerUri(),!0),this.cp)}onStartTracking(){this.mp.start()}onOptout(){this.mp.stop()}}class uh{constructor(t){this.Rd=t,this.wp=!1}enableRecordingContext(t,e,s){this.wp=!0,this.Mu=t,this.Vt=e,this.au=s}getRecordingContext(){var t,e,s,i;if(!this.wp)return{isRecording:!1,recordingStartTimestamp:0,etrState:fi.ETR_OFF,etrStatus:Ei.ETR_DISABLED,collectState:yi.ANALYTICS_ONLY};const n=this.Vt.getSession();return{isRecording:this.Mu.isRecording(),isMutationTrackerStarted:this.Mu.isStarted,useAnonymization:this.Rd.getSensitiveStatus().useAnonymization,enableOnlineResources:null===(t=this.Mu.getStaticResourceManagerStatus())||void 0===t?void 0:t.onlineAssets.activated,enableOnlineResourcesOnNextPageview:null===(e=this.Mu.getStaticResourceManagerStatus())||void 0===e?void 0:e.onlineAssets.enabledOnNextPageview,recordingStartTimestamp:parseInt(this.Mu.getRecordingStartTimestamp(),10),etrState:null!==(s=null==n?void 0:n.etrState)&&void 0!==s?s:fi.ETR_OFF,etrStatus:this.au.getEtrStatus(n),collectState:null!==(i=null==n?void 0:n.collectState)&&void 0!==i?i:yi.ANALYTICS_ONLY}}}class ph{static isRecordingSupported(){return"MutationObserver"in window&&"visibilityState"in document}static isAsyncSerializationSupported(){return"Promise"in window&&"findIndex"in csArray.prototype}}class gh extends ni{constructor(t,e,s,i){super(),this.Xi=t,this.gp=e,this.Ca=s,this.tn=i,this.yp=[],this.mn=0}init(){this.Xi.init()}initStates(){this.Ep(),this.yp=[],this.mn=0,this.ld()}ld(){this.md=Ie()}vd(){return Ie()-this.md}onStart(){this.Xi.subscribe(gh.jn,(t=>this.Nn(t)))}onStop(){this.Xi.unsubscribe(gh.jn)}onIframeApiError(t){this.Nn(t)}Nn(t){this.isStarted&&this.mn<gh.za&&(t.relativeTime=this.vd(),csArray.prototype.push.call(this.yp,this.tn.anonymize(t)),this.Ap())}Ep(){this.gp.removeQueryParams(),this.gp.setQueryParams(this.Ca.getRequestParameters())}Ap(){this.gp.send({errors:this.yp}),this.yp=[],this.mn+=1}}gh.jn="ApiErrorsService",gh.za=20;const mh=["api-errors:maskUrl"];class yh{constructor(t,e,s,i,n,r,o){this.Xi=t,this.tn=e,this.wt=s,this.Ca=i,this.Cu=n,this.Za=r,this.Xa=o}init(){const t=this.Xa.create(`${this.wt.getTrackerUri()}/api-errors`,!0);this._p=new gh(this.Xi,t,this.Ca,this.tn),this._p.init(),this.Cu.addListener(this._p),this.Rp()}Rp(){this.Za.register(mh,(t=>{f(t)&&this.tn.addUrlMaskingPattern(t)}))}onStartTracking(){this._p.start()}onAfterNaturalPageView(){this._p.initStates()}onAfterArtificialPageView(){this._p.initStates()}onBeforeSessionRenewal(){this._p.stop()}onOptout(){this._p.stop()}}class fh extends ni{constructor(t,e,s,i,n,r){super(),this.Sp=t,this.Tp=e,this.Ca=s,this.Yi=i,this.Ja=n,this.Nt=r,this.Ip=[],this.ja=0,this.Pp=[]}initStates(){this.md=Ie(),this.Tp.removeQueryParams(),this.Tp.setQueryParams(this.Ca.getRequestParameters()),this.Ip=[],this.ja=0}onStart(){this.Sp.subscribe(fh.jn,(t=>this.Nn(t))),this.bp()}onStop(){this.Sp.unsubscribe(fh.jn)}onIframeJavascriptError(t){this.Nn(t)}trackCustomError(t){const e={errorType:"jsError",message:`Custom Error: ${t}`,lineno:1,colno:1,filename:"https://cserror.com/texterror.js"};this.Vp(e)}Vp(t){if(this.isStarted){const e=this.Nn(t);e&&this.Ja.emitCustomJavaScriptErrorEvent(e)}else csArray.prototype.push.call(this.Pp,t)}bp(){this.isStarted&&(csArray.prototype.forEach.call(this.Pp,(t=>this.Vp(t))),this.Pp=[])}Nn(e){if(this.isStarted&&this.ja<20){const s=t._objectSpread2(t._objectSpread2({},e),{},{pageUrl:this.Nt.getAnonymizedUrl(),rt:this.vd()});return this.Yi.anonymize(s),csArray.prototype.push.call(this.Ip,s),this.Ap(),s}return null}vd(){return Ie()-this.md}Ap(){this.Tp.send({errors:this.Ip}),this.Ip=[],this.ja+=1}}fh.jn="JavaScriptErrorsService";const vh=["trackError"];class Eh{constructor(t,e,s,i,n,r,o,a,c){this.Sp=t,this.Yi=e,this.wt=s,this.Ca=i,this.Cu=n,this.Za=r,this.Ja=o,this.Nt=a,this.Xa=c}init(){const t=this.Xa.create(`${this.wt.getTrackerUri()}/errors`,!0);this.Cp=new fh(this.Sp,t,this.Ca,this.Yi,this.Ja,this.Nt),this.Cu.addListener(this.Cp),this.Rp()}Rp(){this.wt.jsCustomErrorsEnabled&&!this.wt.customErrors.enabled&&this.Za.register(vh,(t=>{this.Cp.trackCustomError(t)}))}onStartTracking(){this.Cp.start()}onAfterNaturalPageView(){this.Cp.initStates()}onAfterArtificialPageView(){this.Cp.initStates()}onBeforeSessionRenewal(){this.Cp.stop()}onOptout(){this.Cp.stop()}}class Sh{constructor(){this.kp=Ec.Natural}setPageViewType(t){this.kp=t}getPageViewType(){return this.kp}getRequestParameters(){return{pvt:this.kp}}}class wh{constructor(t){this.Ki=t}onAfterVisitorRenewal(){this.Ki.renewSession()}}var Rh,Ah,bh,Th;!function(t){t.replayRecordingUnmaskedUrlRegex="replayRecordingUnmaskedUrlRegex",t.replayRecordingMaskedUrlRegex="replayRecordingMaskedUrlRegex",t.replayRecordingUnmaskedUrlRegexRules="replayRecordingUnmaskedUrlRegexRules",t.replayRecordingMaskedUrlRegexRules="replayRecordingMaskedUrlRegexRules"}(Rh||(Rh={})),function(t){t.START="start",t.NOT_START="not-start",t.END="end",t.NOT_END="not-end",t.CONTAIN="contain",t.NOT_CONTAIN="not-contain",t.EXACT="exact",t.NOT_EXACT="not-exact"}(Ah||(Ah={}));class Ch{constructor(t,e,s,i){this.Zd=t,this.wt=e,this.Nt=s,this.Op=i}init(){this.Np()}shouldMaskNonTextElements(){return this.wt.isSMB&&this.wt.anonymisationMethod===Rh.replayRecordingMaskedUrlRegexRules&&this.shouldUseAnonymization()}shouldUseAnonymization(){if(this.Zd.isReplayUnanonymizedAllowedByConsent()){switch(this.wt.anonymisationMethod){case null:case Rh.replayRecordingMaskedUrlRegex:return!(!this.wt.replayRecordingMaskedUrlRegex||!this.wt.replayRecordingMaskedUrlRegex.test(this.Nt.getAnonymizedUrl()));case Rh.replayRecordingMaskedUrlRegexRules:return this.Op.evaluateUrl(this.Nt.getAnonymizedUrl())}return!1}switch(this.wt.anonymisationMethod){case null:case Rh.replayRecordingUnmaskedUrlRegex:return!(this.wt.replayRecordingUnmaskedUrlRegex&&this.wt.replayRecordingUnmaskedUrlRegex.test(this.Nt.getAnonymizedUrl()));case Rh.replayRecordingUnmaskedUrlRegexRules:return!this.Op.evaluateUrl(this.Nt.getAnonymizedUrl())}return!0}Np(){this.wt.anonymisationMethod===Rh.replayRecordingMaskedUrlRegexRules&&this.wt.replayRecordingMaskedUrlRegexRules?this.Op.setRegexRules(this.wt.replayRecordingMaskedUrlRegexRules):this.wt.anonymisationMethod===Rh.replayRecordingUnmaskedUrlRegexRules&&this.wt.replayRecordingUnmaskedUrlRegexRules&&this.Op.setRegexRules(this.wt.replayRecordingUnmaskedUrlRegexRules)}}class _h{constructor(){this.xp=[]}setRegexRules(t){this.xp=csArray.prototype.map.call(t,(t=>this.$p(t)))}evaluateUrl(t){return csArray.prototype.some.call(this.xp,(e=>{var s,i;const n=this.Mp(t,e);return(null==e?void 0:e.notOperator)?!(null===(s=e.regex)||void 0===s?void 0:s.test(n)):null===(i=e.regex)||void 0===i?void 0:i.test(n)}))}Mp(t,e){const s=Qe(t);return s?e.ignoreQueryParams&&e.ignoreURIFragments?`${s.origin}${s.pathname}`:e.ignoreQueryParams?`${s.origin}${s.pathname}${s.hash}`:e.ignoreURIFragments?`${s.origin}${s.pathname}${s.search}`:t:t}Lp(t){return t.ignoreCaseSensitivity?"i":""}$p(t){switch(t.operator){case Ah.NOT_START:t.notOperator=!0;case Ah.START:t.regex=new csRegExp(`^${t.value}`,this.Lp(t));break;case Ah.NOT_END:t.notOperator=!0;case Ah.END:t.regex=new csRegExp(`${t.value}$`,this.Lp(t));break;case Ah.NOT_CONTAIN:t.notOperator=!0;case Ah.CONTAIN:t.regex=new csRegExp(`${t.value}`,this.Lp(t));break;case Ah.NOT_EXACT:t.notOperator=!0;case Ah.EXACT:t.regex=new csRegExp(`^${t.value}$`,this.Lp(t));break;default:ns.warn(`buildRegexWithRule, unknown type: ${t.operator}`)}return t}}class Nh{constructor(){this.Dp=["application/json","application/graphql","application/xml","text/plain","text/csv","text/html","text/xml","text/javascript"]}setCollectionOptions(t){this.Fp=t}isValidBodyType(t){const e=t["content-type"];if(!e)return!1;const s=csString.prototype.toLocaleLowerCase.call(e);return Ut(this.Dp,(t=>Yt(s,t)))}canCollect(t,e){return this.Bp(t,e)&&this.qp(e)}Bp(t,e){return t>=400||t>=200&&t<300&&this.Fp.statusCodes.has(t)&&this.Hp(e)}Hp(t){return Ut(this.Fp.urls,(e=>-1!==csString.prototype.indexOf.call(t,e)))}qp(t){return function(t,e){const s=t.length;for(let i=0;i<s;i++)if(!e(t[i]))return!1;return!0}(this.Fp.excludedDomains,(e=>-1===csString.prototype.indexOf.call(t,e)))}}class Ih extends Nh{constructor(){super(),this.zp=csSymbol("ApiCall"),this.Ti=!1,this.jp=null,this.Gp=null,this.Zp=null,this.Wp=t=>{let{context:e,args:s,callerName:i}=t;return this.interceptOpen(e,s,i)},this.Qp=t=>{let{context:e,args:s}=t;return this.interceptSetRequestHeader(e,s)},this.Jp=t=>{let{context:e,args:s}=t;return this.interceptSend(e,s)}}onEvent(t){this.ur=t}start(){this.Ti||(this.Kp(),this.jp&&this.jp.activate(),this.Gp&&this.Gp.activate(),this.Zp&&this.Zp.activate(),this.Ti=!0)}stop(){this.Ti&&(this.jp&&this.jp.deactivate(),this.Gp&&this.Gp.deactivate(),this.Ti=!1)}Kp(){this.jp||(this.jp=Cs({target:XMLHttpRequest.prototype,methodName:"open",hook:this.Wp,options:{withCallerName:!0}})),this.Gp||(this.Gp=Cs({target:XMLHttpRequest.prototype,methodName:"setRequestHeader",hook:this.Qp})),this.Zp||(this.Zp=Cs({target:XMLHttpRequest.prototype,methodName:"send",hook:this.Jp}))}interceptOpen(t,e,s){if(!e[1]||!f(e[1]))return;const[i,n]=csString.prototype.split.call(e[1],"?");t[this.zp]={library:s,requestTime:Ie(),method:e[0],url:Fe(i),queryParameters:n,statusCode:0,responseHeaders:{},requestHeaders:{},responseBody:"",requestBody:""},t.addEventListener("readystatechange",(()=>this.readyStateChangeListener(t)))}readyStateChangeListener(t){t[this.zp]&&t.readyState===XMLHttpRequest.DONE&&this.canCollect(t.status,t[this.zp].url)&&(t[this.zp].responseTime=Ie(),t[this.zp].statusCode=t.status,t[this.zp].responseHeaders=this.Yp(t.getAllResponseHeaders()),!super.isValidBodyType(t[this.zp].responseHeaders)||""!==t.responseType&&"text"!==t.responseType||(t[this.zp].responseBody=t.responseText),this.ur(t[this.zp]))}interceptSetRequestHeader(t,e){if(!t[this.zp])return;let s=e[0],i=csString.prototype.valueOf.call(new csString(e[1]));"string"==typeof s&&0!==i.length&&(s=csString.prototype.toLowerCase.call(csString.prototype.trim.call(s)),i=csString.prototype.trim.call(i),t[this.zp].requestHeaders[s]?t[this.zp].requestHeaders[s]+=`, ${i}`:t[this.zp].requestHeaders[s]=i)}interceptSend(t,e){t[this.zp]&&super.isValidBodyType(t[this.zp].requestHeaders)&&"string"==typeof e[0]&&(t[this.zp].requestBody=e[0])}Yp(t){const e={};return csArray.prototype.forEach.call(csString.prototype.split.call(t,/[\r\n]+/),(t=>{const[s,i]=csString.prototype.split.call(t,/:\s*/);i&&(e[csString.prototype.toLowerCase.call(s)]=csString.prototype.trim.call(i))})),e}}as([yt("XhrRequestTracker.interceptOpen")],Ih.prototype,"interceptOpen",null),as([yt("XhrRequestTracker.readyStateChangeListener")],Ih.prototype,"readyStateChangeListener",null),as([yt("XhrRequestTracker.interceptSetRequestHeader")],Ih.prototype,"interceptSetRequestHeader",null),as([yt("XhrRequestTracker.interceptSend")],Ih.prototype,"interceptSend",null);class Oh extends Nh{constructor(){super(),this.Ti=!1,this.Xp=null,this.tv=t=>{let{result:e,args:s,callerName:i}=t;this.interceptFetch(e,s,i)}}onEvent(t){this.ur=t}start(){this.Ti||this.sv()&&(this.ev(),this.Xp&&this.Xp.activate(),this.Ti=!0)}stop(){this.Ti&&(this.Xp&&this.Xp.deactivate(),this.Ti=!1)}sv(){return!!window.fetch&&"function"==typeof window.fetch}iv(t){if(t[0]&&"function"==typeof t[0].clone){const e=kt(t);return e[0]=t[0].clone(),e}return t}ev(){this.Xp||(this.Xp=Cs({target:window,methodName:"fetch",hook:this.tv,hookPrepareArgs:this.iv,options:{withCallerName:!0}}))}async interceptFetch(t,e,s){const i=e[0],n=e[1],r=new Request(i,n);if(!f(r.url))return;const o=Ie();let a;try{a=await t}catch(t){if(this.nv(t)||this.rv(t)||this.ov(t))return;throw t}const[c,h]=csString.prototype.split.call(r.url,"?"),l=Fe(c);if(a&&super.canCollect(a.status,l)){const e={library:s,method:r.method,url:l,queryParameters:h,requestTime:o,responseTime:Ie(),statusCode:a.status,requestBody:"",responseBody:"",requestHeaders:this.hv(r.headers),responseHeaders:this.hv(a.headers)};if(!a.bodyUsed&&super.isValidBodyType(e.responseHeaders))try{e.responseBody=await a.clone().text()}catch(t){if(this.rv(t))return}super.isValidBodyType(e.requestHeaders)&&(e.requestBody=await r.text()),this.ur(e)}}nv(t){return t instanceof TypeError}rv(t){return t instanceof DOMException&&"AbortError"===t.name}ov(t){return t instanceof DOMException&&csArray.prototype.some.call(Oh.cv,(e=>e===t.name))}hv(t){const e={};return t.forEach(((t,s)=>{t&&(e[csString.prototype.toLowerCase.call(s)]=csString.prototype.trim.call(t))})),e}}Oh.cv=["NoModificationAllowedError","InvalidStateError","OperationError"],as([yt("FetchRequestTracker.interceptFetch")],Oh.prototype,"interceptFetch",null);class Ph{constructor(){this.av=64e3,this.uv=5e3,this.lv=2e3,this.fv=8e3,this.Gh=!!self.TextEncoder,this.Gh&&(this.pv=new TextEncoder)}vv(t){return this.pv.encode(t).byteLength}mv(t,e,s){let i=0;t[e]&&(i+=this.vv(t[e]),i>this.fv&&(i=0,t[e]=bn.ELLIPSIS)),t[s]&&(i+=this.vv(csJSON.stringify(t[s])),i>this.fv&&(t[s]=Ph.truncatedObjectMarker))}wv(t){t.queryParameters&&this.vv(t.queryParameters)>this.lv&&(t.queryParameters=bn.ELLIPSIS)}gv(t){t.requestBody&&this.vv(t.requestBody)>this.av&&(t.requestBody=bn.ELLIPSIS),t.responseBody&&this.vv(t.responseBody)>this.uv&&(t.responseBody=bn.ELLIPSIS)}truncate(t){this.Gh?(this.wv(t),this.gv(t),this.mv(t,"customResponseHeaders","plainCustomResponseHeaders"),this.mv(t,"customRequestHeaders","plainCustomRequestHeaders")):(t.queryParameters="",t.requestBody="",t.responseBody="",t.customResponseHeaders="",t.customRequestHeaders="",t.plainCustomResponseHeaders={},t.plainCustomRequestHeaders={})}}Ph.truncatedObjectMarker={[bn.ELLIPSIS]:bn.ELLIPSIS},function(t){t.isValidJSONPath=function(t){if(!t)return!0;if(!function(t){const e=[];for(let s=0;s<t.length;++s)if("["===t[s])csArray.prototype.push.call(e,t[s]);else if("]"===t[s]){if(!(csString.prototype.indexOf.call(t,"[")>-1))return!1;csArray.prototype.pop.call(e)}return 0===e.length}(t))return!1;const e=csString.prototype.split.call(t,/[\[\]]/);return csArray.prototype.every.call(e,(t=>{const e=t[0],s=t[t.length-1];if(("'"===e||'"'===e)&&e!==s)return!1;const i=csString.prototype.split.call(t,".");return 0===i[0].length&&csArray.prototype.shift.call(i),csArray.prototype.every.call(i,(t=>{const e=/^\-?\d+$/.exec(t);return e?parseInt(e[0],10)>=0:"$"===t||/\w+/.test(t)}))}))},t.getJSONPathValue=function(t,e){if(!t)return;const s=csString.prototype.split.call(t,/[\$\[\]]/),i=[];csArray.prototype.forEach.call(s,(t=>{"'"!==t[0]&&'"'!==t[0]?csArray.prototype.push.call(i,...csArray.prototype.filter.call(csString.prototype.split.call(t,"."),(t=>t.length>0))):csArray.prototype.push.call(i,csString.prototype.substring.call(t,1,t.length-1))})),"$"===i[0]&&csArray.prototype.shift.call(i);let n=e;for(const t of i){if(void 0===n[t])return;n=n[t]}return n}}(bh||(bh={}));class kh{constructor(){this.yv=new Set(["age","cache-control","clear-site-data","expires","pragma","warning","downlink","ect","rtt","last-modified","connection","keep-alive","accept","accept-encoding","accept-language","expect","access-control-allow-origin","access-control-allow-credentials","access-control-allow-headers","access-control-allow-methods","access-control-expose-headers","access-control-max-age","access-control-request-headers","access-control-request-method","origin","timing-allow-origin","content-length","content-type","content-encoding","content-language","via","host","referrer-policy","user-agent","allow","server","accept-ranges","range","if-range","content-range","cross-origin-embedder-policy","cross-origin-opener-policy","cross-origin-resource-policy","content-security-policy","content-security-policy-report-only","expect-ct","feature-policy","strict-transport-security","upgrade-insecure-requests","x-content-type-options","x-download-options","x-frame-options","x-permitted-cross-domain-policies","x-powered-by","x-xss-protection","sec-fetch-site","sec-fetch-mode","sec-fetch-user","sec-fetch-dest"])}isValidStandardHeader(t){return this.yv.has(t)}}class Lh{constructor(){this.Ev=64e3,this.Av=100,this._v={collectQueryParam:!1,collectRequestBody:!1,collectResponseBody:!1,matchingBodyContents:[],plainResponseBodyAttributes:{},plainRequestBodyAttributes:{},requestBodyAttributes:{},responseBodyAttributes:{},standardRequestHeaders:{},standardResponseHeaders:{},customRequestHeaders:{},customResponseHeaders:{},plainCustomRequestHeaders:{},plainCustomResponseHeaders:{}},this.Rv=new kh}Sv(t){return t.length<=this.Ev}Tv(t){const e=t["content-type"];return void 0!==e&&(Me(e,"application/json")||Me(e,"application/graphql"))}Iv(t,e){return t&&this.Sv(t)&&this.Tv(e)}Pv(t,e,s,i){let n="request"===i?this.bv:this.Vv;if(void 0!==n||this.Iv(e,s)){if(void 0===n)try{n=csJSON.parse(e),"request"===i?this.bv=n:this.Vv=n}catch(t){return}const s=bh.getJSONPathValue(t,n);if(void 0!==s&&(null===s||!E(s))){const t=f(s)?s:csJSON.stringify(s);return bn.truncate(t,this.Av,bn.ELLIPSIS)}}}isBodyAttributeValueFound(t,e){let s,i;return"request-response"!==e.type&&"response"!==e.type||(s=this.Pv(e.path,t.responseBody,t.responseHeaders,"response")),"request-response"!==e.type&&"request"!==e.type||(i=this.Pv(e.path,t.requestBody,t.requestHeaders,"request")),S(s)||S(i)}collectBodyAttribute(t,e,s){let i;"request-response"!==e.type&&"response"!==e.type||(i=this.Pv(e.path,t.responseBody,t.responseHeaders,"response"),i&&(e.encrypted?this._v.responseBodyAttributes[e.path]=i:(i=s(i),this._v.plainResponseBodyAttributes[e.path]=i))),"request-response"!==e.type&&"request"!==e.type||(i=this.Pv(e.path,t.requestBody,t.requestHeaders,"request"),i&&(e.encrypted?i&&(this._v.requestBodyAttributes[e.path]=i):(i=s(i),this._v.plainRequestBodyAttributes[e.path]=i)))}isBodyContentMatching(t,e){return!!t.responseBody&&!!new csRegExp(e,"i").test(t.responseBody)}collectBodyContent(t){-1===csArray.prototype.indexOf.call(this._v.matchingBodyContents,t)&&csArray.prototype.push.call(this._v.matchingBodyContents,t)}collectCustomHeaders(t,e,s){const i=csString.prototype.toLocaleLowerCase.call(e.headerName);!t.responseHeaders[i]||"request-response"!==e.type&&"response"!==e.type||(e.encrypted?this._v.customResponseHeaders[i]=t.responseHeaders[i]:this._v.plainCustomResponseHeaders[i]=s(t.responseHeaders[i])),!t.requestHeaders[i]||"request-response"!==e.type&&"request"!==e.type||(e.encrypted?this._v.customRequestHeaders[i]=t.requestHeaders[i]:this._v.plainCustomRequestHeaders[i]=s(t.requestHeaders[i]))}collectStandardHeaders(t){if(!(Object.keys(this._v.standardRequestHeaders).length>0||Object.keys(this._v.standardResponseHeaders).length>0)){for(const[e,s]of Object.entries(t.requestHeaders))this.Rv.isValidStandardHeader(e)&&(this._v.standardRequestHeaders[e]=s);for(const[e,s]of Object.entries(t.responseHeaders))this.Rv.isValidStandardHeader(e)&&(this._v.standardResponseHeaders[e]=s)}}setCollectQueryParam(t){t&&(this._v.collectQueryParam=!0)}setCollectResponseBody(t){t&&(this._v.collectResponseBody=!0)}setCollectRequestBody(t){t&&(this._v.collectRequestBody=!0)}getCollectedDataPoints(){return this._v}}!function(t){t.CONTENTSQUARE="contentsquare.net",t.CLICKTALE="clicktale.net",t.FAKE_TRACKER="fake-tracker.content-square.fr"}(Th||(Th={}));class Mh{computeApiErrorCollectionOptions(){const t=new Set,e=[];if(this.rules)for(const s of this.rules)void 0!==s.statusCode&&t.add(s.statusCode),void 0!==s.url&&-1===csArray.prototype.indexOf.call(e,s.url)&&csArray.prototype.push.call(e,s.url);const s=[Th.CONTENTSQUARE,Th.CLICKTALE];return csArray.prototype.push.call(s,Th.FAKE_TRACKER),{statusCodes:t,urls:e,excludedDomains:s}}}class Dh extends Mh{constructor(t,e){super(),this.Cv=t,this.gt=e,this.rules=t.collectionRules}collectDataPoints(t,e){this._v=new Lh;let s=!1;if(this.Cv.collectionRules)for(const i of this.Cv.collectionRules)this.kv(i,t)&&this.Ov(i,t)&&this.Nv(i,t)&&(s=!0,this.xv(t,i,e));return s||(s=this.$v(t)),s&&e&&this.Cv.collectStandardHeaders&&this._v.collectStandardHeaders(t),s?this._v.getCollectedDataPoints():null}computeApiErrorCollectionOptions(){const t=this.Cv.collectionRules||[],e=new Set,s=[];for(const i of t)void 0!==i.statusCode&&e.add(i.statusCode),void 0!==i.url&&-1===csArray.prototype.indexOf.call(s,i.url)&&csArray.prototype.push.call(s,i.url);const i=[Th.CONTENTSQUARE,Th.CLICKTALE];return csArray.prototype.push.call(i,Th.FAKE_TRACKER),{statusCodes:e,urls:s,excludedDomains:i}}kv(t,e){return(!t.statusCode&&e.statusCode>=400||void 0!==t.statusCode&&t.statusCode===e.statusCode)&&(!t.url||-1!==csString.prototype.indexOf.call(e.url,t.url))}Ov(t,e){return!t.bodyContent||this._v.isBodyContentMatching(e,t.bodyContent)}Nv(t,e){const s=csArray.prototype.find.call(t.bodyAttributePaths,(t=>t.primary));return void 0===s||this._v.isBodyAttributeValueFound(e,s)}$v(t){return t.statusCode>=400}xv(t,e,s){e.bodyContent&&this._v.collectBodyContent(e.bodyContent);const i=xt(e.bodyAttributePaths,(t=>1===t.primary));if(i&&this._v.collectBodyAttribute(t,i,(t=>this.gt.anonymizePII(t))),s){this._v.setCollectQueryParam(e.collectQueryParam),this._v.setCollectResponseBody(e.collectResponseBody),this._v.setCollectRequestBody(e.collectRequestBody);for(const s of e.customHeaders)this._v.collectCustomHeaders(t,s,(t=>this.gt.anonymizePII(t)));const s=Vt(e.bodyAttributePaths,(t=>!t.primary));for(const e of s)this._v.collectBodyAttribute(t,e,(t=>this.gt.anonymizePII(t)))}}}class xh extends Mh{constructor(t,e){super(),this.Cv=t,this.gt=e,this.rules=t.configurableApiErrorRules}collectDataPoints(t,e){this._v=new Lh;const s=this.Mv(t,this.Cv.configurableApiErrorRules);return s.isMatching?(s.matchingBodyContents.length>0&&this._v.collectBodyContent(s.matchingBodyContents[0]),e&&this.Lv(t),this._v.getCollectedDataPoints()):null}computeApiErrorCollectionOptions(){const t=this.Cv.configurableApiErrorRules||[],e=new Set,s=[];for(const i of t)void 0!==i.statusCode&&e.add(i.statusCode),void 0!==i.url&&-1===csArray.prototype.indexOf.call(s,i.url)&&csArray.prototype.push.call(s,i.url);const i=[Th.CONTENTSQUARE,Th.CLICKTALE];return csArray.prototype.push.call(i,Th.FAKE_TRACKER),{statusCodes:e,urls:s,excludedDomains:i}}Mv(t,e){if(t.statusCode>=400)return{isMatching:!0,matchingBodyContents:[]};if(e)for(const s of e)if(this.Dv(t,s))return{isMatching:!0,matchingBodyContents:s.bodyContent?[s.bodyContent]:[]};return{isMatching:!1,matchingBodyContents:[]}}Dv(t,e){return!(t.statusCode!==e.statusCode||-1===csString.prototype.indexOf.call(t.url,e.url)||e.bodyContent&&!this._v.isBodyContentMatching(t,e.bodyContent))}Lv(t){this.Cv.collectStandardHeaders&&this._v.collectStandardHeaders(t),this.Cv.validCustomHeaders&&this.Uv(t,this.Cv.validCustomHeaders,Number(!0)),this.Cv.plainCustomHeaders&&this.Uv(t,this.Cv.plainCustomHeaders,Number(!1)),this.Hp(t.url,this.Cv.validUrls)&&(this.Cv.collectQueryParam&&this._v.setCollectQueryParam(Number(this.Cv.collectQueryParam)),this.Cv.collectResponseBody&&this._v.setCollectResponseBody(Number(this.Cv.collectResponseBody)),this.Cv.collectRequestBody&&this._v.setCollectRequestBody(Number(this.Cv.collectRequestBody)))}Uv(t,e,s){for(const i of e)this._v.collectCustomHeaders(t,{headerName:i,encrypted:s,type:"request-response"},(t=>this.gt.anonymizePII(t)))}Hp(t,e){return!!e&&csArray.prototype.some.call(e,(e=>-1!==csString.prototype.indexOf.call(t,e)))}}class Uh extends Sn{constructor(t){super(),this.$h=null,this.Fv=null,this.Fs=null,this.Th=null,this.Bv=["value","checked","src","data","alt"],this.qv={state:Ks.MaskedElementState.Child},this.Hv=t=>{for(const e of t){if(Ks.isMaskedElement(e.target)||Ks.isMaskedElementChild(e.target))for(let t=0;t<e.addedNodes.length;t+=1){const s=e.addedNodes[t];Ks.isMaskedElement(s)||Ks.isMaskedElementChild(s)||C(s)&&this.zv(s)}for(let t=0;t<e.removedNodes.length;t+=1){const s=e.removedNodes[t];qt.isConnected(s)||this.jv(s)}}},this.Gv=t}setMaskedElementSettings(t){this.Zv=t}startIdentifier(){this.isStarted||(this.isStarted=!0,this.onStart())}stopIdentifier(){return this.isStarted=!1,this.onStop()}start(){}stop(){}onStart(){var t,e,s,i;this.Zv||(mt.error("maskedElementSettings not initialized","MaskedElementIdentifier.start"),this.Zv={elementSelector:"",attrSelector:"",attrSelectors:[]});const{elementSelector:n,attrSelector:r,attrSelectors:o}=this.Zv;null!==(t=this.Th)&&void 0!==t||(this.Th=this.Wv()),0!==n.length&&(null!==(e=this.$h)&&void 0!==e||(this.$h=this.Qv()),this.$h.observe(n)),0!==r.length&&(null!==(s=this.Fv)&&void 0!==s||(this.Fv=this.Jv(o)),this.Fv.observe(r)),null!==(i=this.Fs)&&void 0!==i||(this.Fs=new rn(this.Hv,((t,e)=>"added"===e&&this.Kv(t)))),this.Fs.observe(),csSetTimeout(this.Gv)}onStop(){var t,e,s;this.$h&&(this.jv(document),this.$h.disconnect()),null===(t=this.Fv)||void 0===t||t.disconnect(),null===(e=this.Fs)||void 0===e||e.disconnect(),null===(s=this.Th)||void 0===s||s.disconnect()}Wv(){return window.ResizeObserver?new ResizeObserver((t=>{csArray.prototype.forEach.call(t,(t=>{this.resizeObserverCallback(t)}))})):null}Qv(){return new Lr((t=>{csArray.prototype.forEach.call(t,(t=>{this.Yv(t)?this.zv(t):(this.Xv(t),this.tm(t))}))}))}Jv(t){return new Lr((e=>{csArray.prototype.forEach.call(e,(e=>this.sm(e,t)))}))}resizeObserverCallback(t){const e=t.target.getBoundingClientRect(),s=Ks.getMaskedElementDetails(t.target);if(s.state!==Ks.MaskedElementState.Parent)return;if(e.width===s.width&&e.height===s.height)return;const i={state:Ks.MaskedElementState.Parent,width:e.width,height:e.height};Ks.setMaskedElementProperty(t.target,i),this.produceEvent({type:"ResizeMaskedElement",target:Qs(t.target),width:e.width,height:e.height})}tm(t){this.Th&&C(t)&&!M(t)&&this.Th.observe(t)}Yv(t){const e=csNodeparentNode.apply(t);return e?Ks.isMaskedElement(e)||Ks.isMaskedElementChild(e):!!B(t)&&(Ks.isMaskedElement(t.host)||Ks.isMaskedElementChild(t.host))}Kv(t){(Ks.isMaskedElement(t.host)||Ks.isMaskedElementChild(t.host))&&Ks.setMaskedElementProperty(t,this.qv)}jv(t){lt(t,NodeFilter.SHOW_ELEMENT).visitAll((t=>{Ks.unsetMaskedElementProperty(t)}))}Xv(t){const e=t.getBoundingClientRect(),s={state:Ks.MaskedElementState.Parent,width:e.width,height:e.height};Ks.setMaskedElementProperty(t,s),this.im(t),lt(t).visitAll((e=>e!=t&&Ks.setMaskedElementProperty(e,this.qv)))}zv(t){Ks.setMaskedElementProperty(t,this.qv),lt(t).visitAll((e=>e!=t&&Ks.setMaskedElementProperty(e,this.qv)))}im(t){var e;const s=null!==(e=js.getProperty(t,Ks.maskedAttributeProp))&&void 0!==e?e:{attributes:[]};for(let t=0;t<this.Bv.length;t+=1){const e=this.Bv[t];-1===csArray.prototype.indexOf.call(s.attributes,e)&&csArray.prototype.push.call(s.attributes,e)}0!==s.attributes.length&&Ks.setMaskedAttributeProperty(t,s)}sm(t,e){var s;const i=null!==(s=js.getProperty(t,Ks.maskedAttributeProp))&&void 0!==s?s:{attributes:[]};for(let s=0;s<t.attributes.length;s+=1){const n=t.attributes[s].name;-1===csArray.prototype.indexOf.call(i.attributes,n)&&csArray.prototype.some.call(e,(e=>csString.prototype.indexOf.call(e.attrName,n)>-1&&Y.call(t,e.selector)))&&csArray.prototype.push.call(i.attributes,n)}0!==i.attributes.length&&Ks.setMaskedAttributeProperty(t,i)}}Si([yt()],Uh.prototype,"resizeObserverCallback",null);class Vh{constructor(){this.nm=0,this.Ti=!1,this.rm="data-cs-capture",this.om=t=>{for(const e of t){if(In.isWhitelistedElement(e.target))for(let t=0;t<e.addedNodes.length;t+=1){const s=e.addedNodes[t];In.isWhitelistedElement(s)||C(s)&&this.hm(s)}for(let t=0;t<e.removedNodes.length;t+=1){const s=e.removedNodes[t];qt.isConnected(s)||this.am(s)}}}}start(){this.nm++,this.Ti||(this.Ti=!0,this.um())}um(){this.$h||(this.$h=new Lr((t=>Dt(t,(t=>this.hm(t))))));const t=this.lm?`[${this.rm}], ${this.lm}`:`[${this.rm}]`;this.$h.observe(t),this.Fs||(this.Fs=new rn(this.om,((t,e)=>"added"===e&&this.dm(t)))),this.Fs.observe()}stop(){this.Ti&&(this.nm--,0===this.nm&&(this.Ti=!1,this.fm()))}fm(){this.$h&&(this.am(document),this.$h.disconnect()),this.Fs&&this.Fs.disconnect()}setWhitelistedElementsSelector(t){Zs(t)&&(this.lm=t)}getWhitelistedElementsSelector(){return this.lm}hm(t){lt(t).visitAll((t=>{In.whitelistElement(t)}))}dm(t){In.isWhitelistedElement(t.host)&&In.whitelistElement(t)}am(t){lt(t,NodeFilter.SHOW_ELEMENT).visitAll((t=>{In.removeWhitelistElement(t)}))}}class Bh{constructor(t,e,s,i,n){this.tu=t,this.pm=e,this.vm=s,this.wm=i,this.en=n}getSensitiveStatus(){var t,e;return{started:this.vm.isStarted,useAnonymization:this.tu.shouldUseAnonymization(),capturedElementSelector:this.wm.getWhitelistedElementsSelector(),maskedElementSettings:this.pm.getMaskedElementSettings(null===(t=this.tu)||void 0===t?void 0:t.shouldMaskNonTextElements()),encryptionSelectors:null===(e=this.en)||void 0===e?void 0:e.getEncryptionSelectors()}}getElementSensitiveStatus(t){const e=this.vm.isStarted,s=this.tu.shouldUseAnonymization();return e?Ks.isMaskedElement(t)||Ks.isMaskedElementChild(t)?fa.MASKED:vr.shouldEncrypt(t)?fa.ENCRYPTED:s?In.isWhitelistedElement(t)?fa.CAPTURED:fa.ANONYMIZED:fa.CAPTURED:fa.ANONYMIZED}}const Hh=["setEncryptionSelectors"],$h=["setPIISelectors"],qh=["setCapturedElementsSelector"];class zh{constructor(t,e,s,i,n,r,o){this.ha=t,this.Za=e,this.pm=s,this.vm=i,this.wm=n,this.en=r,this.gm=o}init(){var t,e;this.gm&&this.en&&(null===(t=this.gm)||void 0===t||t.addSelector(null===(e=this.en)||void 0===e?void 0:e.getEncryptionSelectors())),this.Rp()}onStartTracking(t){this.vm.start(),this.ha.emitSensitiveStatusChange()}onBeforeArtificialPageView(){this.vm.stop(),this.ha.emitSensitiveStatusChange()}onAfterArtificialPageView(){this.vm.start(),this.ha.emitSensitiveStatusChange()}onBeforeSessionRenewal(){this.vm.stop(),this.ha.emitSensitiveStatusChange()}onOptout(){this.vm.stop(),this.ha.emitSensitiveStatusChange()}onReplayUnanonymizationConsentGranted(){this.ha.emitSensitiveStatusChange()}onReplayUnanonymizationConsentWithdrawn(){this.ha.emitSensitiveStatusChange()}Rp(){this.Za.register($h,(t=>{this.pm.setMaskedElementSettingsFromCommand(t),this.ha.emitSensitiveStatusChange()})),this.Za.register(qh,(t=>{this.wm.setWhitelistedElementsSelector(t),this.ha.emitSensitiveStatusChange()})),this.Za.register(Hh,(t=>{var e,s;null===(e=this.en)||void 0===e||e.setEncryptionSelectors(t),null===(s=this.gm)||void 0===s||s.addSelector(t)}))}}class Fh extends ni{constructor(t,e,s,i,n){super(),this.Wa=t,this.pm=e,this.wm=s,this.gm=i,this.tu=n}onStart(){var t,e;this.wm.start(),this.Wa.setMaskedElementSettings(this.pm.getMaskedElementSettings(null===(t=this.tu)||void 0===t?void 0:t.shouldMaskNonTextElements())),this.Wa.startIdentifier(),null===(e=this.gm)||void 0===e||e.start()}onStop(){var t;this.wm.stop(),this.Wa.stopIdentifier(),null===(t=this.gm)||void 0===t||t.stop()}}const jh=["networkRequest:maskUrls"],Gh=["networkRequest:maskUrls:reset"];class Wh{constructor(t,e){this.ym=t,this.Qa=e}init(){this.ym.register(jh,(t=>{if(f(t))this.Qa.addPartialUrlMaskingPattern(t);else if(csArray.isArray(t))for(const e of t)f(e)&&this.Qa.addPartialUrlMaskingPattern(e)})),this.ym.register(Gh,(()=>this.Qa.resetPartialUrlMaskingPatterns()))}}var Yh,Qh;!function(t){function e(t,e){const n=function(t,e){switch("date"!==t.rule_type||"less_than"!==t.match_operation&&"greater_than"!==t.match_operation||(e=(new csDate(e).valueOf()/1e3).toFixed(0)),t.match_operation){case"exact":switch(t.rule_type){case"string":return!!f(t.pattern)&&csString.prototype.toLowerCase.call(e)===csString.prototype.toLowerCase.call(t.pattern);case"boolean":return e===t.pattern||e===csString(t.pattern);case"number":return!!w(e)&&Number(e)===Number(t.pattern);default:return e===t.pattern}case"starts_with":return!!f(t.pattern)&&0===csString.prototype.indexOf.call(e,t.pattern);case"ends_with":return!!f(t.pattern)&&De(e,t.pattern);case"contains":return!!f(t.pattern)&&-1!==csString.prototype.indexOf.call(e,t.pattern);case"regex":if(!f(t.pattern))return!1;try{return new csRegExp(t.pattern).test(e)}catch(t){return ns.warn(`targeting.matchOperation.regex invalid ${null==t?void 0:t.message}`),!1}case"simple":return!!f(t.pattern)&&i(e)===i(t.pattern);case"greater_than":return Number(e)>Number(t.pattern);case"less_than":return Number(e)<Number(t.pattern);case"exact_date":{const s=Number(t.pattern);if(!m(s))return!1;const i=new csDate(1e3*s);return new csDate(e).toDateString()===i.toDateString()}case"exact_days_ago":return s(t,e);case"more_than_days_ago":return function(t,e){const s=Number(t.pattern);if(!m(s))return!1;const i=(new csDate).getTime()/1e3-86400*(Number(s)+1);return new csDate(e).getTime()/1e3<=i}(t,e);case"less_than_days_ago":return function(t,e){const i=Number(t.pattern);if(!m(i))return!1;if(0===i)return s(t,e);const n=(new csDate).getTime()/1e3-86400*i;return new csDate(e).getTime()/1e3>=n}(t,e);case"unknown":return function(t){return!w(t)||(f(t)?""===csString.prototype.trim.call(t):v(t)?!0===t:!!m(t)&&0!==t)}(e);default:return ns.warn(`targeting.matchOperation.regex not managed operation ${t.match_operation}`),!1}}(t,e);return t.negate?!n:n}function s(t,e){const s=new csDate,i=s.setDate(s.getDate()-Number(t.pattern)),n=new csDate(i);return new csDate(e).toDateString()===n.toDateString()}function i(t){const e=Qe(Me(t,"http://")||Me(t,"https://")?t:`https://${t}`);return null!==e?csString.prototype.replace.call(e.host,/^www./,""):t}t.isUrlMatching=function(t,s){for(const i of t)if(e(i,s))return!0;return!1},t.isMatching=function(t,s){if(f(s)){for(const i of t)if(e(i,s))return!0}else if(v(s))for(const i of t)if(e(i,csString(s)))return!0;return!1}}(Yh||(Yh={}));class Zh{constructor(){this.Em=[],this.Am=[]}setTargetingRules(t){for(const e of t)"url"===e.component?csArray.prototype.push.call(this.Em,e):"trigger"===e.component&&csArray.prototype.push.call(this.Am,e)}matchUrl(t){return Yh.isUrlMatching(this.Em,t)}matchTrigger(t){return Yh.isMatching(this.Am,t)}}class Xh extends ni{constructor(t,e,s){super(),this._m=t,this.Rm=e,this.Nt=s}init(){this.Sm=new Zh,this._m&&this.Sm.setTargetingRules(this._m)}onStart(){}checkInitialUrlTargetingRules(){const t=this.Nt.getAnonymizedUrl();this.Tm(t,"url")&&this.Rm()}onStop(){}onTargetingRulesArtificialPageview(t){this.isStarted&&this.Tm(t,"url")&&this.Rm()}onExternalEvent(t){this.isStarted&&this.Tm(t.name,"trigger")&&this.Rm()}Tm(t,e){var s,i;return!("url"!==e||!f(t)||!(null===(s=this.Sm)||void 0===s?void 0:s.matchUrl(t)))||!("trigger"!==e||!(null===(i=this.Sm)||void 0===i?void 0:i.matchTrigger(t)))}}class Kh{constructor(t,e,s,i,n,r){this._m=t,this.Im=e,this.ha=s,this.Pm=i,this.Td=n,this.Nt=r}init(){this.bm=new Xh(this._m,this.Im,this.Nt),this.Td.addListener(this.bm),this.bm.init()}start(){this.bm.start()}stop(){this.bm.stop()}checkInitialUrlTargetingRules(){this.bm.checkInitialUrlTargetingRules()}emitTargetingCollectState(){const t=this.Pm.getInitialCollectState();t===yi.ANALYTICS_ONLY?this.ha.emitCollectStateChange(yi.ANALYTICS_ONLY_RULES_TARGETING,fi.ETR_OFF):t===yi.RECORDING_GLOBAL_SAMPLING&&this.ha.emitCollectStateChange(yi.RECORDING_RULES_TARGETING,fi.ETR_OFF)}}class Jh{constructor(t,e,s,i,n,r,o,a,c,h,l,d,u,p,g,m,y,f,v,E,S,w,R,A,b,T,C,_,N){var I=this;this.Ca=t,this.Uu=e,this.bt=s,this.Vt=i,this.ha=n,this.Za=r,this.Vm=o,this.wt=a,this.Cm=c,this.km=h,this.Om=l,this.Zd=d,this.gt=u,this.Zl=p,this.uh=g,this.Nt=m,this.Nm=y,this.Td=f,this.Cu=v,this.Ms=E,this.xm=S,this.Ya=w,this.$m=R,this.qr=A,this.Xa=b,this.Mm=T,this.Lm=C,this.Pm=_,this.pm=N,this.Dm=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=I.Vt.getSession();null===e?(I.Um=new Kh(I.wt.recordTargetingRules,I.Fm,I.ha,I.Pm,I.Td,I.Nt),I.Um.init(),I.Um.start()):e.collectState!==yi.RECORDING_RULES_TARGETING&&e.collectState!==yi.ANALYTICS_ONLY_RULES_TARGETING||I.Fm(t)},this.Fm=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];I.Bm.onLoad((()=>{var e,s;null===(e=I.Um)||void 0===e||e.emitTargetingCollectState(),null===(s=I.Um)||void 0===s||s.stop(),I.ha.emitStartTracking(t)})),I.qm(t)},this.qm=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];I.km.isActive()||(I.pm.init(),I.Hm.start(t),I.Bm.start())},this.zm=()=>{this.ha.emitBeforeSessionRenewal(),this.jm(!0),this.ha.emitAfterSessionRenewal()},this.Gm=()=>{this.ha.emitBeforeSessionRenewal(),this.Pm.refreshQuota(),this.Pm.onQuotaReady((t=>{t!==yi.QUOTA_REACHED&&(this.jm(!0),this.ha.emitAfterSessionRenewal())}))}}start(){if(this.Cm.init(),this.km.init(),this.km.isActive())return;let t,e,s,i,n,r,o,a,c,h,l,d,u,p,g,m,y;this.qr.schedule((()=>{l=new zc(this.Vt,this.bt),p=new wh(l),h=new Mc(this.Zl),d=new Uh((()=>{})),g=new Vh;const f=new Fh(d,this.pm,g,y,this.Zm());u=new Bh(this.Zm(),this.pm,f,g,m);const v=new zh(this.ha,this.Za,this.pm,f,g,m,y);v.init(),this.ha.addListener(v),t=new vc(this.wt,this.Ca,this.bt,this.Zl,h,this.Za,l,new hh(ns),this.Cu,this.Xa,this.Td,u),e=new zo(this.Za,this.Vt,this.wt,this.Ca,this.Uu,this.gt),c=new uh(u);const E=new nh(this.wt);a=new ih(this.wt,E,c,u,this.Cu),a.init();const S=new Sh;s=new Vo(this.bt,this.Vt,this.Za,this.Cu,E,this.wt,S,c),i=new Ko(this.wt,this.Ca,this.bt,this.Za,this.gt,l,this.Nt),this.Hm=new Lc(this.wt,this.Za,this.ha,this.Ca,this.bt,this.Vt,this.Zd,this.Ms,this.uh,this.Nt,this.Ya,S,this.Td,this.Wd,void 0),this.Wm=new qc(this.wt,this.bt,this.Vt,this.Za),n=new Jc(this.wt,this.Za,this.Uu,this.Ca,this.Td),r=new sh(this.Za),o=new dh(this.wt,new xe(this.wt,this.gt),this.Xa),this.Bm=new Dc})),this.wt.apiErrors.enabled&&this.qr.schedule((()=>{this.Qa=new Cc,this.Qm=new Wh(this.Za,this.Qa),this.Qm.init()})),this.wt.apiErrors.enabled&&this.qr.schedule((()=>{var t;let e;e=(null===(t=this.wt.apiErrors.collectionRules)||void 0===t?void 0:t.length)?new Dh(this.wt.apiErrors,this.gt):new xh(this.wt.apiErrors,this.gt),this.Xi=new oh(new Ih,new Oh,e),this.tn=new ah(this.Qa,this.uh),this.dn=new Ph;const s=new yh(this.Xi,this.tn,this.wt,this.Ca,this.Cu,this.Za,this.Xa);s.init(),this.ha.addListener(s)})),this.wt.jsErrorsEnabled&&this.qr.schedule((()=>{this.Sp=new eh,this.Yi=new ch(this.gt,this.Nt);const t=new Eh(this.Sp,this.Yi,this.wt,this.Ca,this.Cu,this.Za,this.Td,this.Nt,this.Xa);t.init(),this.ha.addListener(t)})),this.qr.schedule((()=>{this.Om.init()})),this.qr.schedule((()=>{s.init()})),this.qr.schedule((()=>{e.init()})),this.qr.schedule((()=>{i.init()})),this.qr.schedule((()=>{this.xm.init()})),this.qr.schedule((()=>{this.Hm.init()})),this.qr.schedule((()=>{this.Wm.init()})),this.qr.schedule((()=>{n.init()})),this.qr.schedule((()=>{this.Nm.init()})),this.qr.schedule((()=>{r.init()})),this.qr.schedule((()=>{o.init()})),this.qr.schedule((()=>{this.$m.init()})),this.qr.schedule((()=>{this.ha.addListener(this.Wm),this.ha.addListener(this.Vm),this.ha.addListener(t),this.ha.addListener(this.Om),this.ha.addListener(s),this.ha.addListener(i),this.ha.addListener(this.xm),this.ha.addListener(this.Hm),this.ha.addListener(n),this.ha.addListener(e),this.ha.addListener(a),this.ha.addListener(o),this.ha.addListener(p)})),ph.isRecordingSupported()&&this.qr.schedule((()=>{const t=new bo(c,this.Vt,this.wt,this.Ca,this.Za,this.gt,l,d,this.Yi,this.Xi,this.tn,this.Qa,this.ha,this.Td,this.Cu,this.Ya,this.Xa,this.uh,this.dn,this.Zm(),this.Jm,m);t.init(),this.ha.addListener(t),s.setRecordingService(t.recordingService)})),this.qr.schedule((()=>{t.init()})),this.qr.schedule((()=>{this.wt.isQuotaEnabled()?l.onSessionExpired((()=>{this.Gm()})):l.onSessionExpired((()=>{this.zm()})),this.jm()}))}jm(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.wt.hasTargetingRules())return this.Dm(t),this.Za.start(),void(this.Um&&this.Um.checkInitialUrlTargetingRules());this.Za.start(),this.Bm.onLoad((()=>{this.ha.emitStartTracking(t)})),Gc(this.wt)&&!t||this.qm(t)}Zm(){if(this.tu)return this.tu;const t=new _h;return this.tu=new Ch(this.Zd,this.wt,this.Nt,t),this.tu.init(),this.tu.shouldUseAnonymization()&&le.counters.pageAnonymisation.count("anonymized-on-start"),this.tu}}class tl{constructor(t,e,s,i,n,r,o,a){this.wt=t,this.bt=e,this.$s=s,this.Km=i,this.Ym=n,this.Xm=r,this.tw=o,this.ew=a}compute(t){var e,s;this.wt.crossDomainTracking&&!this.wt.cookielessTrackingEnabled?this.wt.crossDomainSingleIframeTracking?null===(e=this.tw)||void 0===e||e.start((()=>this.iw(t))):null===(s=this.Xm)||void 0===s||s.applyUpToDate((()=>this.iw(t))):this.iw(t)}iw(t){this.Ym.handle(),this.Km.clear(),this.nw()?(this.Km.restoreClearedVisitor(),t(!0)):(this.$s.exclude(this.wt),t(!1))}nw(){const t=Zt.boolean(this.wt.sampleRate);return this.ew.isForceIncluded()||!this.$s.isExcluded()&&this.bt.doesVisitorExist()||!this.$s.isExcluded()&&t}}!function(t){t.generate=function(){const t=navigator.userAgent+navigator.language+navigator.platform,e=csString.prototype.slice.call(function(t){let e=0;for(let s=0;s<t.length;s+=1)e=csString.prototype.charCodeAt.call(t,s)+(e<<6)+(e<<16)-e;return Math.abs(e)}(t).toString(16),-4);let s=(new csDate).getTime();const i="xxxxxxxx-hhhh-axxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=(s+16*Math.random())%16|0;return s=Math.floor(s/16),("x"===t?e:7&e|8).toString(16)}));return csString.prototype.replace.call(i,"hhhh",e)}}(Qh||(Qh={}));class el{constructor(t,e,s,i){this.wt=t,this.rw=e,this.ha=s,this.Vt=i,this.ow=1e4}createOrUpdateVisitor(){var t;let e=this.getVisitor();null===e&&(e=this.hw(),null===(t=this.Vt)||void 0===t||t.removeSession()),this.aw(e),this.setVisitor(e)}hw(){return{id:Qh.generate(),visitsCount:0,appliedTrackingDraw:this.wt.lastTrackingDraw,creationTimestamp:Pe(),lastVisitTimestamp:0,hitTimestamp:0,expires:Ie()+this.wt.visitorCookieTimeout,allowSubdomains:this.wt.allowSubdomains,identityPrint:null}}aw(t){const e=Pe();this.Vt&&!this.Vt.doesSessionExist()&&(t.visitsCount+=1,t.lastVisitTimestamp=e),t.hitTimestamp=e,t.appliedTrackingDraw=this.wt.lastTrackingDraw,this.uw=t.visitsCount}getRequestParameters(){const t=this.getVisitor();return t?{uu:t.id,sn:`${t.visitsCount}`,hd:`${t.hitTimestamp}`}:{}}getVisitor(){return this.rw.get()}setVisitor(t){this.rw.set(t)}doesVisitorExist(){return null!==this.rw.get()}resetVisitor(){this.lw(),this.ha.emitAfterVisitorCleared()}removeVisitor(){this.rw.remove()}hasAllowSubdomainsChanged(){const t=this.getVisitor();return!!t&&t.allowSubdomains!==this.wt.allowSubdomains}handleSubdomainChange(){this.rw.handleSubdomainChange()}isSessionRenewed(){const t=this.getVisitor();return null!==t&&void 0!==this.uw&&t.visitsCount!==this.uw}fw(){return!S(this.pw)||Ie()-this.pw>this.ow}renewVisitor(){this.fw()?(this.pw=Ie(),this.lw(),this.ha.emitAfterVisitorRenewal()):ns.warn("session:start:newVisitor is trying to renew visitor under time limit")}lw(){this.ha.emitBeforeVisitorRenewal(),this.removeVisitor()}}const sl="_cs_s",il=18e5,nl=/^(\d+\.[01356789TBWX](\.[01])?(\.[39])?)(\.\d+)?$/,rl=".";var ol,al;!function(t){t[t.NOT_FOUND=0]="NOT_FOUND",t[t.EXPIRED=1]="EXPIRED",t[t.FOUND=2]="FOUND"}(ol||(ol={}));class cl{constructor(t,e,s){this.wt=t,this.Mm=e,this.mw=s,this.vo=null,this.gw=!1}get(t){const e=this.getRawSession(t);return this.isValid(e)?cl.fromString(e):null}getRawSession(t){if(t){const t=this.yw();return cl.Ew(t)}const{sessionString:e,status:s}=this.Aw(),i=cl.Ew(e);if(s!==ol.EXPIRED)return i;if(this.wt.cookielessTrackingEnabled)return null;const n=this.yw();if(!n)return null;const r=csString.prototype.split.call(n,rl);if(!cl._w(r))return n;const o=r[r.length-1],a=parseInt(o,10);return isNaN(a)||this.Rw(a),i}onCookieToSet(t){this.Sw=t}onCookieToRemove(t){this.Tw=t}set(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:18e5;var s;const i=Ie()+e;let n=this.toString(t);n+=`${rl}${i}`,this.Iw(n,i),this.wt.cookielessTrackingEnabled?this.mw.setItem(sl,n):(this.Mm.set(sl,n,e),null===(s=this.Sw)||void 0===s||s.call(this,sl,n,e))}remove(){var t;this.wt.cookielessTrackingEnabled?this.mw.removeItem(sl):(this.Mm.delete(sl),null===(t=this.Tw)||void 0===t||t.call(this,sl)),this.Pw()}handleSubdomainChange(){if(this.wt.cookielessTrackingEnabled)return;const t=this.get(!0);t&&(this.wt.allowSubdomains?this.Mm.delete(sl,us.CURRENT_DOMAIN):this.Mm.delete(sl,this.Mm.getRootDomain()),this.set(t))}isValid(t){return null!==t&&cl.isValidSessionString(t)}toString(t){return csArray.prototype.join.call([t.pageNumber,t.collectState,t.etrState,t.etrStatus],rl)}Iw(t,e){this.vo={sessionString:t,expires:e}}Aw(){return this.vo?this.vo&&Ie()<=this.vo.expires?{sessionString:this.vo.sessionString,status:ol.FOUND}:{sessionString:this.vo.sessionString,status:ol.EXPIRED}:{sessionString:this.yw(),status:ol.NOT_FOUND}}Pw(){this.vo=null}Rw(t){this.vo&&(this.vo.expires=t,this.gw=!0)}isCacheRefreshed(){return this.gw}resetCacheRefreshed(){this.gw=!1}yw(){if(this.wt.cookielessTrackingEnabled){const t=this.mw.getItem(sl);return!t||this.bw(t)?null:t}const t=this.Mm.get(sl);return!t||this.bw(t)?null:t}bw(t){const e=csString.prototype.split.call(t,rl);if(!cl._w(e))return!1;const s=parseInt(e[e.length-1],10);return!isNaN(s)&&Ie()>s}static _w(t){return 13===t[t.length-1].length}static Ew(t){var e;if(!t)return null;const s=null===(e=csString.prototype.match.call(t,nl))||void 0===e?void 0:e[1];return null!=s?s:null}static fromRawString(t){const e=cl.Ew(t);return null!==e?cl.fromString(e):null}static fromString(t){var e,s;const[i,n,r,o]=csString.prototype.split.call(t,rl);return{collectState:n,etrState:null!==(e=r)&&void 0!==e?e:fi.ETR_OFF,etrStatus:null!==(s=o)&&void 0!==s?s:Ei.ETR_NOT_SAVED_SESSION,pageNumber:parseInt(i,10)}}static isValidSessionString(t){return nl.test(t)}}!function(t){t[t.NO=0]="NO",t[t.WITHDRAWN=1]="WITHDRAWN",t[t.GRANTED=2]="GRANTED"}(al||(al={}));class hl{constructor(t,e){this.Vw=t,this.Pm=e,this.Cw=null,this.kw=0,this.Ow=al.NO}setDynamicVariablesService(t){this.Nw=t}createOrUpdateSession(){this.xw(),this.$w=Ie(),this.kw=0;let t=this.Mw();null===t?(t=this.Lw(),this.Dw(t),this.Uw(t)):(t=this.Pm.sanitizeSessionCollectState(t),this.Dw(t),t.collectState=this.Pm.getEligibleCollectState(t)),this.setSession(t)}grantReplayRecording(t){t.collectState=this.Pm.getInitialCollectState(),t.collectState=this.Pm.computeInitialCollectStateFromRecordingConsentGranted(t),this.setSession(t)}grantReplayRecordingBeforeSessionStart(){this.Ow=al.GRANTED}withdrawnReplayRecording(t){t.collectState=this.Pm.getRecordingConsentWithdrawn(),this.setSession(t)}withdrawnReplayRecordingBeforeSessionStart(){this.Ow=al.WITHDRAWN}Uw(t){this.Ow===al.WITHDRAWN?(t.collectState=this.Pm.getRecordingConsentWithdrawn(),this.setSession(t)):this.Ow===al.GRANTED?t.collectState=this.Pm.computeInitialCollectStateFromRecordingConsentGranted(t):t.collectState=this.Pm.computeInitialCollectState(t),this.Ow=al.NO}Lw(){return{pageNumber:0,collectState:this.Pm.getInitialCollectState(),etrState:fi.ETR_OFF,etrStatus:Ei.ETR_NOT_SAVED_SESSION}}Dw(t){t.pageNumber+=1}isReplayRecorded(){const t=this.getSession();return!!t&&this.Pm.isReplayRecorded(t)}isTemporarilyRecorded(){const t=this.getSession();return(null==t?void 0:t.collectState)===yi.RECORDING_TEMPORARILY}abortQuotaServiceRequest(){this.Pm.abortQuotaServiceRequest()}getRequestParameters(){const t={},e=this.getSession();return null!==e&&(t.pn=`${e.pageNumber}`),t}getSession(){return this.Vw.get()}Mw(){return this.Vw.get(!0)}doesSessionExist(){return null!==this.Vw.get()}setSession(t){this.Vw.set(t)}refreshSession(){const t=this.Mw();t&&this.setSession(t)}removeSession(){this.Vw.remove()}getCollectStates(){const t=this.getSession(),e=[];return t&&(t.collectState!==yi.ANALYTICS_ONLY&&csArray.prototype.push.call(e,t.collectState===yi.RECORDING_RULES_TARGETING?yi.RECORDING_GLOBAL_SAMPLING:t.collectState),t.etrState===fi.ETR_ON&&csArray.prototype.push.call(e,yi.RECORDING_ETR_SAMPLING)),e}updateCollectState(t,e){const s=this.getSession();null!==s&&(s.collectState=t,s.etrState=e,this.setSession(s))}hasValidSession(){const t=this.Vw.getRawSession();return this.Vw.isValid(t)}handleSubdomainChange(){this.Vw.handleSubdomainChange()}pollCacheRefreshEvent(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=this.Vw.isCacheRefreshed();return e&&t&&this.Vw.resetCacheRefreshed(),e}extendSessionPeriodically(){this.Cw||this.Fw()}extendSession(){const t=this.getSession();return null===t?(ns.warn("extendSession is trying to extend an expired session"),this.xw(),!1):(this.Vw.set(t,il),!0)}Fw(){this.Bw()?this.xw():this.extendSession()&&(this.qw(),this.Hw())}Hw(){this.Cw=window.csSetTimeout((()=>{this.Fw()}),174e4)}Bw(){return 1434e4-(Ie()+il-this.$w)<0}xw(){this.Cw&&(window.csClearTimeout(this.Cw),this.Cw=null)}qw(){this.kw+=1,this.Nw.trackDynamicVariable("session_expiry_update",this.kw)}}class ll{constructor(t,e,s){this.wt=t,this.bt=e,this.$s=s}clear(){this.zw()&&(this.jw=this.bt.getVisitor(),this.bt.removeVisitor()),this.Gw()&&this.$s.removeExclusion()}zw(){return this.bt.doesVisitorExist()&&this.bt.getVisitor().appliedTrackingDraw!==this.wt.lastTrackingDraw}Gw(){return this.$s.getAppliedTrackingDraw()!==this.wt.lastTrackingDraw}restoreClearedVisitor(){this.jw&&this.bt.setVisitor(this.jw)}}class dl{constructor(t,e,s){this.bt=t,this.Vt=e,this.Zw=s}handle(){this.bt.hasAllowSubdomainsChanged()&&(this.bt.handleSubdomainChange(),this.Vt.handleSubdomainChange(),this.Zw.handleSubdomainChange())}}const ul="_cs_c";var pl;!function(t){t[t.NOT_REQUIRED=0]="NOT_REQUIRED",t[t.NOT_EXPRESSED=1]="NOT_EXPRESSED",t[t.GRANTED=2]="GRANTED",t[t.WITHDRAWN=3]="WITHDRAWN"}(pl||(pl={}));class gl{constructor(t,e,s){this.wt=t,this.Mm=e,this.Lm=s}get(){let t;return t=this.wt.cookielessTrackingEnabled?this.Lm.getItem(ul):this.Mm.get(ul),null===t?t:Number(t)}set(t){this.wt.cookielessTrackingEnabled?this.Lm.setItem(ul,csString(t)):this.Mm.set(ul,csString(t),Qt)}remove(){this.wt.cookielessTrackingEnabled?this.Lm.removeItem(ul):this.Mm.delete(ul)}handleSubdomainChange(){this.wt.cookielessTrackingEnabled||(this.wt.allowSubdomains?this.Mm.delete(ul,us.CURRENT_DOMAIN):this.Mm.delete(ul,this.Mm.getRootDomain()))}}class ml{constructor(t,e,s){this.wt=t,this.Vt=e,this.ha=s}grantReplayConsent(){if(!Co.isReplayConsentNeeded(this.wt))return;const t=this.Vt.getSession();t?Co.isRecordingBlockedByConsent(t)&&(this.Vt.grantReplayRecording(t),this.ha.emitAfterReplayRecordingConsentGranted()):this.Vt.grantReplayRecordingBeforeSessionStart()}withdrawReplayConsent(){if(!Co.isReplayConsentNeeded(this.wt))return;const t=this.Vt.getSession();t?Co.isRecordingWithDrawn(t)||(this.Vt.withdrawnReplayRecording(t),this.ha.emitAfterReplayRecordingConsentWithdrawn()):this.Vt.withdrawnReplayRecordingBeforeSessionStart()}}const yl=["replay:consent:unanonymized:granted","trackConsentGranted"],fl=["replay:consent:unanonymized:withdrawn","trackConsentWithdrawn"],vl=["replay:consent:startForSession:granted"],El=["replay:consent:startForSession:withdrawn"];class Sl{constructor(t,e,s,i,n){this.wt=t,this.Za=e,this.Zd=s,this.Vt=i,this.ha=n}init(){this.Ww=new ml(this.wt,this.Vt,this.ha),this.Zd.setInitialConsent(),this.Rp()}Rp(){this.Za.register(yl,(()=>{this.Zd.grantReplayAnonymizationConsent()})),this.Za.register(fl,(()=>{this.Zd.withdrawReplayAnonymizationConsent()})),this.Za.register(vl,(()=>{this.Ww.grantReplayConsent()})),this.Za.register(El,(()=>{this.Ww.withdrawReplayConsent()}))}onOptout(){this.Zd.removeAllConsents()}onBeforeVisitorRenewal(){this.Zd.removeAllConsents()}onAfterVisitorRenewal(){this.Zd.setInitialConsent()}onAfterVisitorCleared(){this.Zd.setInitialConsent()}}class wl{constructor(t,e,s){this.wt=t,this.rw=e,this.ha=s}setInitialConsent(){const t=this.rw.get();(null===t||this.hasConsentRequiredChanged(t))&&this.setDefaultReplayAnonymization()}hasConsentRequiredChanged(t){const e=this.wt.consentRequired;return e&&t===pl.NOT_REQUIRED||!e&&t!==pl.NOT_REQUIRED}handleSubdomainChange(){this.rw.handleSubdomainChange()}setDefaultReplayAnonymization(){const t=this.wt.consentRequired?pl.NOT_EXPRESSED:pl.NOT_REQUIRED;this.rw.set(t)}grantReplayAnonymizationConsent(){this.wt.consentRequired&&(this.rw.set(pl.GRANTED),this.ha.emitReplayUnanonymizationConsentGranted())}withdrawReplayAnonymizationConsent(){this.wt.consentRequired&&(this.rw.set(pl.WITHDRAWN),this.ha.emitReplayUnanonymizationConsentWithdrawn())}removeAllConsents(){this.rw.remove()}isReplayUnanonymizedAllowedByConsent(){return!this.wt.consentRequired||this.rw.get()===pl.GRANTED}getRequestParameters(){return{uc:`${this.rw.get()}`}}}class Rl{constructor(t,e,s,i,n,r,o){this.ha=t,this.Za=e,this.Vm=s,this.Cm=i,this.km=n,this.Qw=r,this.Om=o}start(){this.ha.addListener(this.Qw),this.ha.addListener(this.Om),this.ha.addListener(this.Vm),this.Om.init(),this.Cm.init(),this.km.init(),this.km.isActive()||this.Za.start()}}const Al="_cs_ex",bl=2592e6,Tl=/^[0-9]+$/;class Cl{constructor(t,e,s){this.wt=t,this.Mm=e,this.mw=s}onCookieToSet(t){this.Sw=t}onCookieToRemove(t){this.Tw=t}get(){return this.wt.cookielessTrackingEnabled?Number(this.mw.getItem(Al)):Number(this.Mm.get(Al))}set(t){var e;this.wt.cookielessTrackingEnabled?this.mw.setItem(Al,t):(this.Mm.set(Al,t,bl),null===(e=this.Sw)||void 0===e||e.call(this,Al,t,bl))}remove(){var t;this.wt.cookielessTrackingEnabled?this.mw.removeItem(Al):(this.Mm.delete(Al),null===(t=this.Tw)||void 0===t||t.call(this,Al))}static isValidExclusionString(t){return Tl.test(t)}}class _l{constructor(t,e){this.cr=t,this.rw=e}exclude(t){this.rw.set(csString(t.lastTrackingDraw))}removeExclusion(){this.rw.remove()}isExcluded(){return this.Jw()||this.Kw()}Jw(){return 0!==this.getAppliedTrackingDraw()}getAppliedTrackingDraw(){return this.rw.get()}Kw(){return csString.prototype.indexOf.call(this.cr.href,Al)>0}}class Nl{constructor(t){this.Bu=t}onOptout(){this.Bu.removeExclusion()}}var Il;!function(t){t.SessionReplay="SR",t.None=""}(Il||(Il={}));class Ol{constructor(t){this.Nt=t,this.Yw=new csRegExp(".^")}setExcludeUrlForSessionReplay(t){try{this.Yw=new csRegExp(t)}catch(e){ns.warn(`excludeURLforReplay - invalid regex '${t}'`),this.Yw=new csRegExp(".*")}}Xw(){return this.Yw.test(this.Nt.getAnonymizedUrl())?Il.SessionReplay:Il.None}isUrlExcludedForSessionReplay(){return this.Xw()===Il.SessionReplay}getRequestParameters(){return{ex:this.Xw()}}}const Pl=["excludeURLforReplay"];class kl{constructor(t,e){this.Bu=t,this.Za=e}init(){this.Za.register(Pl,(t=>{f(t)&&this.Bu.setExcludeUrlForSessionReplay(t)}))}}const Ll="_cs_inc";class Ml{constructor(t,e){this.cr=t,this.Mm=e}isForceIncluded(){return this.tg()||this.sg()}isForceReplayRecorded(){return this.eg(yi.RECORDING_GLOBAL_SAMPLING)}tg(){return null!==this.Mm.get(Ll)}eg(t){return this.Mm.get(Ll)===t}sg(){return csString.prototype.indexOf.call(this.cr.href,Ll)>0}}const Dl="_cs_optout";class xl{constructor(t,e,s){this.wt=t,this.Mm=e,this.Lm=s}get(){return this.wt.cookielessTrackingEnabled?this.Lm.getItem(Dl):this.Mm.get(Dl)}set(t){this.wt.cookielessTrackingEnabled?this.Lm.setItem(Dl,t):this.Mm.set(Dl,t,Qt)}}class Ul{constructor(t,e,s){this.ha=t,this.cr=e,this.rw=s}init(){!this.isActive()&&this.ig()&&this.activate()}isActive(){return"1"===this.rw.get()}activate(){this.ha.emitOptout(),this.rw.set("1")}ig(){return csString.prototype.indexOf.call(this.cr.href,Dl)>0}}const Vl=["optout"],Bl=["optin"];class Hl{constructor(t,e){this.Za=t,this.km=e}init(){this.Za.register(Vl,(()=>{this.km.activate()}))}}class $l{constructor(t,e){this.Za=t,this.Cu=e}init(){this.Cu.addListener(this.Za)}onOptout(){this.Za.stop()}onBeforeSessionRenewal(){this.Za.stop()}}var ql,zl;!function(t){t.UXA="_uxa",t.WVT="cs_wvt"}(ql||(ql={}));class Fl extends ni{constructor(t){super(),this.ng=t,this.rg={}}register(t,e,s){for(const i of t)this.rg[i]={callback:e,configuration:s},this.rg}onStart(){this.og(),this.hg()}onStop(){for(const t of this.ng)window[t]=[]}applyFromIntegration(t,e,s){this.cg(t,e,`Commands.apply.from.integration: ${s}`),le.counters.commandsFromIntegrations.count(t)}applyFromImplementation(t,e,s){this.cg(t,e,`Commands.apply.from.implementation: ${s}`),le.counters.commandsFromCSTC.count(t)}onIframeCommands(t){for(const e of t.commands)this.ag(e.name,e.params,t.iframePath),le.counters.commandsFromIframe.count(e.name)}cg(t,e,s){this.isStarted?ns.tryToExecute(s,(()=>{if(this.rg[t])return this.rg[t].callback(...e)}))():window._uxa.push([t,...e])}ag(t,e,s){ns.tryToExecute(`Commands.apply.from.iframe: ${s}`,(()=>{if(this.rg[t])return this.rg[t].callback(...e)}))()}og(){for(const t of this.ng)window[t].forEach((t=>{let[e,...s]=t;return this.ug(e,s,!1)}))}hg(){for(const t of this.ng)window[t]={push:t=>{let[e,...s]=t;return this.ug(e,s,!0)}}}ug(t,e,s){var i,n;if(this.rg[t]){if((null===(i=this.rg[t].configuration)||void 0===i?void 0:i.disableApplyPending)&&!s||(null===(n=this.rg[t].configuration)||void 0===n?void 0:n.disableApplyImmediate)&&s)return;try{return this.rg[t].callback(...e)}catch(s){le.counters.commandError.count(t),ns.error(`Command ${t} failed - params: ${csJSON.stringify(e)}`,s)}}}}class jl{constructor(t,e,s,i){this.wt=t,this.bt=e,this.Vt=s,this.lg=i}getRequestParameters(){var e,s,i,n,r;const o=t._objectSpread2(t._objectSpread2({},be()),this.wt.getRequestParameters()),a=this.Vt.getSession();a&&(o.pn=`${a.pageNumber}`);const c=this.bt.getVisitor();if(c&&(o.sn=`${c.visitsCount}`,o.uu=`${c.id}`),(null===(e=this.lg)||void 0===e?void 0:e.hasSubProjectId())&&(o.subProjectID=`${this.lg.getSubProjectId()}`),window.heap)try{o.happid=window.heap.appid,o.hsid=null===(i=(s=window.heap).getSessionId)||void 0===i?void 0:i.call(s),o.huu=(null===(r=(n=window.heap).getUserId)||void 0===r?void 0:r.call(n))||window.heap.userId}catch(t){delete o.happid,delete o.hsid,delete o.huu}return o}}class Gl{constructor(t,e){this.Za=t,this.Y=e}init(){this.Za.register(["debugEvents"],(t=>{"boolean"==typeof t&&this.Y.updateDynamicFields("emitDebugEvents",t)}))}}function Wl(t,e,s){if(!S(e)&&!S(s))return t.href;const i=S(e)?Yl(e):t.pathname,n=S(s)?Ql(s):t.search;return`${t.protocol}//${t.host}${i}${n}`}function Yl(t){return Yt(t,"/")?t:`/${t}`}function Ql(t){return Yt(t,"?")||""===t?t:`?${t}`}!function(t){t[t.page=1]="page",t[t.onNextPageviewOnly=2]="onNextPageviewOnly"}(zl||(zl={}));class Zl{constructor(t,e){this.cr=t,this.uh=e,this.dg=10}overridePath(t,e){if(""===t)return void(this.fg=void 0);const s=this.pg(e);s&&(this.vg=s),this.fg=e?this.mg(t,e):t}overrideQuery(t,e){const s=this.pg(e);s&&(this.wg=s),this.gg=e?this.mg(t,e):t}computeOverriddenUrl(t){return this.yg(t)?this.getAnonymizedUrl():t}Eg(t){return("string"==typeof t||"number"==typeof t)&&t in zl}yg(t){const e=this.Ag(this.cr.href);return this.Ag(t)===e}Ag(t){return e=t,-1!==csString.prototype.indexOf.call(e,"/",e.length-1)?csString.prototype.slice.call(t,0,-1):t;var e}pg(t){return S(null==t?void 0:t.lifespan)&&this.Eg(null==t?void 0:t.lifespan)?null==t?void 0:t.lifespan:null}_g(){return this.vg&&this.vg in zl}Rg(){return this.wg&&this.wg in zl}cleanupOverrideLifespan(){this._g()&&(this.fg=void 0,this.vg=void 0),this.Rg()&&(this.gg=void 0,this.wg=void 0)}getAnonymizedUrl(){const t=Wl(this.cr,this.fg,this.gg);return this.uh.anonymizeUrl(t)}getUrl(){return Wl(this.cr,this.fg,this.gg)}getAnonymizedPathAndQuery(){const t=S(this.fg)?Yl(this.fg):this.cr.pathname,e=S(this.gg)?Ql(this.gg):this.cr.search;return this.uh.anonymizeUrl(t+e)}getUrlProtocol(){return this.cr.protocol}getRequestParameters(){return{url:this.getAnonymizedUrl()}}mg(t,e){return this.Sg(e)?this.Tg(t):this.Ig(e)?this.Pg(t):t}Ig(t){return Boolean(t.decodeURI)}Pg(t){return this.bg(t,1,!1)}Sg(t){return Boolean(t.decodeURIDeep)}Tg(t){return this.bg(t,this.dg,!0)}bg(t,e,s){let i=t;for(let t=0;t<e;t++)try{const t=window.decodeURI(i);if(t===i)return i;i=t}catch(t){return i}return s&&ns.warn(`decodeURIDeep limit reached: ${i}`),i}}class Xl{constructor(){this.listeners=[]}addListener(t){csArray.prototype.push.call(this.listeners,t)}}class Kl extends Xl{emitPageEvent(t){for(const e of this.listeners)e.onPageEvent&&e.onPageEvent(t)}emitEventTriggerRecording(t,e){for(const s of this.listeners)s.onEventTriggerRecording&&s.onEventTriggerRecording(t,e)}emitCustomJavaScriptErrorEvent(t){for(const e of this.listeners)e.onCustomJavaScriptErrorEvent&&e.onCustomJavaScriptErrorEvent(t)}emitCustomErrorEvent(t){for(const e of this.listeners)e.onCustomErrorEvent&&e.onCustomErrorEvent(t)}emitUserIdentifierEvent(t){for(const e of this.listeners)e.onUserIdentifierEvent&&e.onUserIdentifierEvent(t)}emitExternalEvent(t){for(const e of this.listeners)e.onExternalEvent&&e.onExternalEvent({type:ta.EXTERNAL_EVENT,name:t,ts:0})}emitTargetingRulesArtificialPageview(t){for(const e of this.listeners)e.onTargetingRulesArtificialPageview&&e.onTargetingRulesArtificialPageview(t)}}const Jl="|iframe|";class td extends Xl{constructor(t,e,s,i){super(),this.Vg=t,this.Cg=e,this.kg=s,this.Og=i}emitIframeEvent(t,e,s){if(this.Ng(e)&&null===t)ns.error(`iframeEventEmitter received event ${e} with null iframe, content:${csJSON.stringify(s)}`);else switch(e){case Je.ChildLogMessage:this.xg(s);break;case Je.AnalysisEvent:{const e=s,i=this.Vg.transformEvent(t,e);i.isUserEvent?this.$g(i.event):this.Mg(i.event);break}case Je.RecordingEvent:{const e=s,i=this.Og.transformEvents(t,e);if(0===i.events.length)return;i.containsUserEvent?this.Lg(i.events):this.Dg(i.events);break}case Je.JavascriptError:this.Ug(s);break;case Je.ApiError:this.Fg(s);break;case Je.DetailedApiError:this.Bg(s);break;case Je.CustomError:this.qg(s);break;case Je.EmerchandisingMessage:{const e=this.kg.transformEvent(t,s);this.Hg(e);break}case Je.Commands:{const e=this.Cg.transformEvent(t,s);this.zg(e);break}case Je.IntegrationCallback:this.jg(s);break;case Je.StaticResource:this.Gg(s);break;case Je.TrackingContextRequestMessage:this.Zg(s);break;default:ns.error(`Parent received unknown data type from iframe : ${csJSON.stringify(s)}`)}}Ng(t){const e=[Je.AnalysisEvent,Je.RecordingEvent,Je.EmerchandisingMessage,Je.Commands];return-1!==csArray.prototype.indexOf.call(e,t)}xg(t){const{message:e,errorCode:s,level:i}=t;switch(i){case se.debug:ns.debug(e,s);break;case se.warn:ns.warn(e,!0,s);break;case se.implementation:ns.implementation(e,s);break;case se.error:ns.error(e,s);break;case se.critical:ns.critical(e,s)}}$g(t){for(const e of this.listeners)e.onIframeAnalysisUserEvent&&e.onIframeAnalysisUserEvent(t)}Mg(t){for(const e of this.listeners)e.onIframeAnalysisBrowserEvent&&e.onIframeAnalysisBrowserEvent(t)}Lg(t){for(const e of this.listeners)e.onIframeRecordingUserEvent&&e.onIframeRecordingUserEvent(t)}Dg(t){for(const e of this.listeners)e.onIframeRecordingBrowserEvent&&e.onIframeRecordingBrowserEvent(t)}Ug(t){for(const e of this.listeners)e.onIframeJavascriptError&&e.onIframeJavascriptError(t)}Fg(t){for(const e of this.listeners)e.onIframeApiError&&e.onIframeApiError(t)}Bg(t){for(const e of this.listeners)e.onIframeDetailedApiError&&e.onIframeDetailedApiError(t)}Hg(t){for(const e of this.listeners)e.onIframeEmerchandisingMessage&&e.onIframeEmerchandisingMessage(t)}zg(t){for(const e of this.listeners)e.onIframeCommands&&e.onIframeCommands(t)}jg(t){for(const e of this.listeners)e.onIframeIntegrationCallback&&e.onIframeIntegrationCallback(t)}Gg(t){for(const e of this.listeners)e.onIframeStaticResource&&e.onIframeStaticResource(t)}Zg(t){for(const e of this.listeners)e.onTrackingContextRequestCallback&&e.onTrackingContextRequestCallback(t)}qg(t){for(const e of this.listeners)e.onIframeCustomError&&e.onIframeCustomError(t)}}var ed;!function(t){t.COMPRESSION_DISABLED="compressionDisabled"}(ed||(ed={}));class sd{constructor(){}static init(t){this.Wg&&void 0===t||this.initFlags(t)}static initFlags(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.cookie;var e;const s=null===(e=/_cs_debug=((\w|\.|\:|=)+)/g.exec(t))||void 0===e?void 0:e[1];if(this.Wg=new Map,s){const t=csString.prototype.split.call(s,".");for(let e=0;e<t.length;e++){const[s,i]=csString.prototype.split.call(t[e],"=");this.Wg.set(s,i||"true")}}}static getBoolean(t){const e=this.getString(t);return null!=e&&"false"!==e&&0!==parseInt(e)}static getString(t){var e;return this.init(),null===(e=this.Wg)||void 0===e?void 0:e.get(t)}static isCompressionEnabled(){return!this.getBoolean(ed.COMPRESSION_DISABLED)}static Log(t){return(e,s,i)=>{var n;const r=s.toString(),o=`${null===(n=e.constructor)||void 0===n?void 0:n.name}.${r}`,a=i.value;(function(t,e){var s;return null!=t&&(t===e||!!(null===(s=csString.prototype.match.call(t,new csRegExp("(^|,)("+e+")(,|$)")))||void 0===s?void 0:s.length))})(sd.getString("debugLog"),t)&&(i.value=function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return console.log(o,...e),a.bind(this)(...e)})}}}function id(){function t(t){let e=t.length;for(;--e>=0;)t[e]=0}const e=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),s=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),i=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),n=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),r=new Array(576);t(r);const o=new Array(60);t(o);const a=new Array(512);t(a);const c=new Array(256);t(c);const h=new Array(29);t(h);const l=new Array(30);function d(t,e,s,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=s,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}let u,p,g;function m(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}t(l);const y=t=>t<256?a[t]:a[256+(t>>>7)],f=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},v=(t,e,s)=>{t.bi_valid>16-s?(t.bi_buf|=e<<t.bi_valid&65535,f(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=s-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=s)},E=(t,e,s)=>{v(t,s[2*e],s[2*e+1])},S=(t,e)=>{let s=0;do{s|=1&t,t>>>=1,s<<=1}while(--e>0);return s>>>1},w=(t,e,s)=>{const i=new Array(16);let n,r,o=0;for(n=1;n<=15;n++)i[n]=o=o+s[n-1]<<1;for(r=0;r<=e;r++){let e=t[2*r+1];0!==e&&(t[2*r]=S(i[e]++,e))}},R=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},A=t=>{t.bi_valid>8?f(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},b=(t,e,s,i)=>{const n=2*e,r=2*s;return t[n]<t[r]||t[n]===t[r]&&i[e]<=i[s]},T=(t,e,s)=>{const i=t.heap[s];let n=s<<1;for(;n<=t.heap_len&&(n<t.heap_len&&b(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!b(e,i,t.heap[n],t.depth));)t.heap[s]=t.heap[n],s=n,n<<=1;t.heap[s]=i},C=(t,i,n)=>{let r,o,a,d,u=0;if(0!==t.last_lit)do{r=t.pending_buf[t.d_buf+2*u]<<8|t.pending_buf[t.d_buf+2*u+1],o=t.pending_buf[t.l_buf+u],u++,0===r?E(t,o,i):(a=c[o],E(t,a+256+1,i),d=e[a],0!==d&&(o-=h[a],v(t,o,d)),r--,a=y(r),E(t,a,n),d=s[a],0!==d&&(r-=l[a],v(t,r,d)))}while(u<t.last_lit);E(t,256,i)},_=(t,e)=>{const s=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,r=e.stat_desc.elems;let o,a,c,h=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<r;o++)0!==s[2*o]?(t.heap[++t.heap_len]=h=o,t.depth[o]=0):s[2*o+1]=0;for(;t.heap_len<2;)c=t.heap[++t.heap_len]=h<2?++h:0,s[2*c]=1,t.depth[c]=0,t.opt_len--,n&&(t.static_len-=i[2*c+1]);for(e.max_code=h,o=t.heap_len>>1;o>=1;o--)T(t,s,o);c=r;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],T(t,s,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,s[2*c]=s[2*o]+s[2*a],t.depth[c]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,s[2*o+1]=s[2*a+1]=c,t.heap[1]=c++,T(t,s,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const s=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,r=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,c=e.stat_desc.max_length;let h,l,d,u,p,g,m=0;for(u=0;u<=15;u++)t.bl_count[u]=0;for(s[2*t.heap[t.heap_max]+1]=0,h=t.heap_max+1;h<573;h++)l=t.heap[h],u=s[2*s[2*l+1]+1]+1,u>c&&(u=c,m++),s[2*l+1]=u,l>i||(t.bl_count[u]++,p=0,l>=a&&(p=o[l-a]),g=s[2*l],t.opt_len+=g*(u+p),r&&(t.static_len+=g*(n[2*l+1]+p)));if(0!==m){do{for(u=c-1;0===t.bl_count[u];)u--;t.bl_count[u]--,t.bl_count[u+1]+=2,t.bl_count[c]--,m-=2}while(m>0);for(u=c;0!==u;u--)for(l=t.bl_count[u];0!==l;)d=t.heap[--h],d>i||(s[2*d+1]!==u&&(t.opt_len+=(u-s[2*d+1])*s[2*d],s[2*d+1]=u),l--)}})(t,e),w(s,h,t.bl_count)},N=(t,e,s)=>{let i,n,r=-1,o=e[1],a=0,c=7,h=4;for(0===o&&(c=138,h=3),e[2*(s+1)+1]=65535,i=0;i<=s;i++)n=o,o=e[2*(i+1)+1],++a<c&&n===o||(a<h?t.bl_tree[2*n]+=a:0!==n?(n!==r&&t.bl_tree[2*n]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,r=n,0===o?(c=138,h=3):n===o?(c=6,h=3):(c=7,h=4))},I=(t,e,s)=>{let i,n,r=-1,o=e[1],a=0,c=7,h=4;for(0===o&&(c=138,h=3),i=0;i<=s;i++)if(n=o,o=e[2*(i+1)+1],!(++a<c&&n===o)){if(a<h)do{E(t,n,t.bl_tree)}while(0!=--a);else 0!==n?(n!==r&&(E(t,n,t.bl_tree),a--),E(t,16,t.bl_tree),v(t,a-3,2)):a<=10?(E(t,17,t.bl_tree),v(t,a-3,3)):(E(t,18,t.bl_tree),v(t,a-11,7));a=0,r=n,0===o?(c=138,h=3):n===o?(c=6,h=3):(c=7,h=4)}};let O=!1;const P=(t,e,s,i)=>{v(t,0+(i?1:0),3),((t,e,s,i)=>{A(t),f(t,s),f(t,~s),t.pending_buf.set(t.window.subarray(e,e+s),t.pending),t.pending+=s})(t,e,s)};var k={_tr_init:t=>{O||((()=>{let t,n,m,y,f;const v=new Array(16);for(m=0,y=0;y<28;y++)for(h[y]=m,t=0;t<1<<e[y];t++)c[m++]=y;for(c[m-1]=y,f=0,y=0;y<16;y++)for(l[y]=f,t=0;t<1<<s[y];t++)a[f++]=y;for(f>>=7;y<30;y++)for(l[y]=f<<7,t=0;t<1<<s[y]-7;t++)a[256+f++]=y;for(n=0;n<=15;n++)v[n]=0;for(t=0;t<=143;)r[2*t+1]=8,t++,v[8]++;for(;t<=255;)r[2*t+1]=9,t++,v[9]++;for(;t<=279;)r[2*t+1]=7,t++,v[7]++;for(;t<=287;)r[2*t+1]=8,t++,v[8]++;for(w(r,287,v),t=0;t<30;t++)o[2*t+1]=5,o[2*t]=S(t,5);u=new d(r,e,257,286,15),p=new d(o,s,0,30,15),g=new d(new Array(0),i,0,19,7)})(),O=!0),t.l_desc=new m(t.dyn_ltree,u),t.d_desc=new m(t.dyn_dtree,p),t.bl_desc=new m(t.bl_tree,g),t.bi_buf=0,t.bi_valid=0,R(t)},_tr_stored_block:P,_tr_flush_block:(t,e,s,i)=>{let a,c,h=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,s=4093624447;for(e=0;e<=31;e++,s>>>=1)if(1&s&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),_(t,t.l_desc),_(t,t.d_desc),h=(t=>{let e;for(N(t,t.dyn_ltree,t.l_desc.max_code),N(t,t.dyn_dtree,t.d_desc.max_code),_(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*n[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),a=t.opt_len+3+7>>>3,c=t.static_len+3+7>>>3,c<=a&&(a=c)):a=c=s+5,s+4<=a&&-1!==e?P(t,e,s,i):4===t.strategy||c===a?(v(t,2+(i?1:0),3),C(t,r,o)):(v(t,4+(i?1:0),3),((t,e,s,i)=>{let r;for(v(t,e-257,5),v(t,s-1,5),v(t,i-4,4),r=0;r<i;r++)v(t,t.bl_tree[2*n[r]+1],3);I(t,t.dyn_ltree,e-1),I(t,t.dyn_dtree,s-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,h+1),C(t,t.dyn_ltree,t.dyn_dtree)),R(t),i&&A(t)},_tr_tally:(t,e,s)=>(t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&s,t.last_lit++,0===e?t.dyn_ltree[2*s]++:(t.matches++,e--,t.dyn_ltree[2*(c[s]+256+1)]++,t.dyn_dtree[2*y(e)]++),t.last_lit===t.lit_bufsize-1),_tr_align:t=>{v(t,2,3),E(t,256,r),(t=>{16===t.bi_valid?(f(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},L=(t,e,s,i)=>{let n=65535&t,r=t>>>16&65535,o=0;for(;0!==s;){o=s>2e3?2e3:s,s-=o;do{n=n+e[i++]|0,r=r+n|0}while(--o);n%=65521,r%=65521}return n|r<<16};const M=new Uint32Array((()=>{let t,e=[];for(var s=0;s<256;s++){t=s;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[s]=t}return e})());var D=(t,e,s,i)=>{const n=M,r=i+s;t^=-1;for(let s=i;s<r;s++)t=t>>>8^n[255&(t^e[s])];return~t},x={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},U={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:V,_tr_stored_block:B,_tr_flush_block:H,_tr_tally:$,_tr_align:q}=k,{Z_NO_FLUSH:z,Z_PARTIAL_FLUSH:F,Z_FULL_FLUSH:j,Z_FINISH:G,Z_BLOCK:W,Z_OK:Y,Z_STREAM_END:Q,Z_STREAM_ERROR:Z,Z_DATA_ERROR:X,Z_BUF_ERROR:K,Z_DEFAULT_COMPRESSION:J,Z_FILTERED:tt,Z_HUFFMAN_ONLY:et,Z_RLE:st,Z_FIXED:it,Z_DEFAULT_STRATEGY:nt,Z_UNKNOWN:rt,Z_DEFLATED:ot}=U,at=258,ct=262,ht=103,lt=113,dt=666,ut=(t,e)=>(t.msg=x[e],e),pt=t=>(t<<1)-(t>4?9:0),gt=t=>{let e=t.length;for(;--e>=0;)t[e]=0};let mt=(t,e,s)=>(e<<t.hash_shift^s)&t.hash_mask;const yt=t=>{const e=t.state;let s=e.pending;s>t.avail_out&&(s=t.avail_out),0!==s&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+s),t.next_out),t.next_out+=s,e.pending_out+=s,t.total_out+=s,t.avail_out-=s,e.pending-=s,0===e.pending&&(e.pending_out=0))},ft=(t,e)=>{H(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,yt(t.strm)},vt=(t,e)=>{t.pending_buf[t.pending++]=e},Et=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},St=(t,e,s,i)=>{let n=t.avail_in;return n>i&&(n=i),0===n?0:(t.avail_in-=n,e.set(t.input.subarray(t.next_in,t.next_in+n),s),1===t.state.wrap?t.adler=L(t.adler,e,n,s):2===t.state.wrap&&(t.adler=D(t.adler,e,n,s)),t.next_in+=n,t.total_in+=n,n)},wt=(t,e)=>{let s,i,n=t.max_chain_length,r=t.strstart,o=t.prev_length,a=t.nice_match;const c=t.strstart>t.w_size-ct?t.strstart-(t.w_size-ct):0,h=t.window,l=t.w_mask,d=t.prev,u=t.strstart+at;let p=h[r+o-1],g=h[r+o];t.prev_length>=t.good_match&&(n>>=2),a>t.lookahead&&(a=t.lookahead);do{if(s=e,h[s+o]===g&&h[s+o-1]===p&&h[s]===h[r]&&h[++s]===h[r+1]){r+=2,s++;do{}while(h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&r<u);if(i=at-(u-r),r=u-at,i>o){if(t.match_start=e,o=i,i>=a)break;p=h[r+o-1],g=h[r+o]}}}while((e=d[e&l])>c&&0!=--n);return o<=t.lookahead?o:t.lookahead},Rt=t=>{const e=t.w_size;let s,i,n,r,o;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-ct)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,i=t.hash_size,s=i;do{n=t.head[--s],t.head[s]=n>=e?n-e:0}while(--i);i=e,s=i;do{n=t.prev[--s],t.prev[s]=n>=e?n-e:0}while(--i);r+=e}if(0===t.strm.avail_in)break;if(i=St(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=i,t.lookahead+t.insert>=3)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=mt(t,t.ins_h,t.window[o+1]);t.insert&&(t.ins_h=mt(t,t.ins_h,t.window[o+3-1]),t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<ct&&0!==t.strm.avail_in)},At=(t,e)=>{let s,i;for(;;){if(t.lookahead<ct){if(Rt(t),t.lookahead<ct&&e===z)return 1;if(0===t.lookahead)break}if(s=0,t.lookahead>=3&&(t.ins_h=mt(t,t.ins_h,t.window[t.strstart+3-1]),s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==s&&t.strstart-s<=t.w_size-ct&&(t.match_length=wt(t,s)),t.match_length>=3)if(i=$(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=mt(t,t.ins_h,t.window[t.strstart+3-1]),s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=mt(t,t.ins_h,t.window[t.strstart+1]);else i=$(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(ft(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===G?(ft(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(ft(t,!1),0===t.strm.avail_out)?1:2},bt=(t,e)=>{let s,i,n;for(;;){if(t.lookahead<ct){if(Rt(t),t.lookahead<ct&&e===z)return 1;if(0===t.lookahead)break}if(s=0,t.lookahead>=3&&(t.ins_h=mt(t,t.ins_h,t.window[t.strstart+3-1]),s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==s&&t.prev_length<t.max_lazy_match&&t.strstart-s<=t.w_size-ct&&(t.match_length=wt(t,s),t.match_length<=5&&(t.strategy===tt||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-3,i=$(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=n&&(t.ins_h=mt(t,t.ins_h,t.window[t.strstart+3-1]),s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(ft(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=$(t,0,t.window[t.strstart-1]),i&&ft(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=$(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===G?(ft(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(ft(t,!1),0===t.strm.avail_out)?1:2};function Tt(t,e,s,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=s,this.max_chain=i,this.func=n}const Ct=[new Tt(0,0,0,0,((t,e)=>{let s=65535;for(s>t.pending_buf_size-5&&(s=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Rt(t),0===t.lookahead&&e===z)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;const i=t.block_start+s;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,ft(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-ct&&(ft(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===G?(ft(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(ft(t,!1),t.strm.avail_out),1)})),new Tt(4,4,8,4,At),new Tt(4,5,16,8,At),new Tt(4,6,32,32,At),new Tt(4,4,16,16,bt),new Tt(8,16,32,32,bt),new Tt(8,16,128,128,bt),new Tt(8,32,128,256,bt),new Tt(32,128,258,1024,bt),new Tt(32,258,258,4096,bt)];function _t(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ot,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),gt(this.dyn_ltree),gt(this.dyn_dtree),gt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),gt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),gt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Nt=t=>{if(!t||!t.state)return ut(t,Z);t.total_in=t.total_out=0,t.data_type=rt;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:lt,t.adler=2===e.wrap?0:1,e.last_flush=z,V(e),Y},It=t=>{const e=Nt(t);return e===Y&&(t=>{t.window_size=2*t.w_size,gt(t.head),t.max_lazy_match=Ct[t.level].max_lazy,t.good_match=Ct[t.level].good_length,t.nice_match=Ct[t.level].nice_length,t.max_chain_length=Ct[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0})(t.state),e},Ot=(t,e,s,i,n,r)=>{if(!t)return Z;let o=1;if(e===J&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),n<1||n>9||s!==ot||i<8||i>15||e<0||e>9||r<0||r>it)return ut(t,Z);8===i&&(i=9);const a=new _t;return t.state=a,a.strm=t,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=e,a.strategy=r,a.method=s,It(t)};var Pt={deflateInit:(t,e)=>Ot(t,e,ot,15,8,nt),deflateInit2:Ot,deflateReset:It,deflateResetKeep:Nt,deflateSetHeader:(t,e)=>t&&t.state?2!==t.state.wrap?Z:(t.state.gzhead=e,Y):Z,deflate:(t,e)=>{let s,i;if(!t||!t.state||e>W||e<0)return t?ut(t,Z):Z;const n=t.state;if(!t.output||!t.input&&0!==t.avail_in||n.status===dt&&e!==G)return ut(t,0===t.avail_out?K:Z);n.strm=t;const r=n.last_flush;if(n.last_flush=e,42===n.status)if(2===n.wrap)t.adler=0,vt(n,31),vt(n,139),vt(n,8),n.gzhead?(vt(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),vt(n,255&n.gzhead.time),vt(n,n.gzhead.time>>8&255),vt(n,n.gzhead.time>>16&255),vt(n,n.gzhead.time>>24&255),vt(n,9===n.level?2:n.strategy>=et||n.level<2?4:0),vt(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(vt(n,255&n.gzhead.extra.length),vt(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=D(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(vt(n,0),vt(n,0),vt(n,0),vt(n,0),vt(n,0),vt(n,9===n.level?2:n.strategy>=et||n.level<2?4:0),vt(n,3),n.status=lt);else{let e=ot+(n.w_bits-8<<4)<<8,s=-1;s=n.strategy>=et||n.level<2?0:n.level<6?1:6===n.level?2:3,e|=s<<6,0!==n.strstart&&(e|=32),e+=31-e%31,n.status=lt,Et(n,e),0!==n.strstart&&(Et(n,t.adler>>>16),Et(n,65535&t.adler)),t.adler=1}if(69===n.status)if(n.gzhead.extra){for(s=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>s&&(t.adler=D(t.adler,n.pending_buf,n.pending-s,s)),yt(t),s=n.pending,n.pending!==n.pending_buf_size));)vt(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>s&&(t.adler=D(t.adler,n.pending_buf,n.pending-s,s)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(t.adler=D(t.adler,n.pending_buf,n.pending-s,s)),yt(t),s=n.pending,n.pending===n.pending_buf_size)){i=1;break}i=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,vt(n,i)}while(0!==i);n.gzhead.hcrc&&n.pending>s&&(t.adler=D(t.adler,n.pending_buf,n.pending-s,s)),0===i&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(t.adler=D(t.adler,n.pending_buf,n.pending-s,s)),yt(t),s=n.pending,n.pending===n.pending_buf_size)){i=1;break}i=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,vt(n,i)}while(0!==i);n.gzhead.hcrc&&n.pending>s&&(t.adler=D(t.adler,n.pending_buf,n.pending-s,s)),0===i&&(n.status=ht)}else n.status=ht;if(n.status===ht&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&yt(t),n.pending+2<=n.pending_buf_size&&(vt(n,255&t.adler),vt(n,t.adler>>8&255),t.adler=0,n.status=lt)):n.status=lt),0!==n.pending){if(yt(t),0===t.avail_out)return n.last_flush=-1,Y}else if(0===t.avail_in&&pt(e)<=pt(r)&&e!==G)return ut(t,K);if(n.status===dt&&0!==t.avail_in)return ut(t,K);if(0!==t.avail_in||0!==n.lookahead||e!==z&&n.status!==dt){let s=n.strategy===et?((t,e)=>{let s;for(;;){if(0===t.lookahead&&(Rt(t),0===t.lookahead)){if(e===z)return 1;break}if(t.match_length=0,s=$(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,s&&(ft(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===G?(ft(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(ft(t,!1),0===t.strm.avail_out)?1:2})(n,e):n.strategy===st?((t,e)=>{let s,i,n,r;const o=t.window;for(;;){if(t.lookahead<=at){if(Rt(t),t.lookahead<=at&&e===z)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=t.strstart-1,i=o[n],i===o[++n]&&i===o[++n]&&i===o[++n])){r=t.strstart+at;do{}while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<r);t.match_length=at-(r-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(s=$(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(s=$(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),s&&(ft(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===G?(ft(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(ft(t,!1),0===t.strm.avail_out)?1:2})(n,e):Ct[n.level].func(n,e);if(3!==s&&4!==s||(n.status=dt),1===s||3===s)return 0===t.avail_out&&(n.last_flush=-1),Y;if(2===s&&(e===F?q(n):e!==W&&(B(n,0,0,!1),e===j&&(gt(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),yt(t),0===t.avail_out))return n.last_flush=-1,Y}return e!==G?Y:n.wrap<=0?Q:(2===n.wrap?(vt(n,255&t.adler),vt(n,t.adler>>8&255),vt(n,t.adler>>16&255),vt(n,t.adler>>24&255),vt(n,255&t.total_in),vt(n,t.total_in>>8&255),vt(n,t.total_in>>16&255),vt(n,t.total_in>>24&255)):(Et(n,t.adler>>>16),Et(n,65535&t.adler)),yt(t),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Y:Q)},deflateEnd:t=>{if(!t||!t.state)return Z;const e=t.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&e!==ht&&e!==lt&&e!==dt?ut(t,Z):(t.state=null,e===lt?ut(t,X):Y)},deflateSetDictionary:(t,e)=>{let s=e.length;if(!t||!t.state)return Z;const i=t.state,n=i.wrap;if(2===n||1===n&&42!==i.status||i.lookahead)return Z;if(1===n&&(t.adler=L(t.adler,e,s,0)),i.wrap=0,s>=i.w_size){0===n&&(gt(i.head),i.strstart=0,i.block_start=0,i.insert=0);let t=new Uint8Array(i.w_size);t.set(e.subarray(s-i.w_size,s),0),e=t,s=i.w_size}const r=t.avail_in,o=t.next_in,a=t.input;for(t.avail_in=s,t.next_in=0,t.input=e,Rt(i);i.lookahead>=3;){let t=i.strstart,e=i.lookahead-2;do{i.ins_h=mt(i,i.ins_h,i.window[t+3-1]),i.prev[t&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=t,t++}while(--e);i.strstart=t,i.lookahead=2,Rt(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=o,t.input=a,t.avail_in=r,i.wrap=n,Y},deflateInfo:"pako deflate (from Nodeca project)"};const kt=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Lt=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const s=e.shift();if(s){if("object"!=typeof s)throw new TypeError(s+"must be non-object");for(const e in s)kt(s,e)&&(t[e]=s[e])}}return t};let Mt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Mt=!1}const Dt=new Uint8Array(256);for(let t=0;t<256;t++)Dt[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Dt[254]=Dt[254]=1;var xt=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,s,i,n,r,o=t.length,a=0;for(n=0;n<o;n++)s=t.charCodeAt(n),55296==(64512&s)&&n+1<o&&(i=t.charCodeAt(n+1),56320==(64512&i)&&(s=65536+(s-55296<<10)+(i-56320),n++)),a+=s<128?1:s<2048?2:s<65536?3:4;for(e=new Uint8Array(a),r=0,n=0;r<a;n++)s=t.charCodeAt(n),55296==(64512&s)&&n+1<o&&(i=t.charCodeAt(n+1),56320==(64512&i)&&(s=65536+(s-55296<<10)+(i-56320),n++)),s<128?e[r++]=s:s<2048?(e[r++]=192|s>>>6,e[r++]=128|63&s):s<65536?(e[r++]=224|s>>>12,e[r++]=128|s>>>6&63,e[r++]=128|63&s):(e[r++]=240|s>>>18,e[r++]=128|s>>>12&63,e[r++]=128|s>>>6&63,e[r++]=128|63&s);return e},Ut=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Vt=Object.prototype.toString,{Z_NO_FLUSH:Bt,Z_SYNC_FLUSH:Ht,Z_FULL_FLUSH:$t,Z_FINISH:qt,Z_OK:zt,Z_STREAM_END:Ft,Z_DEFAULT_COMPRESSION:jt,Z_DEFAULT_STRATEGY:Gt,Z_DEFLATED:Wt}=U;function Yt(t){this.options=Lt({level:jt,method:Wt,chunkSize:16384,windowBits:15,memLevel:8,strategy:Gt},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ut,this.strm.avail_out=0;let s=Pt.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(s!==zt)throw new Error(x[s]);if(e.header&&Pt.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?xt(e.dictionary):"[object ArrayBuffer]"===Vt.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,s=Pt.deflateSetDictionary(this.strm,t),s!==zt)throw new Error(x[s]);this._dict_set=!0}}return Yt.prototype.push=function(t,e){const s=this.strm,i=this.options.chunkSize;let n,r;if(this.ended)return!1;for(r=e===~~e?e:!0===e?qt:Bt,"string"==typeof t?s.input=xt(t):"[object ArrayBuffer]"===Vt.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;;)if(0===s.avail_out&&(s.output=new Uint8Array(i),s.next_out=0,s.avail_out=i),(r===Ht||r===$t)&&s.avail_out<=6)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else{if(n=Pt.deflate(s,r),n===Ft)return s.next_out>0&&this.onData(s.output.subarray(0,s.next_out)),n=Pt.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===zt;if(0!==s.avail_out){if(r>0&&s.next_out>0)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else if(0===s.avail_in)break}else this.onData(s.output)}return!0},Yt.prototype.onData=function(t){this.chunks.push(t)},Yt.prototype.onEnd=function(t){t===zt&&(this.result=(t=>{let e=0;for(let s=0,i=t.length;s<i;s++)e+=t[s].length;const s=new Uint8Array(e);for(let e=0,i=0,n=t.length;e<n;e++){let n=t[e];s.set(n,i),i+=n.length}return s})(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},(t,e,s)=>{let i=function(t,e){return(e=e||{}).gzip=!0,function(t,e){const s=new Yt(e=e||{});if(s.push(t,!0),s.err)throw s.msg||x[s.err];return s.result}(t,e)}(t);return i="base64"===e?btoa(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;if(e<65534&&t.subarray&&Mt)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let s="";for(let i=0;i<e;i++)s+=String.fromCharCode(t[i]);return s}(i)):i.buffer,s&&s(i),i}}class nd extends Es{constructor(t){super(t),this.algorithm=vs.GZIP,this.Qg=id(),this.Jg=(t,e,s)=>{s(this.Qg(t,e))},this.compress=rd(),"undefined"!=typeof CompressionStream&&$s||(this.compress=this.Jg,this.getCompressorSourceCode=()=>id.toString())}compressSync(t,e){return this.Qg(t,e)}getCompressorSourceCode(){return rd.toString()}}function rd(){return(t,e,s)=>{const i=new Response(t).body.pipeThrough(new CompressionStream("gzip")),n=new Response(i).arrayBuffer();"base64"!==e?n.then((t=>s(t))):n.then((t=>{return e=t,new Promise((t=>{const s=new FileReader;s.onload=e=>t(e.target.result.split(",")[1]),s.readAsDataURL(new Blob([e]))}));var e})).then((t=>s(t)))}}class od extends Es{constructor(){super(...arguments),this.algorithm=vs.UNCOMPRESSED}compress(t,e,s){s(this.compressSync(t,e))}compressSync(t,e){return t}getCompressorSourceCode(){return function(){return(t,e,s)=>s(t)}.toString()}}class ad{static create(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.instance?this.instance:e&&!sd.isCompressionEnabled()?new od(t):this.instance=new nd(t)}}class cd{setItem(t,e){window.sessionStorage.setItem(t,e)}getItem(t){return window.sessionStorage.getItem(t)}removeItem(t){window.sessionStorage.removeItem(t)}}class hd{setItem(t,e){window.localStorage.setItem(t,e)}getItem(t){return window.localStorage.getItem(t)}removeItem(t){window.localStorage.removeItem(t)}}const ld="_cs_cvars";class dd{constructor(t,e,s){this.wt=t,this.Mm=e,this.mw=s}onCookieToSet(t){this.Sw=t}onCookieToRemove(t){this.Tw=t}get(){return this.wt.cookielessTrackingEnabled?this.mw.getItem(ld):this.Mm.get(ld)}set(t){var e;this.wt.cookielessTrackingEnabled?this.mw.setItem(ld,t):(this.Mm.set(ld,t),null===(e=this.Sw)||void 0===e||e.call(this,ld,t))}remove(){var t;this.wt.cookielessTrackingEnabled?this.mw.removeItem(ld):(this.Mm.delete(ld),null===(t=this.Tw)||void 0===t||t.call(this,ld))}static isValidCustomVarString(t){return"string"==typeof t}}const ud=["visit",2],pd=["page",3],gd=["nextPageOnly",4];class md{constructor(t,e){this.gt=t,this.rw=e,this.Kg={},this.Yg={}}set(t,e,s,i){let n,r;if((m(t)||f(t))&&Number(t)>0&&w(e)&&w(s)&&!R(e)&&!R(s)&&this.Xg(i)){const o=this.gt.anonymizePII(csString(e)),a=this.gt.anonymizePII(csString(s));if(n=[csString.prototype.slice.call(o,0,512),csString.prototype.slice.call(a,0,255)],r=""!==s,!S(i)||csArray.prototype.indexOf.call(ud,i)>=0){const e=this.getCustomVariablesSession();r?e[t]=n:delete e[t],this.setCustomVariableSession(e)}(!S(i)||csArray.prototype.indexOf.call(pd,i)>=0)&&(r?this.Kg[t]=n:delete this.Kg[t]),S(i)&&csArray.prototype.indexOf.call(gd,i)>=0&&(r?this.Yg[t]=n:delete this.Yg[t]),le.counters.commandApplied.count("cvars")}else le.counters.commandMisuse.count("cvars")}getCustomVariablesSession(){const t=this.rw.get();if(!t)return{};const e=window.csJSON.parse(t);return null!==e&&E(e)?e:{}}setCustomVariableSession(t){this.rw.set(window.csJSON.stringify(t))}removeCustomVariablesSession(){this.rw.remove()}removeCustomVariablesPage(){this.Kg={}}getRequestParameters(){const t=this.getCustomVariablesSession();for(const t in this.Yg)this.Yg.hasOwnProperty(t)&&(this.Kg[t]=this.Yg[t]);for(const e in this.Kg)this.Kg.hasOwnProperty(e)&&(t[e]=this.Kg[e]);if(window.csJSON.stringify(t).length<=2)return{};const e={cvars:this.ty(t)};return this.Kg&&window.csJSON.stringify(this.Kg).length>2&&(e.cvarp=this.ty(this.Kg)),e}deleteNextPageOnlyCustomVariables(){if(Object.keys(this.Yg).length>0)for(const t in this.Yg)this.Yg[t]===this.Kg[t]&&(delete this.Kg[t],delete this.Yg[t])}sy(t){for(const s in t)if(t.hasOwnProperty(s)){const i=parseInt(s,10),n=t[s],r=n[0],o=n[1];(!(y(e=i)&&e>=1&&e<=20)||r.length>512||o.length>255)&&delete t[s]}var e}ty(t){this.sy(t);const e=function(t){let e;for(e in t)return!1;return!0}(t)?[]:t;return window.csJSON.stringify(e)}Xg(t){return!S(t)||f(t)||m(t)}getAllValidCustomVars(){const t=this.getCustomVariablesSession();for(const t in this.Yg)this.Yg.hasOwnProperty(t)&&(this.Kg[t]=this.Yg[t]);for(const e in this.Kg)this.Kg.hasOwnProperty(e)&&(t[e]=this.Kg[e]);return this.sy(t),t}}const yd=["setCustomVariable"];class fd{constructor(t,e){this.Za=t,this.Ms=e}init(){this.Za.register(yd,((t,e,s,i)=>{this.Ms.set(t,e,s,i)}))}onAfterArtificialPageView(){this.Ms.deleteNextPageOnlyCustomVariables()}onAfterNaturalPageView(){this.Ms.deleteNextPageOnlyCustomVariables()}onOptout(){this.Ms.removeCustomVariablesSession()}onBeforeVisitorRenewal(){this.Ms.removeCustomVariablesSession(),this.Ms.removeCustomVariablesPage()}}const vd="_cs_id",Ed=/^(([a-z0-9\-])+(\.[0-9]+){6})(\.(None|Lax|X)\.(0|1))?(\.[0-1])?(\.\b(x|[0-9a-fA-F]{12})\b)?$/;class Sd{constructor(t,e,s){this.wt=t,this.Mm=e,this.mw=s}onCookieToSet(t){this.Sw=t}onCookieToRemove(t){this.Tw=t}get(){let t;return t=this.wt.cookielessTrackingEnabled?this.mw.getItem(vd):this.Mm.get(vd),t?Sd.fromString(t):null}set(t){var e;const s=Sd.toString(t);if(this.wt.cookielessTrackingEnabled)this.mw.setItem(vd,s);else{const i=new csDate(t.expires);this.Mm.set(vd,s,i),null===(e=this.Sw)||void 0===e||e.call(this,vd,s,i)}}remove(){var t;this.wt.cookielessTrackingEnabled?this.mw.removeItem(vd):(this.Mm.delete(vd),null===(t=this.Tw)||void 0===t||t.call(this,vd))}handleSubdomainChange(){if(this.wt.cookielessTrackingEnabled)return;const t=this.get();t&&(t.allowSubdomains=this.wt.allowSubdomains,this.wt.allowSubdomains?this.Mm.delete(vd,us.CURRENT_DOMAIN):this.Mm.delete(vd,this.Mm.getRootDomain()),this.set(t))}static fromString(t){const[e,s,i,n,r,o,a,c,h]=csString.prototype.split.call(t,".");return{id:e,creationTimestamp:Number(s),visitsCount:Number(i),hitTimestamp:Number(n),lastVisitTimestamp:Number(r),appliedTrackingDraw:Number(o),expires:Number(a),allowSubdomains:void 0===c?void 0:!!Number(c),identityPrint:void 0===h||"x"===h?null:h}}static toString(t){var e;return csArray.prototype.join.call([t.id,t.creationTimestamp,t.visitsCount,t.hitTimestamp,t.lastVisitTimestamp,t.appliedTrackingDraw,t.expires,t.allowSubdomains?1:0,null!==(e=t.identityPrint)&&void 0!==e?e:"x"],".")}static isValidVisitorString(t){return Ed.test(t)}}class wd{constructor(t){this.gt=t}anonymizeUrl(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=this.gt.anonymizePII(t);i=this.gt.anonymizeJwt(i);const n=this.ey(i,e);return n!==i?n:this.iy(i,s)}removeQueryString(t){const{path:e,queryString:s}=this.ny(t);return""!==s?`${e}?`:e}ny(t){const e=csString.prototype.indexOf.call(t,"?");let s,i="";return-1!==e?(s=csString.prototype.slice.call(t,0,e),i=csString.prototype.slice.call(t,e,t.length)):s=t,{path:s,queryString:i}}ey(t,e){if(0===e.length)return t;const{path:s,queryString:i}=this.ny(t),n=csString.prototype.split.call(s,"/");for(const t of e){const e=this.oy(n,t);if(null!==e)return`${e}${i}`}return t}oy(t,e){if(t.length<e.length)return null;const s=[];for(let i=0;i<t.length;i++){const n=t[i];if(i>=e.length){csArray.prototype.push.call(s,n);continue}const r=e[i].key;if(this.hy(r)){const t=e[i].value;csArray.prototype.push.call(s,t)}else{if(n!==r)return null;csArray.prototype.push.call(s,n)}}return csArray.prototype.join.call(s,"/")}iy(t,e){if(0===e.length)return t;const{path:s,queryString:i}=this.ny(t);let n=csString.prototype.split.call(s,"/");for(const t of e)n=this.uy(n,t);return`${csArray.prototype.join.call(n,"/")}${i}`}uy(t,e){const s=[];let i=0;const n="http:"===t[0]||"https:"===t[0]?2:0;for(let r=0;r<t.length;r++){const o=t[r],a=e[i].key;if(this.hy(a)&&r>=n){const t=e[i].value;csArray.prototype.push.call(s,o.length>0?t:""),i++,i===e.length&&(i=0)}else if(o!==a){for(let e=0;e<i;e++){const n=r-i+e;s[n]=t[n]}i=0,csArray.prototype.push.call(s,o)}else csArray.prototype.push.call(s,o),i++,i===e.length&&(i=0)}for(let e=0;e<i;e++){const n=t.length-i+e;s[n]=t[n]}return s}hy(t){return Yt(t,":")}}const Rd=["class","data-com.agilebits.onepassword.initial-value","data-com.onepassword.iv","data-ember-action","data-initial-value","data-previous-value","data-react-checksum","data-reactid","id","maxlength","onclick","onsubmit","style"];class Ad{constructor(t,e){this.cl=t,this.wt=e}getEventTargetPathAndHierarchy(e,s){const i=Hs(e),n={isNodeSensitive:t=>Ks.isMaskedElement(t)||Ks.isMaskedElementChild(t),isAttributeSensitive:(t,e)=>Ks.isMaskedAttribute(t,e),allWhitelistedAttributes:ir(this.wt.whitelistedAttributes),attributeIgnoreTokens:Rd,useAnonymization:s,attrMaxLength:1024,hierarchyMaxLength:1024};return this.cl.getElementPathAndHierarchy(i,n,t._objectSpread2({dynamicIdRegex:this.wt.dynamicIdRegex},this.wt.pathComputationRules))}getEventTargetPath(e){const s=Hs(e);return this.cl.getElementPath(s,t._objectSpread2({dynamicIdRegex:this.wt.dynamicIdRegex},this.wt.pathComputationRules))}getEventTargetPathAndTargetLink(e){const s=Hs(e),{path:i,firstAnchorParent:n}=this.cl.getElementPathAndFirstAnchorParent(s,t._objectSpread2({dynamicIdRegex:this.wt.dynamicIdRegex},this.wt.pathComputationRules));return{path:i,targetLink:this.ly(n)?n.href:""}}hasValidEventTarget(t){const e=Hs(t);return this.cl.isValidElement(e)}getElementPath(e){return this.cl.getElementPath(e,t._objectSpread2({dynamicIdRegex:this.wt.dynamicIdRegex},this.wt.pathComputationRules))}ly(t){var e;return null!==t&&t.hasAttribute("href")&&!Yt(null!==(e=t.getAttribute("href"))&&void 0!==e?e:"","#")}}class bd{constructor(t){this.Zl=t}transformEvent(t,e){this.py(t,e.event);const s=this.Zl.getElementPath(t);return this.vy(s,e.event),e}py(t,e){if(function(t){return void 0!==t.x&&void 0!==t.y}(e)){const s=t.getBoundingClientRect();e.x=Math.round(s.left+e.x+Ot.windowOffsetX()),e.y=Math.round(s.top+e.y+Ot.windowOffsetY())}}vy(t,e){sa(e)&&(e.tgt=`${t}${Jl}${e.tgt}`),function(t){return void 0!==t.tgtHM}(e)&&(e.tgtHM=`${t}${Jl}${e.tgtHM}`),function(t){return void 0!==t.tgtLk}(e)&&(e.tgtLk=`${t}${Jl}${e.tgtLk}`)}}class Td{constructor(t){this.Zl=t}transformEvent(t,e){const s=this.Zl.getElementPath(t);return{iframePath:e.iframePath?`${s}${Jl}${e.iframePath}`:s,commands:e.commands}}}class Cd{constructor(t){this.Zl=t}transformEvent(e,s){if(0===s.products.length)return s;const i=this.Zl.getElementPath(e),n=csArray.prototype.map.call(s.products,(e=>t._objectSpread2(t._objectSpread2({},e),{},{targetPath:`${i}${Jl}${e.targetPath}`})));return t._objectSpread2(t._objectSpread2({},s),{},{products:n})}}class _d{constructor(){this.my={clientX:2,clientY:3},this.wy={clientX:1,clientY:2},this.gy=[Ds.POINTER_DOWN,Ds.POINTER_MOVE,Ds.POINTER_UP],this.yy=[Ds.TOUCH_START,Ds.TOUCH_MOVE,Ds.TOUCH_END]}transformEvents(t,e){if(!qt.isConnected(t))return e.events=csArray.prototype.filter.call(e.events,(t=>t.type!==Ds.VISIBILITY_CHANGE)),0===e.events.length||(ns.warn(`IframeRecordingEventsTransformer received event ${Je.RecordingEvent}\n        from disconnected iframe, content:${csJSON.stringify(e.events)}`),e.events=[]),e;const s=Qs(t);let i=null;csArray.prototype.some.call(e.events,(t=>this.Ey(t)||this.Ay(t)))&&(i=t.getBoundingClientRect());for(const t of e.events)this.Ey(t)?this._y(i,t):this.Ay(t)&&this.Ry(i,t),t.context=t.context&&t.context.length>0?`${s}/${t.context}`:`${s}`;return e}Ry(t,e){this.Sy(this.wy,t,e)}_y(t,e){this.Sy(this.my,t,e)}Sy(t,e,s){s.args&&(s.args[t.clientX]=Math.round(e.left+s.args[t.clientX]),s.args[t.clientY]=Math.round(e.top+s.args[t.clientY]))}Ey(t){return-1!==csArray.prototype.indexOf.call(this.gy,t.type)}Ay(t){return-1!==csArray.prototype.indexOf.call(this.yy,t.type)}}class Nd{constructor(t){this.Ty=t}start(){this.Ty.onEvent((t=>this.Nn(t))),this.Ty.start()}stop(){this.Ty.stop()}Nn(t){const e=`Content Security Policy error. Violated directive: ${t.violatedDirective} - Source file: ${t.sourceFile}`;ns.warn(e)}}class Id{constructor(){this._h={boundElement:document,type:"securitypolicyviolation",listener:t=>this.securityPolicyViolationListener(t)}}start(){Os(this._h)}stop(){Ps(this._h)}onEvent(t){this.ur=t}Iy(t){if(!t)return!1;const e=t.disposition;return f(t.sourceFile)&&csArray.prototype.some.call(Id.Py,(e=>csString.prototype.indexOf.call(t.sourceFile,e)>0))&&"report"!==e}securityPolicyViolationListener(t){this.Iy(t)&&this.ur({violatedDirective:t.violatedDirective,sourceFile:t.sourceFile})}}Id.Py=["contentsquare","cdnssl.clicktale.net"],as([yt("Event handler type: securitypolicyviolation")],Id.prototype,"securityPolicyViolationListener",null);class Od{init(){this.by=new Nd(new Id),this.by.start()}onOptout(){this.by.stop()}}class Pd extends ne{constructor(t,e,s){super(t,e),this.Vy=null,this.Cy=(null==s?void 0:s.type)||"json",this.ky=null==s?void 0:s.cacheMinutes,this.Os=null==s?void 0:s.timeout}onLoad(t){this.Vs=t}onError(t){this.Cs=t}onTimeout(t,e){this.ks=t,this.Os=e}send(){csArray.prototype.forEach.call(this.beforeRequestCallbacks,(t=>t()));const t=this.retrieveParameters();this.J(t);const e=ie.toQuery(t),s=`${this.domainUri}${this.path?`/${this.path}`:""}?${e}`;this.Md(s,this.Cy)}abort(){this.Vy&&(this.Vy.abort(),this.Vy=null)}isInProgress(){return null!==this.Vy}Md(t,e){var s;const i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType=e,i.onerror=()=>{var t;return null===(t=this.Cs)||void 0===t?void 0:t.call(this,i)},i.ontimeout=()=>{var t;return null===(t=this.ks)||void 0===t?void 0:t.call(this,i)},i.onload=()=>{var t,s;i.status>=200&&i.status<400?(null===(t=this.Vs)||void 0===t||t.call(this,this.Oy(i,e)?i.response:i.responseText),csArray.prototype.forEach.call(this.afterRequestCallbacks,(t=>t()))):null===(s=this.Cs)||void 0===s||s.call(this,i)},i.onloadend=()=>{this.Vy=null},i.timeout=null!==(s=this.Os)&&void 0!==s?s:5e3,this.Vy=i,i.send()}Oy(t,e){const s=t.getResponseHeader("Content-Type");return null===s?"json"===e:csString.prototype.indexOf.call(csString.prototype.toLowerCase.call(s),"json")>0}J(t){let e;e=this.ky?`${(t=>{const e=60*this.ky*1e3;return`${Math.floor(csDate.now()/e)}`})()}`:csString.prototype.slice.call(`${Math.random()}`,2,8),t.r=e}}class kd{constructor(t){this.configuration=t}}class Ld extends kd{constructor(t,e,s){super(t),this.configuration=t,this.Ny=e,this.ha=s,this.xy=yi.RECORDING_GLOBAL_SAMPLING}refreshQuota(){this.$y=void 0,this.My()}onQuotaReady(t){this.Ly=t}init(){this.Dy()}sanitizeSessionCollectState(t){return t}canCollect(t){return null!==t&&t.collectState!==yi.QUOTA_REACHED}computeInitialCollectState(t){return this.$y?(this.ha.emitCollectStateChange(this.$y,fi.ETR_OFF),this.$y):(ns.warn("Quota file error computeInitialCollectState() called before quota answered"),yi.QUOTA_REACHED)}getEligibleCollectState(t){return t.collectState===yi.QUOTA_REACHED?yi.QUOTA_REACHED:!ph.isRecordingSupported()&&this.isReplayRecorded(t)?yi.ANALYTICS_ONLY:t.collectState===yi.RECORDING_RULES_TARGETING?yi.RECORDING_RULES_TARGETING:t.collectState===yi.ANALYTICS_ONLY_RULES_TARGETING?yi.ANALYTICS_ONLY_RULES_TARGETING:t.collectState===yi.RECORDING_GLOBAL_SAMPLING?yi.RECORDING_GLOBAL_SAMPLING:yi.ANALYTICS_ONLY}abortQuotaServiceRequest(){}isReplayRecorded(t){return t.collectState===yi.RECORDING_GLOBAL_SAMPLING||t.collectState===yi.RECORDING_RULES_TARGETING}getInitialCollectState(){return this.$y||yi.QUOTA_REACHED}setVisitorService(t){}computeInitialCollectStateFromRecordingConsentGranted(t){return yi.ANALYTICS_ONLY}Uy(t){this.$y=t,this.Ly&&this.Ly(t)}Dy(){this.Ny.onError((t=>this.quotaServiceErrorHandler(`HTTP:${t.status} - fetching quota file for pid: ${this.configuration.projectId}`))),this.Ny.onTimeout((()=>this.quotaServiceErrorHandler("timeout"))),this.Ny.onLoad((t=>this.quotaFileHandler(t)))}My(){this.Ny.isInProgress()||this.Ny.send()}quotaFileHandler(t){var e;(null===(e=null==t?void 0:t.quotas)||void 0===e?void 0:e.length)?this.Fy(t):this.quotaServiceErrorHandler("Quota types missing from config file")}quotaServiceErrorHandler(t){const e=`Quota error - ${t}`;ns.warn(e),this.Uy(this.xy)}Fy(t){let e=!1,s=!1;for(const i of t.quotas)"ANALYTICS"===i.quotaType&&i.value?e=!0:"RECORDING"===i.quotaType&&i.value&&Zt.boolean(Math.round(100*i.value))&&(s=!0);!e&&s?this.quotaServiceErrorHandler(`Quota types impossible: replay without analytics - ${csJSON.stringify(t)}`):e&&s?ph.isRecordingSupported()?this.Uy(yi.RECORDING_GLOBAL_SAMPLING):this.Uy(yi.ANALYTICS_ONLY):e&&!s?this.Uy(yi.ANALYTICS_ONLY):this.Uy(yi.QUOTA_REACHED)}getRecordingConsentWithdrawn(){return yi.ANALYTICS_ONLY}}as([yt("Quota File: quotaFileHandler")],Ld.prototype,"quotaFileHandler",null),as([yt("Quota File: onerror")],Ld.prototype,"quotaServiceErrorHandler",null);class Md extends kd{constructor(t,e,s,i,n){super(t),this.configuration=t,this.By=e,this.ha=s,this.ew=i,this.Nt=n,this.qy=[]}refreshQuota(){}onQuotaReady(t){}canCollect(t){return!0}init(){this.Hy()}sanitizeSessionCollectState(t){return t.collectState!==yi.QUOTA_REACHED&&t.collectState!==yi.RECORDING_RULES_TARGETING&&t.collectState!==yi.RECORDING_TEMPORARILY||(t.collectState=yi.ANALYTICS_ONLY),t}computeInitialCollectState(t){return Co.isReplayConsentNeeded(this.configuration)?yi.RECORDING_BLOCKED_BY_CONSENT_NOT_EXPRESSED:this.Uw(t)}computeInitialCollectStateFromRecordingConsentGranted(t){return this.Uw(t)}Uw(t){return ph.isRecordingSupported()?(this.qy=[],Zt.percentage()<this.configuration.replayRecordingRate||this.ew.isForceReplayRecorded()?csArray.prototype.push.call(this.qy,yi.RECORDING_GLOBAL_SAMPLING):this.configuration.malkaUrlEnabled&&csArray.prototype.push.call(this.qy,yi.RECORDING_URL_SAMPLING),this.configuration.malkaEtrEnabled&&csArray.prototype.push.call(this.qy,yi.RECORDING_ETR_SAMPLING),this.qy.length>0?(this.My(t),yi.RECORDING_TEMPORARILY):yi.ANALYTICS_ONLY):yi.ANALYTICS_ONLY}getEligibleCollectState(t){return ph.isRecordingSupported()?Co.isRecordingBlockedByConsent(t)?t.collectState===yi.RECORDING_BLOCKED_BY_CONSENT_WITHDRAWN?yi.RECORDING_BLOCKED_BY_CONSENT_WITHDRAWN:yi.RECORDING_BLOCKED_BY_CONSENT_NOT_EXPRESSED:t.collectState===yi.RECORDING_GLOBAL_SAMPLING?yi.RECORDING_GLOBAL_SAMPLING:(this.qy=[],this.configuration.malkaUrlEnabled&&(csArray.prototype.push.call(this.qy,yi.RECORDING_URL_SAMPLING),this.configuration.malkaEtrEnabled&&csArray.prototype.push.call(this.qy,yi.RECORDING_ETR_SAMPLING)),this.qy.length>0?(this.My(t),yi.RECORDING_TEMPORARILY):(t.etrState===fi.ETR_ON&&this.ha.emitCollectStateChange(yi.ANALYTICS_ONLY,fi.ETR_ON),yi.ANALYTICS_ONLY)):yi.ANALYTICS_ONLY}My(t){var e;const s=null===(e=this.bt)||void 0===e?void 0:e.getVisitor();this.By.send({recordingTypes:csArray.prototype.map.call(this.qy,Number),url:this.Nt.getAnonymizedUrl(),projectId:this.configuration.projectId,uu:(null==s?void 0:s.id)||"",sn:(null==s?void 0:s.visitsCount)||"",pn:(null==t?void 0:t.pageNumber)||""})}abortQuotaServiceRequest(){this.By.abort()}isReplayRecorded(t){return!Co.isRecordingBlockedByConsent(t)&&(t.collectState===yi.RECORDING_TEMPORARILY||t.collectState===yi.RECORDING_GLOBAL_SAMPLING||t.collectState===yi.RECORDING_URL_SAMPLING||t.etrState===fi.ETR_ON)}Hy(){this.By.onError((()=>this.quotaServiceErrorHandler("NetworkError"))),this.By.onTimeout((()=>this.quotaServiceTimeoutHandler()),3e3),this.By.onLoad((t=>this.quotaServiceLoadHandler(t)))}quotaServiceErrorHandler(t){this.zy(`error - ${t}`)}quotaServiceTimeoutHandler(){this.zy("timeout")}zy(t){let e=yi.ANALYTICS_ONLY;this.jy(this.qy)?(e=yi.RECORDING_GLOBAL_SAMPLING,ns.warn(`Quota Service: request ${t} - bypassed by GLOBAL_SAMPLING`)):ns.warn(`Quota Service: request ${t}`),this.ha.emitCollectStateChange(e,fi.ETR_OFF)}quotaServiceLoadHandler(t){if(200!==t.status)return void this.quotaServiceErrorHandler(`Status code: ${t.status}`);let e;try{e=csJSON.parse(t.responseText)}catch(e){return void this.quotaServiceErrorHandler(`Unable to parse the quota service response: ${t.responseText}`)}const s=null==e.allowedRecordingTypes?void 0:csArray.prototype.map.call(e.allowedRecordingTypes,csString);if(!s)return void this.quotaServiceErrorHandler("recording types missing from quota service response");let i=fi.ETR_OFF,n=yi.ANALYTICS_ONLY;this.jy(s)?n=yi.RECORDING_GLOBAL_SAMPLING:this.Gy(s)&&(n=yi.RECORDING_URL_SAMPLING),this.Zy(s)&&(i=fi.ETR_ON),this.ha.emitCollectStateChange(n,i)}jy(t){return csArray.prototype.some.call(t,(t=>t===yi.RECORDING_GLOBAL_SAMPLING))}Gy(t){return csArray.prototype.some.call(t,(t=>t===yi.RECORDING_URL_SAMPLING))}Zy(t){return csArray.prototype.some.call(t,(t=>t===yi.RECORDING_ETR_SAMPLING))}setVisitorService(t){this.bt=t}getInitialCollectState(){return yi.ANALYTICS_ONLY}getRecordingConsentWithdrawn(){return yi.RECORDING_BLOCKED_BY_CONSENT_WITHDRAWN}}as([yt("Quota Service: onerror")],Md.prototype,"quotaServiceErrorHandler",null),as([yt("Quota Service: ontimeout")],Md.prototype,"quotaServiceTimeoutHandler",null),as([yt("Quota Service: onload")],Md.prototype,"quotaServiceLoadHandler",null);class Dd{constructor(){this.Wy={PIISelectors:["picture","img","video","audio"],Attributes:[]},this.Zv={elementSelector:"",attrSelector:"",attrSelectors:[]},this.Zv=Ks.getComputedSelectorSettings({PIISelectors:["[data-cs-mask]","#c1_card_info_id",".ctHidden","[data-heap-redact-text]","[heap-ignore]","[data-heap-ignore]","[data-heap-redact-attributes]","[data-hj-suppress]",".data-hj-suppress","[data-hj-masked]"],Attributes:[{selector:".ctHidden,input:not([type=button]):not([type=submit])",attrName:"value"}]},this.Zv)}init(){this.Qy()}setMaskedElementSettingsFromCommand(t){t=Ks.sanitizeSelectorUserInput(t),Ks.isSelectorUserInput(t)&&this.Jy(t)}setMaskedElementSettingsFromParent(t){const e={PIISelectors:csString.prototype.split.call(t.elementSelector,","),Attributes:t.attrSelectors};this.Jy(e)}getMaskedElementSettings(t){return t?this.Ky(this.Wy):this.Zv}Qy(){var t,e,s,i,n,r;const o={PIISelectors:[],Attributes:[]};(null===(s=null===(e=null===(t=null===window||void 0===window?void 0:window.ClickTaleSettings)||void 0===t?void 0:t.DOM)||void 0===e?void 0:e.PII)||void 0===s?void 0:s.Text)instanceof Array&&o.PIISelectors.push(...window.ClickTaleSettings.DOM.PII.Text),(null===(r=null===(n=null===(i=null===window||void 0===window?void 0:window.ClickTaleSettings)||void 0===i?void 0:i.DOM)||void 0===n?void 0:n.PII)||void 0===r?void 0:r.Attributes)instanceof Array&&window.ClickTaleSettings.DOM.PII.Attributes.forEach((t=>{f(t.attr)&&f(t.rule)&&o.Attributes.push({selector:t.rule,attrName:t.attr})})),this.Jy(o)}Jy(t){this.Zv=this.Ky(t)}Ky(t){return Ks.getComputedSelectorSettings(t,this.Zv)}}class xd{constructor(t,e,s,i,n){this.wt=t,this.xt=e,this.yt=s,this.qr=i,this.ha=n,this.Yy=()=>{var t;const e=cs.get(sl);null!==e&&cl.isValidSessionString(e)?this.Pm.canCollect(cl.fromRawString(e))?this.init():null===(t=this.wt.voc)||void 0===t||t.enabled:(this.Pm.onQuotaReady((t=>{var e;t!==yi.QUOTA_REACHED?this.init():null===(e=this.wt.voc)||void 0===e||e.enabled})),this.Pm.refreshQuota())}}initWithQuota(){var t,e;if(!1===(null===(t=this.wt.smbConfig)||void 0===t?void 0:t.record))return void(null===(e=this.wt.voc)||void 0===e||e.enabled);const s=new Pd(this.wt.getQuotaUri(),"",{type:"json",cacheMinutes:15});this.Pm=new Ld(this.wt,s,this.ha),this.Pm.init(),this.Yy()}init(){let t,e,s,i,n,r,o,a,c,h,l,d,u,p,g,m,y,f,v,E,S,w,R,A,b,T,C,_,N,I,O;Qc.isSupported()&&Qc.setDigestSalt(this.wt.projectId.toString()),this.qr.schedule((()=>{t=new Re,e=new wd(t),i=new Zl(window.location,e),s=new us(this.wt,i,this.xt),s.init()})),this.qr.schedule((()=>{n=new cd,r=new hd,m=new Ml(window.location,s),(new Od).init(),y=ad.create(ns.warn),g=new ws(y);const t=g.create(`${this.wt.getLegacyQuotaUri()}/quota`,!0);void 0===this.Pm&&(this.Pm=new Md(this.wt,t,this.ha,m,i),this.Pm.init())})),this.qr.schedule((()=>{o=new cl(this.wt,s,n),a=new hl(o,this.Pm)})),this.qr.schedule((()=>{c=new Sd(this.wt,s,n),h=new el(this.wt,c,this.ha,a),this.yt.setContext(h,a),this.Pm.setVisitorService(h)})),this.qr.schedule((()=>{O=new wl(this.wt,new gl(this.wt,s,r),this.ha),l=new dl(h,a,O),d=new Cl(this.wt,s,n),u=new _l(window.location,d),p=new Nl(u),f=new ll(this.wt,h,u),N=new Ad(zt,this.wt),A=new bd(N),b=new Td(N),T=new Cd(N),C=new _d,_=new td(A,b,T,C),R=new Fl([ql.UXA]),v=new $l(R,_),E=new Ol(i),S=new kl(E,R);const e=new dd(this.wt,s,n);I=new md(t,e),w=new fd(R,I),new Rs(h,a,u,I,this.wt)})),this.qr.schedule((()=>{new tl(this.wt,h,u,f,l,void 0,void 0,m).compute((n=>{this.qr.schedule((()=>{v.init();const o=new Kl,c=new Sl(this.wt,R,O,a,this.ha),l=new xl(this.wt,s,r),d=new Ul(this.ha,window.location,l),u=new Hl(R,d),m=new Gl(R,this.wt),f=new jl(this.wt,h,a,void 0);if(n){this.ha.emitInitTracking();const n=new Dd;new Jh(f,y,h,a,this.ha,R,v,this.wt,u,d,c,O,t,N,e,i,m,o,_,I,w,E,S,this.qr,g,s,r,this.Pm,n).start()}else new Rl(this.ha,R,v,u,d,p,c).start()}))}))}))}}var Ud,Vd;!function(t){let e;const s={loadBundle(t){const r=t.source,o=t.data;if(i(o)){const i=()=>{!function(t,e){const s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src=t,s.onload=e,s.charset="utf-8",document.head.appendChild(s)}(function(t,e){return csString.prototype.replace.call(csString.prototype.replace.call(csString.prototype.replace.call("{domain}/tag/tag.bundle.js?v={version}","{version}",e.version),"{token}",e.token),"{domain}",e.domain)}(0,o),(()=>r.postMessage("csBundleLoaded",t.origin)))};e=o.token,c(s.loadBundle),n(t.origin)&&i()}}};function i(t){return t&&"csBundleInjection"===t.type&&n(t.domain)&&o(t.version)&&r(t.token)}function n(e){return/^https?:\/\/[a-zA-Z0-9\.\-]+\.(content-square\.fr|contentsquare\.com|csq\.io)$/.test(e)||t.hjDomainRegex.test(e)}function r(t){return/^[a-zA-Z0-9]+$/.test(t)}function o(t){return/^[a-zA-Z0-9\.]+$/.test(t)}function a(t){window.addEventListener("message",t,!1)}function c(t){window.removeEventListener("message",t,!1)}t.getToken=function(){return e},t.isAuthorizedIncomingMessage=i,t.hjDomainRegex=/^https?:\/\/[a-zA-Z0-9\.\-]+\.hotjar\.com$/,t.isAuthorizedDomain=n,t.isAuthorizedToken=r,t.isAuthorizedTagVersion=o,t.isActivable=function(){const t=window.opener||window.parent;return window!==t&&window.addEventListener},t.waitForBundleInjection=function(){a(s.loadBundle)},t.listen=a,t.removeListener=c}(Ud||(Ud={})),function(t){const e=window.opener||window.parent,s=[/^https:\/\/app\.contentsquare\.com$/,/^https:\/\/dev-app\.contentsquare\.com$/,/^https:\/\/staging-app\.contentsquare\.com$/,/^https:\/\/.*\.test\.contentsquare\.com$/,/^https:\/\/app\.[a-z0-9-]+\.csiab\.[a-z0-9-]+\.csq\.io$/,Ud.hjDomainRegex];let i,n;const r={ping(t){if("ping"===t.data&&o(t.origin)){const e=Ud.hjDomainRegex.test(t.origin);i=e?"https://app.contentsquare.com":t.origin,n=e?t.origin:void 0,h(r.ping),c(r.insertMessageScript),a(`utils.js?cb=${(new csDate).getTime()}`)}},insertMessageScript:l((t=>{const e=t.data;"string"==typeof e&&"ping"!==e&&(h(r.insertMessageScript),a(e))}))};function o(t){return csArray.prototype.some.call(s,(e=>e.test(t)))}function a(t,e){const s=document.createElement("script");s.type="text/javascript",s.async=!0;const n=csString.prototype.replace.call(i,/^https?:/,"");s.src=`${n}/tag/${t}`,s.onload=e,s.charset="utf-8",document.getElementsByTagName("head")[0].appendChild(s),function(t){csString.prototype.includes.call(t,"&mode=")&&sessionStorage.setItem("_hjRetakerMode",csString.prototype.split.call(t,"&mode=")[1])}(t)}function c(t){window.addEventListener("message",t,!1)}function h(t){window.removeEventListener("message",t,!1)}function l(t){return function(e){(e.origin===i||n)&&t(e)}}t.getToken=function(){return Ud.getToken()},t.isActivable=function(){return window!==e&&window.addEventListener},t.isAuthorizedDomain=o,t.waitForConnection=function(){c(r.ping),Ud.waitForBundleInjection()},t.listen=c,t.removeListener=h,t.secureListener=l,t.post=function(t){n?e.postMessage(t,n):i&&e.postMessage(t,i)}}(Vd||(Vd={}));const Bd=window.CSFrameCommunication||Vd;class Hd extends Xl{emitTrackingContextResultMessage(t){for(const e of this.listeners)e.onTrackingContextResultCallback&&e.onTrackingContextResultCallback(t)}emitAfterPageViewCallback(t){for(const e of this.listeners)e.onAfterPageViewCallback&&e.onAfterPageViewCallback(t)}emitIntegrationSessionKeyCallback(t){for(const e of this.listeners)e.onIntegrationSessionKeyCallback&&e.onIntegrationSessionKeyCallback(t)}emitParentRecordingContextChange(t){for(const e of this.listeners)e.onParentRecordingContextChange&&e.onParentRecordingContextChange(t)}emitParentSensitiveStatusChange(t){for(const e of this.listeners)e.onParentSensitiveStatusChange&&e.onParentSensitiveStatusChange(t)}emitStartAnalytics(){for(const t of this.listeners)t.onStartAnalytics&&t.onStartAnalytics()}emitStopAnalytics(){for(const t of this.listeners)t.onStopAnalytics&&t.onStopAnalytics()}emitStartRecording(){for(const t of this.listeners)t.onStartRecording&&t.onStartRecording()}emitStopRecording(){for(const t of this.listeners)t.onStopRecording&&t.onStopRecording()}}class $d extends Xl{constructor(t){super(),this.qr=t}emitBeforeNaturalPageView(){for(const t of this.listeners)t.onBeforeNaturalPageView&&t.onBeforeNaturalPageView()}emitAfterNaturalPageView(){for(const t of this.listeners)t.onAfterNaturalPageView&&t.onAfterNaturalPageView()}emitInitTracking(){for(const t of this.listeners)t.onInitTracking&&t.onInitTracking()}emitStartTracking(t){for(const e of this.listeners)e.onStartTracking&&this.qr.schedule((()=>e.onStartTracking(t)))}emitArtificialPageViewEnd(){for(const t of this.listeners)if(t.onArtificialPageViewEnd)try{t.onArtificialPageViewEnd()}catch(t){ns.error(t)}}emitBeforeArtificialPageView(){for(const t of this.listeners)t.onBeforeArtificialPageView&&t.onBeforeArtificialPageView()}emitAfterArtificialPageView(){for(const t of this.listeners)t.onAfterArtificialPageView&&t.onAfterArtificialPageView()}emitBeforeSessionRenewal(){for(const t of this.listeners)t.onBeforeSessionRenewal&&t.onBeforeSessionRenewal()}emitAfterSessionRenewal(){for(const t of this.listeners)t.onAfterSessionRenewal&&t.onAfterSessionRenewal()}emitOptout(){for(const t of this.listeners)t.onOptout&&t.onOptout()}emitReplayUnanonymizationConsentGranted(){for(const t of this.listeners)t.onReplayUnanonymizationConsentGranted&&t.onReplayUnanonymizationConsentGranted()}emitReplayUnanonymizationConsentWithdrawn(){for(const t of this.listeners)t.onReplayUnanonymizationConsentWithdrawn&&t.onReplayUnanonymizationConsentWithdrawn()}emitAfterReplayRecordingConsentGranted(){for(const t of this.listeners)t.onAfterReplayRecordingConsentGranted&&t.onAfterReplayRecordingConsentGranted()}emitAfterReplayRecordingConsentWithdrawn(){for(const t of this.listeners)t.onAfterReplayRecordingConsentWithdrawn&&t.onAfterReplayRecordingConsentWithdrawn()}emitCollectStateChange(t,e){for(const s of this.listeners)s.onCollectStateChange&&s.onCollectStateChange(t,e)}emitInitialDomStart(){for(const t of this.listeners)t.onInitialDomStart&&t.onInitialDomStart()}emitInitialDomDone(t){for(const e of this.listeners)e.onInitialDomDone&&e.onInitialDomDone(t)}emitRecordingContextChange(){for(const t of this.listeners)t.onRecordingContextChange&&t.onRecordingContextChange()}emitSensitiveStatusChange(){var t;for(const e of this.listeners)null===(t=e.onSensitiveStatusChange)||void 0===t||t.call(e)}emitBeforeVisitorRenewal(){for(const t of this.listeners)t.onBeforeVisitorRenewal&&t.onBeforeVisitorRenewal()}emitAfterVisitorCleared(){for(const t of this.listeners)t.onAfterVisitorCleared&&t.onAfterVisitorCleared()}emitAfterVisitorRenewal(){for(const t of this.listeners)t.onAfterVisitorRenewal&&t.onAfterVisitorRenewal()}}as([Nt("emitStartTracking")],$d.prototype,"emitStartTracking",null);const qd=["addUserProperties"],zd=["identify"],Fd=["getIdentity"],jd=["resetIdentity"],Gd=["trackTransaction"];class Wd{constructor(t){this.Xy=t}init(){this.Xy.register(qo),this.Xy.register(yd),this.Xy.register(Nc),this.Xy.register(Ic),this.Xy.register(_c),this.Xy.register(Yo),this.Xy.register(Qo),this.Xy.register(Zo),this.Xy.register(Xo),this.Xy.register(Gd),this.Xy.register(Uc),this.Xy.register(Vc),this.Xy.register(Vl),this.Xy.register(Bl),this.Xy.register(Hc),this.Xy.register(Xc),this.Xy.register(Kc),this.Xy.register(Ro),this.Xy.register(yl),this.Xy.register(fl),this.Xy.register(vl),this.Xy.register(El),this.Xy.register(jh),this.Xy.register(Gh),this.Xy.register(qd),this.Xy.register(zd),this.Xy.register(Fd),this.Xy.register(jd)}onStartTracking(){this.Xy.start()}onOptout(){this.Xy.stop()}}class Yd extends ni{constructor(t,e){super(),this.Za=t,this.tE=e,this.Lu=[]}onStart(){this.commandsBatchReady()}onStop(){this.Lu=[]}register(t){var e=this;for(const s of t)this.Za.register([s],(function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return e.send(s,i)}))}send(t,e){csArray.prototype.push.call(this.Lu,{name:t,params:e}),this.isStarted&&this.commandsBatchReady()}commandsBatchReady(){if(0===this.Lu.length)return;const t={commands:this.Lu};this.tE.sendToParent(Je.Commands,t),this.Lu=[]}}as([yt("Commands.iframe.commandsBatch.send")],Yd.prototype,"send",null),as([yo(),yt("send iframe commands batch")],Yd.prototype,"commandsBatchReady",null);class Qd{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:25;this.sE=t,this.eE=[]}reset(){this.eE=[]}getMessages(){return this.eE}addMessage(t){this.eE.length<this.sE?csArray.prototype.push.call(this.eE,t):this.eE.length===this.sE&&(this.iE(t),csArray.prototype.push.call(this.eE,t))}iE(t){t.type=Je.ChildLogMessage,t.content={message:"Buffer is full, events might be missing.",errorCode:"",level:se.warn}}}class Zd extends ni{constructor(t){super(),this.buffer=new Qd(t)}}class Xd extends Zd{constructor(t,e,s,i,n){super(25),this.wt=t,this.ha=e,this.nE=s,this.rE=i,this.oE=n,this.hE=null,this.cE={boundElement:window,type:"message",listener:t=>this.Pf(t)}}onStart(){Os(this.cE,!1),this.aE()}onStop(){Ps(this.cE,!1),this.hE&&(ts.closeChannelPort(this.hE),this.hE=null)}sendToParent(t,e){const s=this.buildChildBaseMessage(t,e);this.uE(s)}aE(){const t=this.buildChildBaseMessage(Je.Discovery);ts.sendPostMessage(window.parent,"*",t)}buildChildBaseMessage(t,e){const s=ts.buildBaseMessage(t,Ke.Child,this.wt.projectId);return e&&(s.content=e),s}uE(t){null!==this.hE?ts.sendChannelMessage(this.hE,t):this.buffer.addMessage(t)}lE(t,e){const s=ts.getNewChannelMessage();this.hE=s.port1,this.hE.onmessage=t=>{this.Gf(t)};const i=this.buildChildBaseMessage(Je.Discovery);i.id=e,ts.sendPostMessage(window.parent,t,i,[s.port2]),this.sendAllMessagesFromBuffer()}Gf(t){switch(t.data.type){case Je.TrackingContextResultMessage:this.oE.emitTrackingContextResultMessage(t.data.content);break;case Je.IntegrationCallback:{const e=t.data.content;e.initiator===Xe.AfterPageView?this.oE.emitAfterPageViewCallback(e):e.initiator===Xe.GetSessionKey?this.oE.emitIntegrationSessionKeyCallback(e):ns.warn(`Iframe child received unknown IntegrationCallback type from parent : ${csJSON.stringify(t.data)}`);break}case Je.Stop:this.ha.emitOptout();break;case Je.RecordingContext:{const e=t.data.content;this.nE.setRecordingContext(e),this.oE.emitParentRecordingContextChange(e);break}case Je.SensitiveStatus:{const e=t.data.content;this.rE.setSensitiveStatus(e),this.oE.emitParentSensitiveStatusChange(e);break}default:ns.warn(`Iframe child received unknown channelMessage type from parent : ${csJSON.stringify(t.data)}`)}}Pf(t){if(null===this.hE&&ts.isMessageValid(t,Ke.Parent,this.wt.projectId,this.wt.hostnames))switch(t.data.type){case Je.Stop:this.ha.emitOptout();break;case Je.Discovery:if(!y(t.data.id)||t.data.id<0)return void ns.warn(`Iframe child received discovery without valid id from parent (${t.origin}) : ${csJSON.stringify(t.data)}`);this.lE(t.origin,t.data.id);break;default:ns.warn(`Iframe child received unknown postMessage type from parent (${t.origin}) : ${csJSON.stringify(t.data)}`)}}sendAllMessagesFromBuffer(){if(null===this.hE)return;const t=this.buffer.getMessages();for(const e of t)ts.sendChannelMessage(this.hE,e);this.dE(),this.buffer.reset()}dE(){const t=ts.buildBaseMessage(Je.EndOfBufferedMessages,Ke.Child,this.wt.projectId);ts.sendChannelMessage(this.hE,t)}}class Kd{constructor(t){this.tE=t}onStartTracking(){this.tE.start()}onOptout(){this.tE.stop()}}class Jd{constructor(t,e,s,i,n){this.Pu=t,this.Cu=e,this.tE=s,this.nE=i,this.rE=n}init(){this.Pu.onChildMessage(((t,e,s)=>this.Cu.emitIframeEvent(t,e,s))),this.Pu.setSentiveStatusCallback((()=>this.rE.getSensitiveStatus())),this.Pu.setRecordingContextCallback((()=>this.nE.getRecordingContext()))}onStartTracking(){this.Pu.start()}onOptout(){this.Pu.stop()}onIframeRecordingUserEvent(t){const e={events:t,containsUserEvent:!0};this.tE.sendToParent(Je.RecordingEvent,e)}onIframeRecordingBrowserEvent(t){const e={events:t,containsUserEvent:!1};this.tE.sendToParent(Je.RecordingEvent,e)}onIframeAnalysisUserEvent(t){const e={event:t,isUserEvent:!0};this.tE.sendToParent(Je.AnalysisEvent,e)}onIframeAnalysisBrowserEvent(t){const e={event:t,isUserEvent:!1};this.tE.sendToParent(Je.AnalysisEvent,e)}onIframeJavascriptError(t){this.tE.sendToParent(Je.JavascriptError,t)}onIframeApiError(t){this.tE.sendToParent(Je.ApiError,t)}onIframeDetailedApiError(t){this.tE.sendToParent(Je.DetailedApiError,t)}onIframeEmerchandisingMessage(t){this.tE.sendToParent(Je.EmerchandisingMessage,t)}onIframeCommands(t){this.tE.sendToParent(Je.Commands,t)}onIframeIntegrationCallback(t){this.tE.sendToParent(Je.IntegrationCallback,t)}onTrackingContextRequestCallback(t){this.tE.sendToParent(Je.TrackingContextRequestMessage,t)}onIframeStaticResource(t){this.tE.sendToParent(Je.StaticResource,t)}onIframeCustomError(t){this.tE.sendToParent(Je.CustomError,t)}onTrackingContextResultCallback(t){this.Pu.sendToChildren(Je.TrackingContextResultMessage,t)}onAfterPageViewCallback(t){this.Pu.sendToChildren(Je.IntegrationCallback,t)}onIntegrationSessionKeyCallback(t){this.Pu.sendToChildren(Je.IntegrationCallback,t)}onParentRecordingContextChange(t){this.Pu.sendToChildren(Je.RecordingContext,t)}onParentSensitiveStatusChange(t){this.Pu.sendToChildren(Je.SensitiveStatus,t)}}class tu extends ni{constructor(t,e,s,i,n,r,o,a){super(),this.Bl=t,this.il=e,this.tE=s,this.Jl=i,this.Kl=n,this.Xl=r,this.td=o,this.sd=a}init(){var t,e,s,i,n;this.Bl.onEvent((t=>this.Rn(t))),this.il.onEvent((t=>this.Rn(t))),null===(t=this.Jl)||void 0===t||t.onEvent((t=>this.Rn(t))),null===(e=this.Kl)||void 0===e||e.onEvent((t=>this.Rn(t))),null===(s=this.Xl)||void 0===s||s.onEvent((t=>this.Rn(t))),null===(i=this.td)||void 0===i||i.onEvent((t=>this.rd(t))),null===(n=this.sd)||void 0===n||n.onEvent((t=>this.rd(t)))}onStart(){var t,e,s,i,n;this.Bl.start(),this.il.start(),null===(t=this.Jl)||void 0===t||t.start(),null===(e=this.Kl)||void 0===e||e.start(),null===(s=this.Xl)||void 0===s||s.start(),null===(i=this.td)||void 0===i||i.start(),null===(n=this.sd)||void 0===n||n.start()}onStop(){var t,e,s,i,n;this.Bl.stop(),this.il.stop(),null===(t=this.Jl)||void 0===t||t.stop(),null===(e=this.Kl)||void 0===e||e.stop(),null===(s=this.Xl)||void 0===s||s.stop(),null===(i=this.td)||void 0===i||i.stop(),null===(n=this.sd)||void 0===n||n.stop()}Rn(t){const e={isUserEvent:!0,event:t};this.Nn(e)}rd(t){const e={isUserEvent:!1,event:t};this.Nn(e)}Nn(t){this.isStarted&&t.event.type!==ta.RESIZE&&this.tE.sendToParent(Je.AnalysisEvent,t)}}const eu=["webview:analytics:start"],su=["webview:analytics:stop"];class iu{constructor(t,e,s,i,n,r,o,a,c){this.wt=t,this.Zl=e,this.al=s,this.tE=i,this.jt=n,this.fE=r,this.Za=o,this.il=a,this.Rd=c}init(){const t=gc(this.wt,this.Zl,this.Rd),e=[];this.wt.collectHierarchy||csArray.prototype.push.call(e,"submit");const s=new ra(t,this.Zl,this.al,e),i=this.jt.isInWebViewContext()?{collectGestureVelocity:!0,collectGestureDistance:!0}:{collectGestureVelocity:!1,collectGestureDistance:!1},n=mc(this.wt,this.Zl,this.Rd),r=new na(n,this.il,i);this.pE=new tu(s,r,this.tE,void 0,void 0,void 0,void 0,void 0),this.pE.init(),this.jt.isInWebViewContext()&&this.vE()}onStartTracking(){this.pE.start()}onOptout(){this.pE.stop()}onStartAnalytics(){this.pE.start()}onStopAnalytics(){this.pE.stop()}vE(){this.Za.register(eu,(()=>this.fE.emitStartAnalytics()),{disableApplyPending:!0}),this.Za.register(su,(()=>{this.fE.emitStopRecording(),this.fE.emitStopAnalytics()}),{disableApplyPending:!0})}}class nu extends ni{constructor(t,e,s,i){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],r=arguments.length>5?arguments[5]:void 0;super(),this.wt=t,this.en=e,this.tE=s,this.cn=i,this.an=n,this.ln=r,this.mE=!1,this.Vn=!1,this.wn=new ii,this.Wi=[],this.wE=!1,this.An=t=>this.rd(t),this._n=t=>this.Rn(t)}init(){this.Ln()}Ln(){var t;this.cn.onEvent(this.An,this._n),null===(t=this.en)||void 0===t||t.onInputNodeToEncrypt(this._n)}setEnableOnlineAssets(t){this.mE=null!=t&&t}setOnlineAssetsEnabledOnNextStart(t){this.Vn=t}getStaticResourceManagerStatus(){return this.ln?{supported:Un.isSupported(),onlineAssets:{activated:this.mE,enableOnNextStart:this.Vn}}:null}rd(t){this.gE(t),this.yE()}Rn(t){this.EE(t),this.yE()}EE(t){csArray.prototype.push.call(this.Wi,t),this.wE=!0}gE(t){csArray.prototype.push.call(this.Wi,t)}yE(){Dt(this.an,(t=>{var e;return null===(e=t.flushEvents)||void 0===e?void 0:e.call(t)}));const t={containsUserEvent:this.wE,events:this.Wi};this.tE.sendToParent(Je.RecordingEvent,t),this.Wi=[],this.wE=!1}onStart(){this.ln&&this.mE&&this.ln.enableOnlineAssets(),this.cn.start(),this.wt.emitDebugEvents&&this.wn.emit("replayRecordingStarted"),Dt(this.an,(t=>{t.start&&t.start()}))}onStop(){var t;this.cn.stop(),null===(t=this.ln)||void 0===t||t.disableOnlineAssets(),Dt(this.an,(t=>{t.stop&&t.stop()}))}addInitialDom(t){for(let e=0;e<this.Wi.length;e+=1)if(this.Wi[e].date>=t.date)return csArray.prototype.splice.call(this.Wi,e,0,t),this.wE=!0,void this.yE();this.EE(t),this.yE()}}class ru{constructor(t){this.wt=t}isReplayUnanonymizedAllowedByConsent(){return!this.wt.consentRequired}}class ou{static isWebViewLocalAssetsSupported(){return"URL"in window}}const au=["webview:replay:start"],cu=["webview:replay:stop"];class hu{constructor(t,e,s,i,n,r,o,a){this.wt=t,this.fE=e,this.AE=s,this._E=i,this.RE=n,this.Za=r,this.Nt=o,this.rE=a,this.SE=!1}init(){const t=new ru(this.wt),e=new _h;if(this.Ya=new Ol(this.Nt),new kl(this.Ya,this.Za).init(),this.tu=new Ch(t,this.wt,this.Nt,e),this.tu.init(),ou.isWebViewLocalAssetsSupported()){const t=t=>{this.TE(t)},e=t=>ns.error("An error occurred while fetching a styleSheet: "+t),s=new Set,i=t=>!s.has(t),n=t=>{s.add(t.assetId),this.TE([t])};this.AE.onAsset((t=>{this.IE(t)})),this.AE.onStyleSheetFound((s=>{this.RE.getStyleSheetAssets(s.assetId,t,e,i,n)}))}this.PE()}onStartRecording(){if(this.SE=!0,!this.Ya.isUrlExcludedForSessionReplay()){const t=this.rE.getSensitiveStatus();this.fE.emitParentRecordingContextChange({isRecording:!0,isMutationTrackerStarted:!0,useAnonymization:t.useAnonymization})}}onStopRecording(){this.SE=!1,this.fE.emitParentRecordingContextChange({isRecording:!1,isMutationTrackerStarted:!1})}onArtificialPageViewEnd(){this.fE.emitParentRecordingContextChange({isRecording:!1})}onAfterArtificialPageView(){this.Ti()&&!this.Ya.isUrlExcludedForSessionReplay()&&this.fE.emitParentRecordingContextChange({isRecording:!0})}Ti(){return this.SE}PE(){this.Za.register(au,(()=>{this.fE.emitStartAnalytics(),this.fE.emitStartRecording()}),{disableApplyPending:!0}),this.Za.register(cu,(()=>this.fE.emitStopRecording()),{disableApplyPending:!0})}IE(t){this._E.sendToParent(Je.Assets,{assets:[t]})}TE(t){0!==t.length&&this._E.sendToParent(Je.Assets,{assets:t})}}var lu,du,uu,pu=/(@import\s*("([^"]+)"|'([^']+)'))|(url\s*\(\s*((("([^"\]]+)"|'([^'\]]+)')\s*)|([^)\]]+))\))/g;class gu{constructor(t){this.bE=t}getStyleSheetAssets(t,e,s,i,n){const r=[];Ai(t)&&this.bE.getResourceContentText(t,((t,o)=>{const a=this.VE(t,o);csArray.prototype.forEach.call(a,(t=>{csArray.prototype.push.call(r,t),Ai(t.assetId)&&i(t.assetId)&&(null==n||n(t),this.getStyleSheetAssets(t.assetId,e,s,i,n))})),e(r)}),(t=>s(t)))}VE(t,e){return this.CE(t,function(t){var e=[];return function(t,e){t.replace(pu,(function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];var i=t[3]||t[4],n=t[9]||t[10]||t[11],r=(i||n).trim().replace(/(\\)*\\(?:([a-fA-F0-9]{1,6})|(.))[\n\t\x20]?/g,(function(t,e,s,i){if("\\"===e)return t.slice(1);if(i)return i;var n=parseInt(s,16);return 55296<=n&&n<=57343||0===n||n>1114111?"ï¿½":String.fromCodePoint(n)}));return(i?"@import ":"")+"url("+function(t){return-1===t.indexOf('"')?'"'+t+'"':-1===t.indexOf("'")?"'"+t+"'":t}(e(r)||r)+")"}))}(t,(function(t){return e.push(t),t})),e}(e))}CE(t,e){return csArray.prototype.map.call(csArray.prototype.filter.call(csArray.prototype.filter.call(e,(t=>!wi(t))),(t=>!Ri(t))),(e=>({assetId:je(e,t),assetBasePath:t,assetRawPath:e})))}}class mu{getResourceContentText(t,e,s){const i=this.kE((s=>{e(t,s.responseText)}),s);i.open("GET",t),i.send()}kE(t,e){const s=new XMLHttpRequest;return s.onreadystatechange=function(){s.readyState===XMLHttpRequest.DONE&&(200===s.status?t(s):e(s.statusText))},s}}class yu extends ni{constructor(t,e){super(),this.ca=t,this.tE=e}onStart(){}onStop(){}init(){this.ca.onSendStaticResource((t=>this.tE.sendToParent(Je.StaticResource,t)))}}class fu{constructor(t,e,s,i,n,r,o,a,c,h,l,d,u){this.wt=t,this.gt=e,this.Wa=s,this.ha=i,this.tE=n,this.nE=r,this.Za=o,this.oE=a,this.jt=c,this.Nt=h,this.rE=l,this.uh=d,this.en=u}init(){const t=[],e=this.nE.getRecordingContext();this.eu=new Sr(!!e.useAnonymization,this.wt.whitelistedAttributes,this.gt,this.wt.anonymizeDigits);const s=[];csArray.prototype.push.call(s,new Kn,this.eu,new wr(this.uh)),csArray.prototype.push.call(s,new Ar);const i=new Wn;csArray.prototype.push.call(t,i),!this.jt.isInWebViewContext()&&this.wt.useStaticResourceManager&&Un.isSupported()&&(this.ln=new Un,csArray.prototype.push.call(s,this.ln),this.ca=new po,this.OE=new yu(this.ca,this.tE),this.OE.init()),this.ou=new Js,this.ou.init(),csArray.prototype.push.call(t,this.ou),csArray.prototype.push.call(t,new zn(window.location,this.gt));const n=[this.Wa,new Rn,new co(csArray.prototype.filter.call(t,(t=>t))),new Br,new $r,new Zr,new Vr(this.en)],r=new ao(n,s),o=new uo(r,this.ha,this.ca);if(this.NE=new nu(this.wt,this.en,this.tE,o,t,this.ln),this.Za.register(wo,(()=>this.nE.getRecordingContext().isRecording)),this.Za.register(Ao,(()=>this.NE.getStaticResourceManagerStatus())),this.NE.init(),this.jt.isInWebViewContext()){const t=new gu(new mu);this.xE=new hu(this.wt,this.oE,i,this.tE,t,this.Za,this.Nt,this.rE),this.oE.addListener(this.xE),this.ha.addListener(this.xE),this.xE.init()}}onParentRecordingContextChange(t){var e,s;void 0!==t.useAnonymization&&this.iu(t.useAnonymization),void 0!==t.enableOnlineResourcesOnNextPageview&&this.NE.setOnlineAssetsEnabledOnNextStart(t.enableOnlineResourcesOnNextPageview),t.isRecording?(this.lu(),this.NE.setEnableOnlineAssets(t.enableOnlineResources),this.NE.start(),null===(e=this.OE)||void 0===e||e.start()):(this.NE.stop(),null===(s=this.OE)||void 0===s||s.stop())}onInitialDomStart(){}onInitialDomDone(t){this.ou.start(),this.NE.addInitialDom(t)}iu(t){var e;this.eu.setAnonymization(t),null===(e=this.vu)||void 0===e||e.setAnonymization(t)}onOptout(){this.NE.stop()}lu(){var t,e,s,i;(null===(e=null===(t=this.wt.experimental.sessionReplay)||void 0===t?void 0:t.shadowRoot)||void 0===e?void 0:e.filterByHostSelector)&&Dt(null===(i=null===(s=this.wt.experimental.sessionReplay)||void 0===s?void 0:s.shadowRoot)||void 0===i?void 0:i.filterByHostSelector,(t=>{Zs(t)&&rn.setShadowRootFilter((e=>{try{return Y.call(e.host,t)}catch(t){return!1}}))}))}}class vu{constructor(t,e){this._E=t,this.$E=e}init(){this._E.onWebViewEvent(((t,e)=>{this.$E.emitWebviewEventToBridge(t,e)}))}onStartTracking(){this._E.start()}onOptout(){this._E.stop()}onStartAnalytics(){this._E.setAnalyticsStatus(!0)}onStopAnalytics(){this._E.setAnalyticsStatus(!1)}onParentRecordingContextChange(t){this.$E.setSessionReplayStatus(t.isRecording)}}!function(t){t[t.PAGE_VIEW=4]="PAGE_VIEW",t[t.TAP=6]="TAP",t[t.LONG_PRESS=8]="LONG_PRESS",t[t.DRAG=9]="DRAG",t[t.FLICK=10]="FLICK",t[t.DETAILED_API_ERROR=13]="DETAILED_API_ERROR",t[t.JAVASCRIPT_ERROR_SR=19]="JAVASCRIPT_ERROR_SR",t[t.CUSTOM_ERROR_SR=20]="CUSTOM_ERROR_SR",t[t.API_ERROR=21]="API_ERROR",t[t.CUSTOM_ERROR_AN=25]="CUSTOM_ERROR_AN",t[t.JAVASCRIPT_ERROR_AN=26]="JAVASCRIPT_ERROR_AN"}(lu||(lu={}));class Eu{constructor(){this.ME=1}transformEvent(t){switch(t.type){case ta.TAP:return{version:this.ME,type:lu.TAP,data:{path:t.tgt}};case ta.DRAG:{const e=t;return{version:this.ME,type:lu.DRAG,data:{path:e.tgt,direction:e.fd,distance:e.distance,velocity:e.velocity}}}case ta.FLICK:{const e=t;return{version:this.ME,type:lu.FLICK,data:{path:e.tgt,direction:e.fd,distance:e.distance,velocity:e.velocity}}}default:return null}}}class Su{constructor(t,e,s,i){this.Nt=t,this.Yi=e,this.tn=s,this.Jm=i,this.ME=1}transformEvent(e,s){switch(e){case Je.ApiError:case Je.DetailedApiError:{const t=this.tn.anonymize(s);return{version:this.ME,data:t}}case Je.JavascriptError:{const e=t._objectSpread2(t._objectSpread2({},s),{},{pageUrl:this.Nt.getAnonymizedUrl()}),i=this.Yi.anonymize(e);return{version:this.ME,data:t._objectSpread2(t._objectSpread2({},i),{},{date:Ie()})}}case Je.CustomError:{const e=s;return e.message=this.Jm.anonymize(e.message),{version:this.ME,data:t._objectSpread2(t._objectSpread2({},e),{},{date:Ie()})}}default:return null}}}!function(t){t.buildCustomErrorEvent=function(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i={message:bn.truncate(t,300,bn.ELLIPSIS),errorType:"customError"};return(s||function(t){const e=Object.keys(t).length;return e>0&&e<=5}(e))&&(function(t){for(const e in t){let s=t[e];if("string"==typeof s&&s.length>30&&(s=bn.truncate(s,30,bn.ELLIPSIS),t[e]=s),e.length>30){const i=bn.truncate(e,30,bn.ELLIPSIS);delete t[e],t[i]=s}}}(e),i.attributes=e),i}}(du||(du={})),function(t){t.isCSJavascriptBridgeDefined=function(){return"object"==typeof window.CSJavascriptBridge&&"function"==typeof window.CSJavascriptBridge.optIn&&"function"==typeof window.CSJavascriptBridge.optOut&&"function"==typeof window.CSJavascriptBridge.sendEvent&&"function"==typeof window.CSJavascriptBridge.sendDynamicVar&&"function"==typeof window.CSJavascriptBridge.sendTransaction},t.getBridgeVersion=function(){if("function"==typeof window.CSJavascriptBridge.getVersion)try{const t=window.CSJavascriptBridge.getVersion();if(m(t))return t}catch(t){ns.warn("an error occurred when calling getVersion")}return null},t.notifyIsReadyForTracking=function(){"function"==typeof window.CSJavascriptBridge.onWebviewTrackingReady&&window.CSJavascriptBridge.onWebviewTrackingReady()},t.sendAnalysisEvent=function(t){window.CSJavascriptBridge.sendEvent(csJSON.stringify(t))},t.sendSREvent=function(t){if(window.CSJavascriptBridge.sendSREvent)for(const e of t.events)window.CSJavascriptBridge.sendSREvent(csJSON.stringify(e))},t.sendLog=function(t){window.CSJavascriptBridge&&window.CSJavascriptBridge.sendLog&&window.CSJavascriptBridge.sendLog(csJSON.stringify(t))},t.sendOptIn=function(){window.CSJavascriptBridge.optIn()},t.sendOptOut=function(){window.CSJavascriptBridge.optOut()},t.sendDynamicVariable=function(t,e){window.CSJavascriptBridge.sendDynamicVar(t,e)},t.sendTransaction=function(t,e,s){window.CSJavascriptBridge.sendTransaction(t,e,s)},t.sendAssets=function(t,e){if(window.CSJavascriptBridge.sendAssets){const s=csJSON.stringify(t);window.CSJavascriptBridge.sendAssets(s,e||null)}else window.CSJavascriptBridge.sendSRAssets&&window.CSJavascriptBridge.sendSRAssets(csArray.prototype.map.call(t,(t=>t.assetId)))},t.sendNativeSREvent=function(t){window.CSJavascriptBridge&&window.CSJavascriptBridge.sendNativeSREvent&&window.CSJavascriptBridge.sendNativeSREvent(csJSON.stringify(t))}}(uu||(uu={}));class wu{constructor(t,e,s,i,n,r,o,a){this.LE=t,this.Ku=e,this.DE=s,this.UE=i,this.FE=n,this.ha=r,this.Nt=o,this.Qa=a,this.BE=!1}async emitWebviewEventToBridge(e,s){switch(e){case Je.AnalysisEvent:{const t=this.DE.transformEvent(s.event);t&&uu.sendAnalysisEvent(t);break}case Je.RecordingEvent:uu.sendSREvent(s);break;case Je.ChildLogMessage:uu.sendLog(s);break;case Je.Commands:ns.tryToExecute(`SDKMessageUtils.sendMessage.sendCommandMessage: ${s}`,(()=>{this.qE(s)}))();break;case Je.Assets:{const{assets:t,serializationId:e}=s,i=await this.FE.getTransformedAssets(t,e);uu.sendAssets(i,e);break}case Je.JavascriptError:{const e=this.UE.transformEvent(Je.JavascriptError,s);e&&(this.BE&&uu.sendNativeSREvent(t._objectSpread2(t._objectSpread2({},e),{},{type:lu.JAVASCRIPT_ERROR_SR})),uu.sendAnalysisEvent(t._objectSpread2(t._objectSpread2({},e),{},{type:lu.JAVASCRIPT_ERROR_AN})));break}case Je.ApiError:{const e=this.UE.transformEvent(Je.ApiError,s);e&&uu.sendAnalysisEvent(t._objectSpread2(t._objectSpread2({},e),{},{type:lu.API_ERROR}));break}case Je.DetailedApiError:{const e=this.UE.transformEvent(Je.DetailedApiError,s);e&&uu.sendNativeSREvent(t._objectSpread2(t._objectSpread2({},e),{},{type:lu.DETAILED_API_ERROR}));break}}}setSessionReplayStatus(t){this.BE=t}qE(t){const e=t.commands;for(const t of e)switch(!0){case csArray.prototype.indexOf.call(Bl,t.name)>=0:uu.sendOptIn();break;case csArray.prototype.indexOf.call(Vl,t.name)>=0:this.ha.emitOptout(),uu.sendOptOut();break;case csArray.prototype.indexOf.call(qo,t.name)>=0:this.HE(t);break;case csArray.prototype.indexOf.call(_c,t.name)>=0:this.zE(t);break;case csArray.prototype.indexOf.call(Qo,t.name)>=0:this.jE(t);break;case csArray.prototype.indexOf.call(Zo,t.name)>=0:break;case csArray.prototype.indexOf.call(Xo,t.name)>=0:this.GE();break;case csArray.prototype.indexOf.call(Gd,t.name)>=0:this.jE(t),this.GE();break;case csArray.prototype.indexOf.call(mh,t.name)>=0:this.Qa.addUrlMaskingPattern(t.params[0]);break;case csArray.prototype.indexOf.call(jh,t.name)>=0:this.Qa.addPartialUrlMaskingPattern(t.params[0]);break;case csArray.prototype.indexOf.call(Gh,t.name)>=0:this.Qa.resetPartialUrlMaskingPatterns();break;case csArray.prototype.indexOf.call(vh,t.name)>=0:this.ZE(t);break;default:ns.warn(`WebviewBridgeEventEmitter received an unknown command: ${csJSON.stringify(t)}`)}}HE(t){if(1!==t.params.length)return;const e=t.params[0];if(E(e)&&"key"in e&&"value"in e&&Bo.isKeyValid(e.key)&&Bo.isValueValid(e.value)){const t=this.LE.anonymizePII(e.key),s=y(e.value)?e.value:this.LE.anonymizePII(e.value);uu.sendDynamicVariable(t,s)}}zE(t){if(1!==t.params.length)return;const e=t.params[0];if(f(e)){const t={type:lu.PAGE_VIEW,version:1,data:{url:e}};this.Nt.overridePath(e),this.ha.emitArtificialPageViewEnd(),uu.sendAnalysisEvent(t),this.ha.emitAfterArtificialPageView()}}jE(t){if(1!==t.params.length)return;const[e]=t.params;e.value&&(e.revenue=e.value),this.Ku.addTransaction(e)}GE(){const t=this.Ku.getTransaction();Fo.isValid(t)&&(uu.sendTransaction(t.id?t.id:null,t.revenue,t.currency?t.currency:""),this.Ku.clear())}ZE(e){if(e.params.length<1)return;const s=e.params[0],i=e.params[1]||{};if(!f(s)||!E(i))return;const n=du.buildCustomErrorEvent(s,i),r=this.UE.transformEvent(Je.CustomError,n);r&&(this.BE&&uu.sendNativeSREvent(t._objectSpread2(t._objectSpread2({},r),{},{type:lu.CUSTOM_ERROR_SR})),uu.sendAnalysisEvent(t._objectSpread2(t._objectSpread2({},r),{},{type:lu.CUSTOM_ERROR_AN})))}}const Ru="LOCAL_ASSET",Au="NONE",bu="ONLY_LOCAL_ASSETS",Tu="ALL";class Cu{constructor(t){var e,s;this.WE=t,this.QE=new Set,this.JE=Au;try{const t=null===(s=null===(e=window.CSJavascriptBridge)||void 0===e?void 0:e.getAssetTransformerMode)||void 0===s?void 0:s.call(e);t!==bu&&t!==Tu||(this.JE=t)}catch(t){}}setAssetProcessingMode(t){this.JE=t}async getTransformedAssets(e,s){if(this.JE===Au)return e;const i=[];for(const n of e){const r=n.assetId,o=this.KE(r);if(this.JE===Tu||o===Ru){let o=r;if(this.YE(r,s)&&(o=this.XE(r,s)),this.QE.has(o)){csArray.prototype.push.call(i,n);continue}try{const e=await this.WE.getAssetContent(r);if(this.QE.has(o)){csArray.prototype.push.call(i,n);continue}csArray.prototype.push.call(i,t._objectSpread2(t._objectSpread2({},n),{},{retrievedAssetContent:e})),this.QE.add(n.assetId)}catch(e){ns.error(`an error occurred while getting data for asset: ${o}: ${e}`),csArray.prototype.push.call(i,n)}}else csArray.prototype.push.call(i,n)}return i}KE(t){const e=window.WEBVIEW_SERVER_URL||null;try{const{protocol:s}=new csURL(t);return"file:"===s||e&&csString.prototype.startsWith.call(t,e)?Ru:"REMOTE_ASSET"}catch(e){ns.error(`Error constructing URL (${t}"): ${e.message}`)}return"UNKNOWN_ASSET_TYPE"}YE(t,e){return e&&csString.prototype.endsWith.call(t,".css")||!1}XE(t,e){return`${t}#${e}`}}class _u{constructor(){this.tA=52428800,this.sA=31457280,this.eA=0,this.iA=!1,this.nA=new Map,this.Xc=[]}async getAssetContent(t){return this.nA.get(t)||new Promise(((e,s)=>{csArray.prototype.push.call(this.Xc,{assetUrl:t,successCallback:e,errorCallback:s}),this.iA||this.rA()}))}async rA(){for(this.iA=!0;this.Xc.length>0;){const{assetUrl:t,successCallback:e,errorCallback:s}=csArray.prototype.shift.call(this.Xc),i=this.nA.get(t);if(i)e(i);else try{const i=(await this.oA("GET",t,"blob")).target;if(200===i.status){const n=i.getResponseHeader("Content-Type"),r=Number(i.getResponseHeader("Content-Length"));if(r&&Number(r)>this.sA){s(`asset is too big, size = ${r} bytes`);continue}const o=new FileReader;o.onload=()=>{const s={data:csString.prototype.split.call(o.result,"base64,")[1],mimeType:null!=n?n:""};this.eA+=r,this.eA>this.tA&&(this.eA=0,this.nA.clear()),this.nA.set(t,s),e(s)},o.onerror=()=>{s("Error converting XHR response to base64")},o.readAsDataURL(i.response)}else s(`error downloading ${t}: ${i.statusText}`)}catch(e){const i=`Error downloading resource ${t}: ${e.message}`;s(i)}}this.iA=!1}oA(t,e,s){return new Promise((function(i,n){const r=new XMLHttpRequest;r.open(t,e),r.responseType=s,r.onload=i,r.onerror=n,r.send()}))}}class Nu{constructor(t,e){this.tE=t,this.RE=e,this.hA=new Fn}cA(){const t=new Set;lt(document,NodeFilter.SHOW_ELEMENT).visitAll((e=>{t.has(e)||(this.hA.scanElement(e),t.add(e))}))}handleCommand(e){const s=e&&e.withAssets,i=[],n=new Set,r=new Set,o=[];s&&ou.isWebViewLocalAssetsSupported()?(this.hA.onScannedAsset((t=>{let{type:e,asset:s}=t;"stylesheet"!==e||r.has(s.assetId)||(r.add(s.assetId),csArray.prototype.push.call(o,s)),n.has(s.assetId)||(n.add(s.assetId),csArray.prototype.push.call(i,s))})),this.cA()):ou.isWebViewLocalAssetsSupported()||ns.warn("Local asset is not supported on this browser");const a=function(){return lt(document).visitAll((t=>{var e;if(B(t)&&(null===(e=t.adoptedStyleSheets)||void 0===e?void 0:e.length)>0){const e=function(t){if(null==t?void 0:t.length)return Lt(t,(t=>function(t){let e=[];try{e=Lt(t.cssRules,(t=>t.cssText))}catch(t){}return{cssRules:e}}(t)))}(t.adoptedStyleSheets);js.setProperty(t,"styles",e)}})),e=function(e,s){let i;return fn(t._objectSpread2(t._objectSpread2({},void 0),{},{async:!1}))(e,(t=>i=t)),i}(document),js.traverse(e,(t=>{if(11===t.nodeType){const e=js.getProperty(t,"styles");e&&(t.adoptedStyleSheets=e)}})),e;var e}(),c=csJSON.stringify(a);if(s){const t=Qh.generate();return this.aA(i,o,t),csJSON.stringify({serializedDom:c,serializationId:t})}return c}aA(t,e,s){0===e.length?this.TE(t,s):this.uA(t,e,s,((t,e)=>this.TE(t,e)))}uA(t,e,s,i){let n=0,r=0;const o=new Set(csArray.prototype.map.call(t,(t=>t.assetId))),a=t=>!o.has(t),c=s=>{o.has(s.assetId)||(o.add(s.assetId),csArray.prototype.push.call(e,s),csArray.prototype.push.call(t,s))},h=a=>{for(const e of a)o.has(e.assetId)||(o.add(e.assetId),csArray.prototype.push.call(t,e));n++,n+r===e.length&&i(t,s)},l=o=>{r++,ns.error("An error occurred while fetching a styleSheet: "+o),n+r===e.length&&i(t,s)};csArray.prototype.forEach.call(e,(t=>{this.RE.getStyleSheetAssets(t.assetId,h,l,a,c)}))}TE(t,e){this.tE.sendToParent(Je.Assets,{assets:t,serializationId:e})}}class Iu{constructor(t){this.wt=t,this.lA=null}isSdkTrackingContext(t){return w(t)&&E(t)&&f(t.sessionKey)&&y(t.pageNumber)&&f(t.pageViewType)&&v(t.isRecording)}update(e){if(!this.isSdkTrackingContext(e))return ns.warn(`webViewTrackingContext.service received wrong sdkTrackingContext, content:${csJSON.stringify(e)}`),void(this.lA=null);this.lA=t._objectSpread2(t._objectSpread2({},e),{},{recordingConsentState:To.NOT_NEEDED,projectId:this.wt.projectId,uxaDomain:this.wt.uxaDomain},this.wt.smbConfig)}getTrackingContext(){return this.lA}}class Ou{constructor(t){this.dA=t,this.Eu=[]}handleCommand(t){if(!R(t))return;this.Au(t);const e=this.dA.getTrackingContext();null!==e&&this._u(t,e)}executeRegisteredCallbacks(t){const e=t.trackingContext;e&&csArray.prototype.map.call(this.Eu,(t=>this._u(t,e)))}Au(t){csArray.prototype.push.call(this.Eu,t)}_u(t,e){csSetTimeout((()=>{t(e)}))}}class Pu{constructor(t,e){this.Pu=t,this.dA=e}onIframeIntegrationCallback(t){const e=this.dA.getTrackingContext();null!==e&&(t.trackingContext=e,this.Pu.sendToChildren(Je.IntegrationCallback,t))}}class ku{constructor(t){this.commandsService=t,this.Nu=new Lo}registerChildCommands(){this.commandsService.register(xo,(t=>this.Nu.handleCommand(t,this.fA)))}onParentRecordingContextChange(t){this.fA={isRecording:t.isRecording,recordingStartTimestamp:t.recordingStartTimestamp||0,etrState:t.etrState||fi.ETR_OFF},this.Nu.executeCallbacks(this.fA)}}as([yo()],ku.prototype,"onParentRecordingContextChange",null);const Lu=["serializeWebView","webview:serializeWebView"],Mu=["setAssetTransformerMode","webview:setAssetTransformerMode"],Du=["webview:onAfterScreenView"];class xu extends ku{constructor(t,e,s,i,n,r,o){super(t),this.commandsService=t,this.tE=e,this.Pu=s,this.FE=i,this.pA=n,this.Cu=r,this.wt=o}init(){this.dA=new Iu(this.wt),this.vA=new Pu(this.Pu,this.dA),this.Cu.addListener(this.vA),this.mA=new Ou(this.dA);const t=new gu(new mu);this.wA=new Nu(this.tE,t),this.Rp()}onAfterPageViewCallback(t){this.mA.executeRegisteredCallbacks(t)}Rp(){super.registerChildCommands(),this.commandsService.register(Mo,(t=>{this.mA.handleCommand(t)})),this.commandsService.register(Du,(t=>{this.dA.update(t);const e=this.dA.getTrackingContext();null!==e&&this.pA.emitAfterPageViewCallback({initiator:Xe.AfterPageView,trackingContext:e})})),this.commandsService.register(Lu,(t=>this.wA.handleCommand(t))),this.commandsService.register(Mu,(t=>{t!==Au&&t!==bu&&t!==Tu||this.FE.setAssetProcessingMode(t)}))}}class Uu{constructor(t){this.tE=t,this.Eu={}}handleCommand(t){R(t)&&this.Au(t)}executeRegisteredCallbacks(t){const e=t.trackingContext;if(e)if(t.callbackId){const s=this.Eu[t.callbackId];s&&this._u(s,e)}else for(const t in this.Eu)this._u(this.Eu[t],e)}Au(t){const e=Zt.integer(),s={callbackId:e,initiator:Xe.AfterPageView};this.Eu[e]=t,this.tE.sendToParent(Je.IntegrationCallback,s)}_u(t,e){csSetTimeout((()=>{t(e)}))}}class Vu{constructor(t){this.tE=t,this.Ru={}}handleCommand(t){E(t)&&R(t.callback)&&this.Tu(t.callback)}executePendingCallbacks(t){const{trackingContext:e,callbackId:s}=t;if(!s||!e)return;const i=this.Ru[s];i&&(delete this.Ru[s],this._u(i,e.sessionKey))}Tu(t){const e=Zt.integer(),s={callbackId:e,initiator:Xe.GetSessionKey};this.Ru[e]=t,this.tE.sendToParent(Je.IntegrationCallback,s)}_u(t,e){csSetTimeout((()=>{t(e)}))}}class Bu{constructor(t,e){this.tE=t,this.Pu=e,this.gA={}}handleCommand(t,e){E(t)&&R(e)&&this.Tu(t,e)}executePendingCommand(t){const{trackingContext:e,callbackId:s}=t;if(s&&e)if(this.gA[s]){const[t,i]=this.gA[s];t&&(delete this.gA[s],this._u(e,t,i))}else this.Pu.sendToChildren(Je.TrackingContextResultMessage,t)}Tu(t,e){const s=Zt.integer();this.gA[s]=[t,e],this.tE.sendToParent(Je.TrackingContextRequestMessage,{callbackId:s})}_u(t,e,s){csSetTimeout((()=>{const i=Po(t,e);s(i)}))}}class Hu extends ku{constructor(t,e,s){super(t),this.commandsService=t,this.tE=e,this.Pu=s}init(){this.yA=new Uu(this.tE),this.EA=new Vu(this.tE),this.AA=new Bu(this.tE,this.Pu),this.Rp()}onAfterPageViewCallback(t){this.yA.executeRegisteredCallbacks(t)}onIntegrationSessionKeyCallback(t){this.EA.executePendingCallbacks(t)}onTrackingContextResultCallback(t){this.AA.executePendingCommand(t)}Rp(){super.registerChildCommands(),this.commandsService.register(Mo,(t=>{this.yA.handleCommand(t)})),this.commandsService.register(Do,(t=>this.EA.handleCommand(t))),this.commandsService.register(Uo,((t,e)=>{this.AA.handleCommand(t,e)}))}}class $u{constructor(t,e,s,i,n,r){this.Za=t,this.pm=e,this.Wa=s,this.wm=i,this.en=n,this._A=r}init(){var t,e;this._A&&this.en&&(null===(t=this._A)||void 0===t||t.addSelector(null===(e=this.en)||void 0===e?void 0:e.getEncryptionSelectors())),this.Rp(),this.vm=new Fh(this.Wa,this.pm,this.wm,this._A)}RA(){this.vm.start()}zi(){this.vm.stop()}onParentSensitiveStatusChange(t){var e,s;t.maskedElementSettings&&this.pm.setMaskedElementSettingsFromParent(t.maskedElementSettings),t.capturedElementSelector&&this.wm.setWhitelistedElementsSelector(t.capturedElementSelector),t.encryptionSelectors&&(null===(e=this._A)||void 0===e||e.addSelector(t.encryptionSelectors),null===(s=this.en)||void 0===s||s.setEncryptionSelectors(t.encryptionSelectors)),t.started?this.RA():this.zi()}Rp(){this.Za.register(qh,(t=>{this.wm.setWhitelistedElementsSelector(t)})),this.Za.register($h,(t=>{this.pm.setMaskedElementSettingsFromCommand(t)})),this.Za.register(Hh,(t=>{var e,s;null===(e=this.en)||void 0===e||e.setEncryptionSelectors(t),null===(s=this._A)||void 0===s||s.addSelector(t)}))}}class qu{constructor(t,e,s,i,n,r,o){this.ha=t,this.Za=e,this.pm=s,this.Wa=i,this.tu=n,this.wm=r,this.rE=o,this.vm=new Fh(this.Wa,this.pm,this.wm,void 0,this.tu)}init(){this.tu.init(),this.Rp()}onStartAnalytics(){this.jm()}onAfterArtificialPageView(){this.SA(),this.jm()}onStopAnalytics(){this.SA()}jm(){this.vm.start(),this.rE.setSensitiveStatus({started:!0,useAnonymization:this.tu.shouldUseAnonymization()}),this.ha.emitSensitiveStatusChange()}SA(){this.vm.stop(),this.rE.setSensitiveStatus({started:!1,useAnonymization:this.tu.shouldUseAnonymization()}),this.ha.emitSensitiveStatusChange()}Rp(){this.Za.register(qh,(t=>{this.wm.setWhitelistedElementsSelector(t),this.ha.emitSensitiveStatusChange()})),this.Za.register($h,(t=>{this.pm.setMaskedElementSettingsFromCommand(t),this.ha.emitSensitiveStatusChange()}))}}const zu=/(\b["']?key["']?\s*[=:]\s*["'](?:first|last)[ _-]?name["']\s*,?\s*["']?value["']?\s*[=:]\s*["'])(.+?)(["'])|(\b["']?(?:first|last)[\s_-]?name["']?\s*[=:]\s*["'])(.+?)(["'])/gi,Fu=/(?:\(\d{3}\) \d{3}[- ]\d{4}\b)|(?:\b\d{3}([-\. ])\d{3}\1\d{4}\b)|(?:\b\d{2} \d{2} \d{2} \d{2} \d{2}\b)|(?:\b\d{4} \d{3} \d{3}\b)|(?:\b\d{2}([-\. ])\d{4}\2\d{4}\b)|(?:\b\d{3}([- ])\d{4}\3\d{4}\b)|(?:\+\d{1,3} \d{3} \d{3} \d{4}\b)|(?:\+\d{1,3} \(\d{3}\) \d{3}-\d{4}\b)|(?:\+\d{1,3}([- ])\d{4}\4\d{3}\4\d{3}\b)|(?:\+\d{1,3} \d \d{4} \d{4}\b)|(?:\+\d{1,3} \d \d{3} \d{3} \d{4}\b)|(?:\+\d{1,3} \d \d{2} \d{2} \d{2} \d{2}\b)|(?:\+\d{7,15}\b)|(?:\+\d{1,3} \d{6,12}\b)|(?:\+\d{1,3}([- ])\d{4}\5\d{3}\5\d{3}\b)/g;class ju{constructor(t){this.gt=t}anonymize(t){return t=this.gt.anonymizePII(t),t=this.TA(t),this.IA(t)}TA(t){return csString.prototype.replace.call(t,zu,"$1$4CS_ANONYMIZED_NAME$3$6")}IA(t){return csString.prototype.replace.call(t,Fu,"CS_ANONYMIZED_PHONE")}}class Gu{constructor(t,e,s,i,n,r,o,a,c){this.fE=t,this.ha=e,this.wt=s,this.tE=i,this.nE=n,this.Za=r,this.jt=o,this.qr=a,this.rE=c,this.qm=()=>{this.Za.start(),this.Bm.start()}}start(){let t,e,s,i,n,r,o,a,c,h,l,d,u;this.qr.schedule((()=>{if(n=new Dd,r=new Uh((()=>{})),d=new Vh,this.jt.isInIframeContext()){const t=new $u(this.Za,n,r,d,u,void 0);t.init(),this.fE.addListener(t)}if(s=new Re,h=new wd(s),l=new Zl(window.location,h),this.jt.isInWebViewContext()){const t=new ru(this.wt),e=new _h,s=new Ch(t,this.wt,l,e),i=new qu(this.ha,this.Za,n,r,s,d,this.rE);i.init(),this.fE.addListener(i)}})),this.qr.schedule((()=>{t=new Ad(zt,this.wt),e=new Mc(t),i=new iu(this.wt,t,e,this.tE,this.jt,this.fE,this.Za,new hh(ns),this.rE),this.fE.addListener(i)})),ph.isRecordingSupported()&&this.qr.schedule((()=>{const t=new fu(this.wt,s,r,this.ha,this.tE,this.nE,this.Za,this.fE,this.jt,l,this.rE,h,u);this.ha.addListener(t),this.fE.addListener(t),t.init()})),this.qr.schedule((()=>{c=new nh(this.wt);const e=new bd(t),s=new Td(t),i=new Cd(t),n=new _d;a=new td(e,s,i,n),o=new Jd(c,a,this.tE,this.nE,this.rE)})),this.qr.schedule((()=>{a.addListener(o),this.fE.addListener(o),this.ha.addListener(o),this.ha.addListener(i)})),this.qr.schedule((()=>{let t;if(this.jt.isInWebViewContext()){const e=new _u;this.FE=new Cu(e),t=new xu(this.Za,this.tE,c,this.FE,this.fE,a,this.wt)}else t=new Hu(this.Za,this.tE,c);this.fE.addListener(t),t.init()})),this.qr.schedule((()=>{o.init(),i.init()})),this.qr.schedule((()=>{if(this.jt.isInWebViewContext()){const t=new Eu,e=new ch(s,l),i=new Cc,n=new ah(i,h),r=new ju(s),o=new Su(l,e,n,r),a=new wu(s,new Go(s,null,null),t,o,this.FE,this.ha,l,i),c=new vu(this.tE,a);c.init(),this.ha.addListener(c),this.fE.addListener(c)}else{const t=new Kd(this.tE);this.ha.addListener(t)}})),this.Bm=new Dc,this.qr.schedule((()=>{this.Bm.onLoad((()=>{this.ha.emitStartTracking()})),this.qm()}))}}class Wu extends Zd{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;super(2500),this.fE=t,this.wt=e,this.PA=s,this.bA=!1,this.VA=void 0,this.CA=!0}onStart(){this.kA()}onStop(){this.buffer.reset(),this.OA&&window.csClearInterval(this.OA)}sendToParent(t,e){var s;if(this.NA())null===(s=this.xA)||void 0===s||s.call(this,t,e);else if(this.$A(t)){const s=this.buildChildBaseMessage(t,e);this.buffer.addMessage(s)}}NA(){return this.bA&&this.CA}$A(t){return!this.bA||t===Je.Commands}onWebViewEvent(t){this.xA=t}setAnalyticsStatus(t){this.CA=t,this.CA&&this.MA()}sendAllMessagesFromBuffer(){var t;const e=this.buffer.getMessages();for(const s of e)null===(t=this.xA)||void 0===t||t.call(this,s.type,s.content);this.buffer.reset()}MA(){var t;if(!this.bA)return;const e=this.buffer.getMessages();for(const s of e)s.type===Je.Commands&&(null===(t=this.xA)||void 0===t||t.call(this,s.type,s.content));this.buffer.reset()}buildChildBaseMessage(t,e){return{type:t,content:e}}kA(){this.bA=uu.isCSJavascriptBridgeDefined(),this.bA?this.LA():this.OA=window.csSetInterval((()=>{this.bA=uu.isCSJavascriptBridgeDefined(),this.bA&&(this.LA(),window.csClearInterval(this.OA))}),this.PA)}LA(){this.DA(),this.VA=uu.getBridgeVersion(),null===this.VA?this.sendAllMessagesFromBuffer():this.VA>=2?(this.UA(),uu.notifyIsReadyForTracking()):ns.warn(`bridge version ${this.VA} is not supported`)}DA(){const t={message:csJSON.stringify(this.wt),errorCode:"TAG_CONFIGURATION",level:se.critical};uu.sendLog(t)}UA(){this.fE.emitStopAnalytics()}}class Yu{constructor(){this.fA=null}getRecordingContext(){return null===this.fA?{isRecording:!1}:this.fA}setRecordingContext(t){this.fA=t}}class Qu extends ni{constructor(t,e){super(),this.Xi=t,this.tE=e}onStart(){this.Xi.subscribe(Qu.jn,(t=>this.Nn(t)))}onStop(){this.Xi.unsubscribe(Qu.jn)}Nn(t){this.isStarted&&this.tE.sendToParent(Je.ApiError,t)}}Qu.jn="ChildApiErrorsService";class Zu extends ni{constructor(t,e){super(),this.Xi=t,this.tE=e}onStart(){this.Xi.subscribe(Zu.jn,(t=>this.Nn(t)),{detailedEvent:!0})}onStop(){this.Xi.unsubscribe(Zu.jn)}Nn(t){this.isStarted&&this.tE.sendToParent(Je.DetailedApiError,t)}}Zu.jn="ChildDetailedApiErrorsService";class Xu{constructor(t,e,s){this.wt=t,this.tE=e,this.Xy=s}init(){var t;const e=new Re;let s;s=(null===(t=this.wt.apiErrors.collectionRules)||void 0===t?void 0:t.length)?new Dh(this.wt.apiErrors,e):new xh(this.wt.apiErrors,e),this.Xi=new oh(new Ih,new Oh,s),this.FA=new Qu(this.Xi,this.tE),this.BA=new Zu(this.Xi,this.tE),this.Xi.init(),this.Rp()}Rp(){this.Xy.register(mh)}onStartTracking(){this.FA.start()}onParentRecordingContextChange(t){t.isRecording?this.BA.start():this.BA.stop()}onOptout(){this.FA.stop(),this.BA.stop()}onStartAnalytics(){this.FA.start()}onStopAnalytics(){this.FA.stop()}}class Ku extends ni{constructor(t,e){super(),this.Sp=t,this.tE=e}onStart(){this.Sp.subscribe(Ku.jn,(t=>this.Nn(t)))}onStop(){this.Sp.unsubscribe(Ku.jn)}Nn(t){this.isStarted&&this.tE.sendToParent(Je.JavascriptError,t)}}Ku.jn="ChildJavaScriptErrorsService";class Ju{constructor(t,e,s){this.wt=t,this.tE=e,this.Xy=s}init(){const t=new eh;this.qA=new Ku(t,this.tE),this.Rp()}onStartTracking(){this.qA.start()}onOptout(){this.qA.stop()}onStartAnalytics(){this.qA.start()}onStopAnalytics(){this.qA.stop()}Rp(){this.wt.jsCustomErrorsEnabled&&!this.wt.customErrors.enabled&&this.Xy.register(vh)}}class tp{constructor(){this.HA={started:!1,useAnonymization:!0}}getSensitiveStatus(){return this.HA}setSensitiveStatus(t){this.HA=t}getElementSensitiveStatus(t){return this.HA.started?Ks.isMaskedElement(t)||Ks.isMaskedElementChild(t)?fa.MASKED:vr.shouldEncrypt(t)?fa.ENCRYPTED:this.HA.useAnonymization?In.isWhitelistedElement(t)?fa.CAPTURED:fa.ANONYMIZED:fa.CAPTURED:fa.ANONYMIZED}}class ep{constructor(t,e,s){this.wt=t,this.jt=e,this.qr=s}init(){let t,e,s,i,n,r,o,a;Qc.isSupported()&&Qc.setDigestSalt(this.wt.projectId.toString()),this.qr.schedule((()=>{t=new $d(this.qr),e=new Hd,s=new Yu,i=new tp;const o=[ql.UXA];this.jt.isInWebViewContext()?(window.cs_wvt=window.cs_wvt||[],csArray.prototype.push.call(o,ql.WVT),n=new Wu(e,this.wt)):n=new Xd(this.wt,t,s,i,e),r=new Fl(o)})),this.qr.schedule((()=>{o=new Yd(r,n),a=new Wd(o)})),this.qr.schedule((()=>{a.init()})),this.qr.schedule((()=>{})),this.qr.schedule((()=>{if(this.wt.apiErrors.enabled){const s=new Xu(this.wt,n,o);s.init(),t.addListener(s),e.addListener(s)}if(this.wt.jsErrorsEnabled){const s=new Ju(this.wt,n,o);s.init(),t.addListener(s),e.addListener(s)}})),this.qr.schedule((()=>{t.addListener(a)})),this.qr.schedule((()=>{t.emitInitTracking()})),this.qr.schedule((()=>{new Gu(e,t,this.wt,n,s,r,this.jt,this.qr,i).start()}))}}class sp{constructor(t,e,s){this.wt=t,this.jt=e,this.yt=s}start(){var t,e,s,i,n;if(window.UXAnalytics)return;window.UXAnalytics={};const r=new Gn(!!(null===(t=this.wt.taskSchedulerOptions)||void 0===t?void 0:t.enabled),null===(e=this.wt.taskSchedulerOptions)||void 0===e?void 0:e.maxProcessingTime,null===(s=this.wt.taskSchedulerOptions)||void 0===s?void 0:s.waitDuration),o=new gs(this.jt,this.wt);o.init();const a=new ms(this.wt,o);if(this.jt.isTopWindowTracker()&&a.canTrack()){if((null===(i=window.CSProtectnativeFunctionsLogs)||void 0===i?void 0:i.Warning)&&ns.warn(`protectNativeFunctions failed: ${window.CSProtectnativeFunctionsLogs.Warning}`),null===(n=window.CSProtectnativeFunctionsLogs)||void 0===n?void 0:n.Critical)return void ns.error(`protectNativeFunctions failed: ${window.CSProtectnativeFunctionsLogs.Critical}`);const t=new $d(r),e=new xd(this.wt,o,this.yt,r,t);this.wt.isQuotaEnabled()?e.initWithQuota():e.init()}else!this.jt.isTopWindowTracker()&&a.canTrackInChild()&&new ep(this.wt,this.jt,r).init();const c=csString.prototype.indexOf.call(window.location.href,"csDebug=1")>-1;window.UXAnalytics={Sensitive:{isNodeSensitive:t=>Ks.isMaskedElement(t)||Ks.isMaskedElementChild(t),isAttributeSensitive:(t,e)=>Ks.isMaskedAttribute(t,e),getSensitiveAttributes:t=>Vt(t.attributes,(e=>Ks.isMaskedAttribute(t,e.name)))},Console:{warn(t){c&&console.warn("cs.tracking.warning",t)},error(t){c&&console.error("cs.tracking.error",t)}},Version:Ae},!window.CSFrameCommunication&&Bd.isActivable()&&(window.CSFrameCommunication=Bd,Bd.waitForConnection())}}as([Nt("main.start"),yt("main.start")],sp.prototype,"start",null);class ip{constructor(){}send(t,e){const s={message:t,errorCode:e,level:arguments.length>2&&void 0!==arguments[2]?arguments[2]:se.warn};uu.sendLog(s)}}class np{constructor(t,e,s){this.nn=t,this.gt=e,this.zA=s,this.Xc=[],this.it=null,this.jA=be().v}GA(){0!==this.Xc.length&&(this.nn.send({m:csArray.prototype.map.call(this.Xc,(t=>({n:t.name,p:t.parameter,v:t.value}))),p:this.gt.anonymizePII(window.location.pathname),pid:this.zA,v:this.jA}),this.Xc=[])}push(t){csArray.prototype.push.call(this.Xc,...t),this.it&&(csClearTimeout(this.it),this.it=null),this.Xc.length>=np.MAX_QUEUE_SIZE?this.GA():this.it=window.csSetTimeout((()=>{this.GA(),this.it=null}),np.DEBOUNCE_INTERVAL)}}function rp(){const t=new te(window.CS_CONF);window._uxa=window._uxa||[],t.processOptionOverrides(window._uxa);const e=new ee(window,t);e.init();const s=new ss;if(mt=ns,rs=!0,ns.computeIsActive(t.validationRate),e.isTopWindowTracker()){const e=new $e(t,s);ns.setStrategy(e)}else if(e.isInIframeContext()){const e=new es(t);ns.setStrategy(e)}else if(e.isInWebViewContext()){const t=new ip;ns.setStrategy(t)}(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;wt=mt.isPerfLoggingActive()&&function(){var t;if(!(null===(t=window.performance)||void 0===t?void 0:t.mark))return!1;const e="isPerformanceMeasureSupported",s=`${e}_a`;return performance.mark(s),void 0!==performance.measure(e,s)}(),wt&&(Et=t,St=e)})(),function(t){const e=t.validationRate/10,s=Zt.boolean(e);if("staging"===t.environment||s)try{const e=ad.create(ns.warn),s=new ws(e).create(t.getMetricsUri(),!0),i=new Re,n=new np(s,i,t.projectId);le.setService(n)}catch(t){ns.warn(`Error initializing metrics: ${t.message}`)}}(t),new sp(t,e,s).start()}np.DEBOUNCE_INTERVAL=5e3,np.MAX_QUEUE_SIZE=100,window.CSCurrentScript=document.currentScript,csSetTimeout((()=>{try{t=rp,(null===document||void 0===document?void 0:document.prerendering)?document.addEventListener("prerenderingchange",t,{once:!0}):t()}catch(t){}var t}))})()}));
//# sourceMappingURL=c_contentsquare.js-vflmfDLX2.map

//# debugId=30bb241f-b516-3bab-b431-d056a78b1141