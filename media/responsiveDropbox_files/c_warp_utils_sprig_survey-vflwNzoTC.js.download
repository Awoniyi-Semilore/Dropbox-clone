!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="27ca0f00-ac88-3c29-b4a0-af1660ef00e9")}catch(e){}}();
define(["require","exports","react","./e_warp_warp_page_edison","./e_core_exception","./c_core_i18n","./c_src_sink_index","./c_init_data_debug_panel","./c_chat_chat_constants","./c_lodash-es_lodash","metaserver/static/js/langpack","./c_init_data_edison","./c_www_auth_csrf","./c_core_notify","react-dom","./c_bem","./e_data_modules_stormcrow","./e_edison","./c_ttvc_util_index","./c_api_v2_unauthed_client","./c_redux_namespaces"],(function(e,t,s,r,a,n,i,o,c,_,u,l,d,v,y,g,h,p,m,S,E){"use strict";class w{constructor(e){this.category="web-user_survey",this.session_id=null,this.team_id=null,this.ua_browser_name=null,this.ua_browser_version=null,this.locale_user_selected=null,this.user_agent=null,this.active_user_id=null,this.user_id=null,this.event_name=e.event_name,this.user_survey_id=e.user_survey_id,this.extras=e.extras,Object.seal(this)}}const f=new r.HiveLogger;class C extends Error{constructor(e,t){super(e),this.name="WarpSprigSurveyError",this.stack=null==t?void 0:t.stack}}const b=(e,t)=>{switch(e.type){case"addAttribute":f.log(new w({event_name:"add_attribute",user_survey_id:t,extras:{key:e.data.key,value:e.data.value.toString()}}));break;case"surveyClosed":f.log(new w({event_name:"closed_survey",user_survey_id:t}));break;case"surveyPresented":f.log(new w({event_name:"shown_survey",user_survey_id:t}))}},k=({surveyData:t,anonymizedPath:n})=>{const[i,o]=s.useState(!1),c=((e,t,a=[r.CookieCategory.Analytics])=>{const[n,i]=s.useState(!1),o=(e,t)=>t.every((t=>e.includes(t)));return s.useEffect((()=>{const s=new r.ConsentCookieStore({}),n=s.getAllowedCategories();let c;if(s.hasUserInteracted()&&o(n,a))i(!0);else{let r=e;c=setInterval((()=>{s.hasUserInteracted()&&(o(n,a)&&i(!0),clearInterval(c)),r-=t,r<=0&&clearInterval(c)}),t)}return()=>{clearInterval(c)}}),[]),n})(r.SPRIG_SURVEY_TIMEOUT,r.TRACK_CONSENT_BANNER_INTERVAL,[r.CookieCategory.Analytics]),{chatInstance:_}=r.useWarpContext(),{surveySessionId:u,isMobile:l,locale:d}=t;s.useEffect((()=>{u&&c&&m()}),[c]),s.useEffect((()=>{_&&_.regsiterVisibilityChangeCallback(o)}),[_]),s.useEffect((()=>{v(i)}),[i]);const v=e=>{const t=document.querySelector("iframe#ul-frame");t&&(t.style.display=""+(e?"none":"block"))},y=()=>{u&&b({type:"surveyClosed"},u)},g=()=>{u&&b({type:"surveyPresented"},u)},h=e=>{e.UPDATES?(e.addListener(e.UPDATES.SURVEY_CLOSED,y),e.addListener(e.UPDATES.SURVEY_PRESENTED,g)):e.addListener("sdk.ready",(()=>h(e)))},p=(e,t,s)=>{e.setAttribute(t,s),u&&b({type:"addAttribute",data:{key:t,value:s}},u)},m=async()=>{try{const{sprig:t}=await new Promise((function(t,s){e(["./c_sprig-technologies_sprig-browser_index"],t,s)})).then((function(e){return e.index})),s=t.configure({environmentId:"mlCiv6rgmjkA"});s&&(void 0!==l&&p(s,"isMobile",`${l}`),d&&p(s,"localeCode",`${d}`),u&&s.setUserId(u),h(s))}catch(e){const t=e instanceof Error?e:void 0;a.reportException({err:new C(`Failed to init Sprig module on ${n} page. ${null==t?void 0:t.message}.`,t),severity:a.SEVERITY.CRITICAL,tags:["warp-sprig"]})}};return null};k.displayName="SprigSurvey",t.SprigSurvey=k,t.logSurveyToHive=b}));
//# sourceMappingURL=c_warp_utils_sprig_survey.js-vfl2N2doL.map

//# debugId=27ca0f00-ac88-3c29-b4a0-af1660ef00e9